% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/convert_xxtpt_to_hours.R
\name{convert_xxtpt_to_hours}
\alias{convert_xxtpt_to_hours}
\title{Convert \code{XXTPT} Strings to Hours}
\usage{
convert_xxtpt_to_hours(xxtpt, infusion_duration = 1, range_method = "midpoint")
}
\arguments{
\item{xxtpt}{A character vector of timepoint descriptions from SDTM
\code{--TPT} variables (e.g., \code{PCTPT}, \code{VSTPT}, \code{EGTPT}, \code{ISTPT}, \code{LBTPT}).
Can contain \code{NA} values.

\describe{
\item{Permitted values}{character vector}
\item{Default value}{none}
}}

\item{infusion_duration}{Numeric value specifying the duration of infusion
in hours. Used to convert "EOI" (End of Infusion) patterns and patterns
describing time after end of infusion. Must be a positive number.
Default is 1 hour.

\describe{
\item{Permitted values}{numeric scalar (positive)}
\item{Default value}{\code{1}}
}}

\item{range_method}{Method for converting time ranges to single values.
Options are "midpoint" (default), "start", or "end". For example,
"0-6h" with midpoint returns 3, with start returns 0, with end returns 6.

\describe{
\item{Permitted values}{character scalar ("midpoint", "start", or "end")}
\item{Default value}{\code{"midpoint"}}
}}
}
\value{
A numeric vector of timepoints in hours. Returns \code{NA_real_} for:
\itemize{
\item Input \code{NA} values
\item Unrecognized timepoint formats
\item Non-time descriptors (e.g., "Morning", "Evening")
}

Returns \code{numeric(0)} for empty input.
}
\description{
Converts CDISC timepoint strings (e.g., \code{PCTPT}, \code{VSTPT}, \code{EGTPT},
\code{ISTPT}, \code{LBTPT}) into numeric hours for analysis. The function handles
common dose-centric formats including pre-dose, post-dose (hours/minutes),
days, time ranges, and infusion-related time markers.
}
\details{
The function recognizes the following patterns (all case-insensitive):

\strong{Special Cases:}
\itemize{
\item \code{"Screening"} → -1
\item \code{"Pre-dose"}, \code{"Predose"}, \code{"Pre-infusion"}, \code{"Pre-inf"}, \code{"Infusion"},
\code{"0H"} → 0
\item \code{"EOI"}, \code{"End of Infusion"}, \code{"After End of Infusion"},
\code{"After End of Treatment"} → \code{infusion_duration} (default: 1)
\item \code{"Morning"}, \code{"Evening"} → \code{NA_real_}
\item Unrecognized values → \code{NA_real_}
}

\strong{Time Ranges:}
Time ranges are converted based on the \code{range_method} parameter:
\itemize{
\item \code{"0-6h Post-dose"} with \code{range_method = "midpoint"} (default) → 3
\item \code{"0-6h Post-dose"} with \code{range_method = "start"} → 0
\item \code{"0-6h Post-dose"} with \code{range_method = "end"} → 6
\item \code{"0-4H PRIOR START OF INFUSION"} with midpoint → -2 (negative for prior)
\item \code{"8-16H POST START OF INFUSION"} with midpoint → 12
}

\strong{Time-based Conversions:}
\itemize{
\item \strong{Days}: \code{"Day 1"} → 24, \code{"30 DAYS AFTER LAST"} → 720
\item \strong{Hours + Minutes}: \code{"1H30M"} → 1.5
\item \strong{Hours}: \code{"2 hours"} → 2, \code{"1 HOUR POST"} → 1
\item \strong{Minutes}: \code{"30M"} → 0.5, \code{"30 MIN POST"} → 0.5
\item \strong{Predose}: \code{"5 MIN PREDOSE"} → -0.0833
\item \strong{Post EOI/EOT}: \code{"1 HOUR POST EOI"} → infusion_duration + 1,
\code{"24 HR POST INF"} → infusion_duration + 24
\item \strong{After end}: \code{"30MIN AFTER END OF INFUSION"} → infusion_duration + 0.5
\item \strong{Start of infusion}: \code{"8H PRIOR START OF INFUSION"} → -8
\item \strong{Pre EOI}: \code{"10MIN PRE EOI"} → -0.1667
}

\strong{Supported Unit Formats:}
\itemize{
\item Hours: H, h, HR, hr, HOUR, hour (with optional plurals)
\item Minutes: M, m, MIN, min, MINUTE, minute (with optional plurals)
\item Days: D, d, DAY, day (with optional plurals)
\item Flexible whitespace and optional "Post-dose", "POST", "After last"
suffixes
}
}
\examples{
# Basic dose-centric patterns
convert_xxtpt_to_hours(c(
  "Screening",
  "Pre-dose",
  "Pre-inf",
  "30M",
  "1H",
  "2H POSTDOSE",
  "Day 1"
))

# Predose patterns (negative times)
convert_xxtpt_to_hours(c("5 MIN PREDOSE", "1 HOUR PREDOSE"))

# Infusion-related patterns
convert_xxtpt_to_hours(c(
  "1 HOUR POST EOI",
  "24 HR POST INF",
  "30MIN AFTER END OF INFUSION",
  "8H PRIOR START OF INFUSION",
  "10MIN PRE EOI"
))

# Time ranges - default midpoint
convert_xxtpt_to_hours(c(
  "0-6h Post-dose",
  "0-4H PRIOR START OF INFUSION",
  "8-16H POST START OF INFUSION"
))

# Time ranges - specify method
convert_xxtpt_to_hours("0-6h Post-dose", range_method = "end")
convert_xxtpt_to_hours("0-6h Post-dose", range_method = "start")

# Custom infusion duration (2 hours)
convert_xxtpt_to_hours(
  c("EOI", "End of Infusion", "1 HOUR POST EOI"),
  infusion_duration = 2
)
}
\seealso{
Date/Time Computation Functions that returns a vector:
\code{\link{compute_age_years}()},
\code{\link{compute_dtf}()},
\code{\link{compute_duration}()},
\code{\link{compute_tmf}()},
\code{\link{convert_date_to_dtm}()},
\code{\link{convert_dtc_to_dt}()},
\code{\link{convert_dtc_to_dtm}()},
\code{\link{impute_dtc_dt}()},
\code{\link{impute_dtc_dtm}()}
}
\concept{com_date_time}
\keyword{com_date_time}
