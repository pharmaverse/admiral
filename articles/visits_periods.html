<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Visit and Period Variables â€¢ admiral</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><script src="../deps/MathJax-3.2.2/tex-chtml.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Visit and Period Variables">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">admiral</a>

    <small class="nav-text text-default me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">1.2.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-get-started" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Get Started</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-get-started">
<li><a class="dropdown-item" href="../articles/admiral.html">Get Started</a></li>
    <li><a class="external-link dropdown-item" href="https://github.com/pharmaverse/admiral/blob/main/inst/cheatsheet/admiral_cheatsheet.pdf">Cheatsheet</a></li>
    <li><a class="dropdown-item" href="https://pharmaverse.github.io/admiraldiscovery/articles/presentation_archive.html">Presentation Archive</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../reference/">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-user-guides" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">User Guides</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-user-guides">
<li><h6 class="dropdown-header" data-toc-skip>General Guides</h6></li>
    <li><a class="dropdown-item" href="../articles/concepts_conventions.html">Programming Concepts and Conventions</a></li>
    <li><a class="dropdown-item" href="../articles/generic.html">Generic Derivations</a></li>
    <li><a class="dropdown-item" href="../articles/higher_order.html">Higher Order Functions</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>ADaM Script Guides</h6></li>
    <li><a class="dropdown-item" href="../articles/adsl.html">Creating a Basic ADSL</a></li>
    <li><a class="dropdown-item" href="../articles/occds.html">Creating an OCCDS ADaM</a></li>
    <li><a class="dropdown-item" href="../articles/bds_finding.html">Creating a BDS Findings ADAM</a></li>
    <li><a class="dropdown-item" href="../articles/bds_exposure.html">Creating a BDS Exposure ADaM</a></li>
    <li><a class="dropdown-item" href="../articles/bds_tte.html">Creating a BDS Time-to-Event ADaM</a></li>
    <li><a class="dropdown-item" href="../articles/questionnaires.html">Creating Questionnaire ADaMs</a></li>
    <li><a class="dropdown-item" href="../articles/pk_adnca.html">Creating a PK NCA or Population PK ADaM</a></li>
    <li><a class="dropdown-item" href="../articles/hys_law.html">Hy's Law Implementation</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Special Topics Guides</h6></li>
    <li><a class="dropdown-item" href="../articles/imputation.html">Date and Time Imputation</a></li>
    <li><a class="dropdown-item" href="../articles/visits_periods.html">Visit and Period Variables</a></li>
    <li><a class="dropdown-item" href="../articles/queries_dataset.html">Queries Dataset Documentation</a></li>
    <li><a class="dropdown-item" href="../articles/lab_grading.html">Lab Grading</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><a class="dropdown-item" href="../articles/faq.html">FAQ</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="https://pharmaverse.github.io/admiraldiscovery/articles/reactable.html">ðŸ”Ž Find my function</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://pharmaverse.slack.com/" aria-label="Slack"><span class="fa fa-slack"></span></a></li>
<li class="nav-item"><a class="nav-link" href="../articles/website-versions.html" aria-label="Previous Release Websites"><span class="fa fa-history"></span></a></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/pharmaverse/admiral/issues/new/choose" aria-label="New Issue"><span class="fa fa-bug"></span></a></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/pharmaverse/admiral/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">



<link href="visits_periods_files/dt-scroll-1.0.0/style.css" rel="stylesheet">
<script src="visits_periods_files/htmlwidgets-1.6.4/htmlwidgets.js"></script><link href="visits_periods_files/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet">
<script src="visits_periods_files/datatables-binding-0.33/datatables.js"></script><link href="visits_periods_files/dt-core-1.13.6/css/jquery.dataTables.min.css" rel="stylesheet">
<link href="visits_periods_files/dt-core-1.13.6/css/jquery.dataTables.extra.css" rel="stylesheet">
<script src="visits_periods_files/dt-core-1.13.6/js/jquery.dataTables.min.js"></script><link href="visits_periods_files/dt-ext-buttons-1.13.6/css/buttons.dataTables.min.css" rel="stylesheet">
<script src="visits_periods_files/dt-ext-buttons-1.13.6/js/dataTables.buttons.min.js"></script><script src="visits_periods_files/dt-ext-buttons-1.13.6/js/buttons.html5.min.js"></script><script src="visits_periods_files/dt-ext-buttons-1.13.6/js/buttons.colVis.min.js"></script><script src="visits_periods_files/dt-ext-buttons-1.13.6/js/buttons.print.min.js"></script><link href="visits_periods_files/dt-ext-colreorder-1.13.6/css/colReorder.dataTables.min.css" rel="stylesheet">
<script src="visits_periods_files/dt-ext-colreorder-1.13.6/js/dataTables.colReorder.min.js"></script><link href="visits_periods_files/dt-ext-scroller-1.13.6/css/scroller.dataTables.min.css" rel="stylesheet">
<script src="visits_periods_files/dt-ext-scroller-1.13.6/js/dataTables.scroller.min.js"></script><link href="visits_periods_files/nouislider-7.0.10/jquery.nouislider.min.css" rel="stylesheet">
<script src="visits_periods_files/nouislider-7.0.10/jquery.nouislider.min.js"></script><link href="visits_periods_files/selectize-0.12.0/selectize.bootstrap3.css" rel="stylesheet">
<script src="visits_periods_files/selectize-0.12.0/selectize.min.js"></script><link href="visits_periods_files/dt-plugin-searchhighlight-1.13.6/source.css" rel="stylesheet">
<script src="visits_periods_files/dt-plugin-searchhighlight-1.13.6/jquery.highlight.js"></script><script src="visits_periods_files/dt-plugin-searchhighlight-1.13.6/source.min.js"></script><link href="visits_periods_files/crosstalk-1.2.1/css/crosstalk.min.css" rel="stylesheet">
<script src="visits_periods_files/crosstalk-1.2.1/js/crosstalk.min.js"></script><div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Visit and Period Variables</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/pharmaverse/admiral/blob/main/vignettes/visits_periods.Rmd" class="external-link"><code>vignettes/visits_periods.Rmd</code></a></small>
      <div class="d-none name"><code>visits_periods.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>The derivation of visit variables like <code>AVISIT</code>,
<code>AVISITN</code>, <code>AWLO</code>, <code>AWHI</code>, â€¦ or period,
subperiod, or phase variables like <code>APERIOD</code>,
<code>TRT01A</code>, <code>TRT02A</code>, <code>ASPER</code>,
<code>PHSDTM</code>, <code>PHEDTM</code>, â€¦ is highly study-specific.
Therefore <a href="https://pharmaverse.github.io/admiral/">admiral</a> cannot provide functions which derive
these variables. However, for common scenarios like visit assignments
based on time windows or deriving BDS period variables from ADSL period
variables, functions are provided which support those derivations.</p>
<div class="section level3">
<h3 id="required-packages">Required Packages<a class="anchor" aria-label="anchor" href="#required-packages"></a>
</h3>
<p>The examples of this vignette require the following packages.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://pharmaverse.github.io/admiral/">admiral</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tibble.tidyverse.org/" class="external-link">tibble</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span>, warn.conflicts <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://lubridate.tidyverse.org" class="external-link">lubridate</a></span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="visits">Visit variables (<code>AVISIT</code>, <code>AVISITN</code>,
<code>AWLO</code>, <code>AWHI</code>, â€¦)<a class="anchor" aria-label="anchor" href="#visits"></a>
</h2>
<p>The most common ways of deriving <code>AVISIT</code> and
<code>AVISITN</code> are:</p>
<ul>
<li>The variables are set to the collected visits (<code>VISIT</code>
and <code>VISITNUM</code>).</li>
<li>The variables are set based on time windows.</li>
</ul>
<p>The former can be achieved simply by calling <code><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate()</a></code>,
like in the vignettes and the template scripts.</p>
<p>For the latter a (study-specific) reference dataset needs to be
created which provides for each visit the start and end day
(<code>AWLO</code> and <code>AWHI</code>) and the values of other visit
related variables (<code>AVISIT</code>, <code>AVISITN</code>,
<code>AWTARGET</code>, â€¦).</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">windows</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tribble.html" class="external-link">tribble</a></span><span class="op">(</span></span>
<span>  <span class="op">~</span><span class="va">AVISIT</span>,    <span class="op">~</span><span class="va">AWLO</span>, <span class="op">~</span><span class="va">AWHI</span>, <span class="op">~</span><span class="va">AVISITN</span>, <span class="op">~</span><span class="va">AWTARGET</span>,</span>
<span>  <span class="st">"BASELINE"</span>,   <span class="op">-</span><span class="fl">30</span>,     <span class="fl">1</span>,        <span class="fl">0</span>,         <span class="fl">1</span>,</span>
<span>  <span class="st">"WEEK 1"</span>,       <span class="fl">2</span>,     <span class="fl">7</span>,        <span class="fl">1</span>,         <span class="fl">5</span>,</span>
<span>  <span class="st">"WEEK 2"</span>,       <span class="fl">8</span>,    <span class="fl">15</span>,        <span class="fl">2</span>,        <span class="fl">11</span>,</span>
<span>  <span class="st">"WEEK 3"</span>,      <span class="fl">16</span>,    <span class="fl">22</span>,        <span class="fl">3</span>,        <span class="fl">19</span>,</span>
<span>  <span class="st">"WEEK 4"</span>,      <span class="fl">23</span>,    <span class="fl">30</span>,        <span class="fl">4</span>,        <span class="fl">26</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>Then the visits can be assigned based on the analysis day
(<code>ADY</code>) by calling <code><a href="../reference/derive_vars_joined.html">derive_vars_joined()</a></code>:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">adbds</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tribble.html" class="external-link">tribble</a></span><span class="op">(</span></span>
<span>  <span class="op">~</span><span class="va">USUBJID</span>, <span class="op">~</span><span class="va">ADY</span>,</span>
<span>  <span class="st">"1"</span>,       <span class="op">-</span><span class="fl">33</span>,</span>
<span>  <span class="st">"1"</span>,        <span class="op">-</span><span class="fl">2</span>,</span>
<span>  <span class="st">"1"</span>,         <span class="fl">3</span>,</span>
<span>  <span class="st">"1"</span>,        <span class="fl">24</span>,</span>
<span>  <span class="st">"2"</span>,        <span class="cn">NA</span>,</span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">adbds1</span> <span class="op">&lt;-</span> <span class="va">adbds</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/derive_vars_joined.html">derive_vars_joined</a></span><span class="op">(</span></span>
<span>    dataset_add <span class="op">=</span> <span class="va">windows</span>,</span>
<span>    filter_join <span class="op">=</span> <span class="va">AWLO</span> <span class="op">&lt;=</span> <span class="va">ADY</span> <span class="op">&amp;</span> <span class="va">ADY</span> <span class="op">&lt;=</span> <span class="va">AWHI</span>,</span>
<span>    join_type <span class="op">=</span> <span class="st">"all"</span>,</span>
<span>  <span class="op">)</span></span></code></pre></div>
<div id="htmlwidget-ac96cb3ee4656e2e9ec3" style="width:auto;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-ac96cb3ee4656e2e9ec3">{"x":{"filter":"top","vertical":false,"filterHTML":"<tr>\n  <td data-type=\"factor\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"width: 100%; display: none;\">\n      <select multiple=\"multiple\" style=\"width: 100%;\" data-options=\"[&quot;1&quot;,&quot;2&quot;]\"><\/select>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"-33\" data-max=\"24\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"factor\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"width: 100%; display: none;\">\n      <select multiple=\"multiple\" style=\"width: 100%;\" data-options=\"[&quot;BASELINE&quot;,&quot;WEEK 1&quot;,&quot;WEEK 4&quot;]\"><\/select>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"-30\" data-max=\"23\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"1\" data-max=\"30\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"0\" data-max=\"4\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"1\" data-max=\"26\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n<\/tr>","extensions":["Buttons","ColReorder","Scroller"],"data":[["1","1","1","1","2"],[-33,-2,3,24,null],[null,"BASELINE","WEEK 1","WEEK 4",null],[null,-30,2,23,null],[null,1,7,30,null],[null,0,1,4,null],[null,1,5,26,null]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th>USUBJID<\/th>\n      <th>ADY<\/th>\n      <th>AVISIT<\/th>\n      <th>AWLO<\/th>\n      <th>AWHI<\/th>\n      <th>AVISITN<\/th>\n      <th>AWTARGET<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-right","targets":[1,3,4,5,6]},{"name":"USUBJID","targets":0},{"name":"ADY","targets":1},{"name":"AVISIT","targets":2},{"name":"AWLO","targets":3},{"name":"AWHI","targets":4},{"name":"AVISITN","targets":5},{"name":"AWTARGET","targets":6}],"searchHighlight":true,"searching":true,"pageLength":5,"lengthMenu":[5,10,15,20,50,100],"dom":"<Bfr<\"dt-scroll\"t>ipl>","buttons":[{"extend":"colvis","text":"Choose the columns to display","scroller":true,"collectionLayout":"fixed two-column"}],"colReorder":true,"order":[],"autoWidth":false,"orderClasses":false,"orderCellsTop":true}},"evals":[],"jsHooks":[]}</script>
</div>
<div class="section level2">
<h2 id="period-subperiod-and-phase-variables">Period, Subperiod, and Phase Variables<a class="anchor" aria-label="anchor" href="#period-subperiod-and-phase-variables"></a>
</h2>
<p>If periods, subperiods, or phases are used, in the simpler of ADaM
applications the corresponding variables have to be consistent across
all datasets. This can be achieved by defining the periods, subperiods,
or phases once and then using this definition for all datasets. The
definition can be stored in ADSL or in a separate dataset. In this
vignetteâ€™s examples, this separate dataset is called period/phase
reference dataset depending what data it contains.</p>
<p>Note that periods, subperiods, or phases <em>can</em> be defined
differently across datasets (for instance, they may be different across
safety and efficacy analyses) in which case the start/stop dates should
be defined in the individual datasets, instead of in ADSL. However, this
vignette will not cover this scenario.</p>
<div class="section level3">
<h3 id="a-note-on-study-specific-code">A Note on Study Specific Code<a class="anchor" aria-label="anchor" href="#a-note-on-study-specific-code"></a>
</h3>
<p>The sections below showcase the available tools in
<a href="https://pharmaverse.github.io/admiral/">admiral</a> to work with period, subperiod and phase
variables. However, at some point study specific code will always be
required. There are two options:</p>
<ul>
<li><p>Study specific code is used to first derive the variables
<code>PxxSwSDT</code> and <code>PxxSwEDT</code> in ADSL. Then
<code><a href="../reference/create_period_dataset.html">create_period_dataset()</a></code> and
<code><a href="../reference/derive_vars_joined.html">derive_vars_joined()</a></code> can be used to derive period/subperiod
variables like <code>ASPER</code> or <code>ASPRSDT</code> in BDS and
OCCDS datasets. See an example dataset <a href="#adsl_example">here</a>.</p></li>
<li><p>Study specific code is used to derive a dataset with one
observation per patient, period, and subperiod (see <a href="#reference">period reference dataset</a>). Then
<code><a href="../reference/derive_vars_period.html">derive_vars_period()</a></code> can be used to derive
<code>PxxSwSDT</code> and <code>PxxSwEDT</code> in ADSL and
<code><a href="../reference/derive_vars_joined.html">derive_vars_joined()</a></code> can be used to derive period/subperiod
variables like <code>ASPER</code> or <code>ASPRSDT</code> in BDS and
OCCDS datasets.</p></li>
</ul>
<p>It depends on the specific definition of the periods/subperiods which
option works best. If the definition is based on other ADSL variables,
the first option would work best. If the definition is based on
vertically structured data like exposure data (EX dataset), the second
option should be used. This vignette contains examples for both
workflows.</p>
</div>
<div class="section level3">
<h3 id="reference">The Period/Phase Reference Dataset<a class="anchor" aria-label="anchor" href="#reference"></a>
</h3>
<p>The <a href="https://pharmaverse.github.io/admiral/">admiral</a> functions expect separate reference
datasets for periods, subperiods, and phases. For periods the numeric
variable <code>APERIOD</code> is expected, for subperiods the numeric
variables <code>APERIOD</code> and <code>ASPER</code>, and for phases
the numeric variable <code>APHASEN</code>.</p>
<p>The period/phase reference dataset should be created according to the
design and ADaM needs of the study in question. It should contain one
observation per subject and period, subperiod, or phase. See the <a href="#example_period">next section</a> for an example dataset.</p>
</div>
<div class="section level3">
<h3 id="example_period">Example Creation of the Period/Phase Reference Dataset<a class="anchor" aria-label="anchor" href="#example_period"></a>
</h3>
<p>Consider a simple crossover study with the following design:</p>
<p><img src="https://raw.githubusercontent.com/pharmaverse/admiral/main/inst/visit_periods/dummy_study_design.png" width="630" height="252" alt="Dummy Study Design Image"><!-- This image is located at the following location within the package: inst/visit_periods/dummy_study_design.png --></p>
<p>Given this design, an option could be to split the study into two
periods:</p>
<ul>
<li>Period 1 (Day 1 to Week 16);</li>
<li>Period 2 (Week 16 to End of Study).</li>
</ul>
<p>Alternatively (or additionally) one could split into two phases:</p>
<ul>
<li>Phase 1 - Treatment (Day 1 to 28 days after Week 28);</li>
<li>Phase 2 - Follow-up (29 days after Week 28 to End of Study).</li>
</ul>
<p>Below, we present two example workflows: one where where a period
reference dataset is created from the exposure dataset EX, and the other
where a phase reference dataset is created using ADSL variables.</p>
<div class="section level4">
<h4 id="creating-the-periodphase-reference-dataset-from-ex">Creating the Period/Phase Reference Dataset from EX<a class="anchor" aria-label="anchor" href="#creating-the-periodphase-reference-dataset-from-ex"></a>
</h4>
<p>Below we create a period reference dataset starting from the exposure
dataset EX. Consider the following exposure dataset:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ex</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tribble.html" class="external-link">tribble</a></span><span class="op">(</span></span>
<span>  <span class="op">~</span><span class="va">STUDYID</span>, <span class="op">~</span><span class="va">USUBJID</span>,  <span class="op">~</span><span class="va">VISIT</span>,    <span class="op">~</span><span class="va">EXTRT</span>,   <span class="op">~</span><span class="va">EXSTDTC</span>,</span>
<span>  <span class="st">"xyz"</span>,    <span class="st">"1"</span>,       <span class="st">"Day 1"</span>,   <span class="st">"Drug X"</span>, <span class="st">"2022-01-02"</span>,</span>
<span>  <span class="st">"xyz"</span>,    <span class="st">"1"</span>,       <span class="st">"Week 4"</span>,  <span class="st">"Drug X"</span>, <span class="st">"2022-02-05"</span>,</span>
<span>  <span class="st">"xyz"</span>,    <span class="st">"1"</span>,       <span class="st">"Week 8"</span>,  <span class="st">"Drug X"</span>, <span class="st">"2022-03-01"</span>,</span>
<span>  <span class="st">"xyz"</span>,    <span class="st">"1"</span>,       <span class="st">"Week 12"</span>, <span class="st">"Drug X"</span>, <span class="st">"2022-04-03"</span>,</span>
<span>  <span class="st">"xyz"</span>,    <span class="st">"1"</span>,       <span class="st">"Week 16"</span>, <span class="st">"Drug Y"</span>, <span class="st">"2022-05-03"</span>,</span>
<span>  <span class="st">"xyz"</span>,    <span class="st">"1"</span>,       <span class="st">"Week 20"</span>, <span class="st">"Drug Y"</span>, <span class="st">"2022-06-02"</span>,</span>
<span>  <span class="st">"xyz"</span>,    <span class="st">"1"</span>,       <span class="st">"Week 24"</span>, <span class="st">"Drug Y"</span>, <span class="st">"2022-07-01"</span>,</span>
<span>  <span class="st">"xyz"</span>,    <span class="st">"1"</span>,       <span class="st">"Week 28"</span>, <span class="st">"Drug Y"</span>, <span class="st">"2022-08-04"</span>,</span>
<span>  <span class="st">"xyz"</span>,    <span class="st">"2"</span>,       <span class="st">"Day 1"</span>,   <span class="st">"Drug Y"</span>, <span class="st">"2023-10-20"</span>,</span>
<span>  <span class="st">"xyz"</span>,    <span class="st">"2"</span>,       <span class="st">"Week 4"</span>,  <span class="st">"Drug Y"</span>, <span class="st">"2023-11-21"</span>,</span>
<span>  <span class="st">"xyz"</span>,    <span class="st">"2"</span>,       <span class="st">"Week 8"</span>,  <span class="st">"Drug Y"</span>, <span class="st">"2023-12-19"</span>,</span>
<span>  <span class="st">"xyz"</span>,    <span class="st">"2"</span>,       <span class="st">"Week 12"</span>, <span class="st">"Drug Y"</span>, <span class="st">"2024-01-19"</span>,</span>
<span>  <span class="st">"xyz"</span>,    <span class="st">"2"</span>,       <span class="st">"Week 16"</span>, <span class="st">"Drug X"</span>, <span class="st">"2024-02-20"</span>,</span>
<span>  <span class="st">"xyz"</span>,    <span class="st">"2"</span>,       <span class="st">"Week 20"</span>, <span class="st">"Drug X"</span>, <span class="st">"2024-03-17"</span>,</span>
<span>  <span class="st">"xyz"</span>,    <span class="st">"2"</span>,       <span class="st">"Week 24"</span>, <span class="st">"Drug X"</span>, <span class="st">"2024-04-22"</span>,</span>
<span>  <span class="st">"xyz"</span>,    <span class="st">"2"</span>,       <span class="st">"Week 28"</span>, <span class="st">"Drug X"</span>, <span class="st">"2024-05-21"</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>Then to create a period reference dataset, code like this (or
similar) would suffice:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">period_ref</span> <span class="op">&lt;-</span> <span class="va">ex</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="co"># Select visits marking the start of each period</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">VISIT</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Day 1"</span>, <span class="st">"Week 16"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="co"># Create APERIOD, APERSDT, TRTA based on SDTM counterparts</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>    APERIOD <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/case_when.html" class="external-link">case_when</a></span><span class="op">(</span></span>
<span>      <span class="va">VISIT</span> <span class="op">==</span> <span class="st">"Day 1"</span> <span class="op">~</span> <span class="fl">1</span>,</span>
<span>      <span class="va">VISIT</span> <span class="op">==</span> <span class="st">"Week 16"</span> <span class="op">~</span> <span class="fl">2</span></span>
<span>    <span class="op">)</span>,</span>
<span>    TRTA <span class="op">=</span> <span class="va">EXTRT</span>,</span>
<span>    APERSDT <span class="op">=</span> <span class="fu"><a href="../reference/convert_dtc_to_dt.html">convert_dtc_to_dt</a></span><span class="op">(</span><span class="va">EXSTDTC</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="co"># Create APEREDT based on start date of next period</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html" class="external-link">arrange</a></span><span class="op">(</span><span class="va">USUBJID</span>, <span class="va">APERSDT</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">USUBJID</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>    APEREDT <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/lead-lag.html" class="external-link">lead</a></span><span class="op">(</span><span class="va">APERSDT</span><span class="op">)</span> <span class="op">-</span> <span class="fl">1</span> <span class="co"># one day before start of next period</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="co"># Tidy up</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">ungroup</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="op">-</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html" class="external-link">starts_with</a></span><span class="op">(</span><span class="st">"EX"</span><span class="op">)</span>, <span class="op">-</span><span class="va">VISIT</span><span class="op">)</span></span></code></pre></div>
<div id="htmlwidget-e5c8c404fe174e4c81bd" style="width:auto;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-e5c8c404fe174e4c81bd">{"x":{"filter":"top","vertical":false,"filterHTML":"<tr>\n  <td data-type=\"factor\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\" disabled=\"\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"width: 100%; display: none;\">\n      <select multiple=\"multiple\" style=\"width: 100%;\" data-options=\"[&quot;xyz&quot;]\"><\/select>\n    <\/div>\n  <\/td>\n  <td data-type=\"factor\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"width: 100%; display: none;\">\n      <select multiple=\"multiple\" style=\"width: 100%;\" data-options=\"[&quot;1&quot;,&quot;2&quot;]\"><\/select>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"1\" data-max=\"2\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"factor\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"width: 100%; display: none;\">\n      <select multiple=\"multiple\" style=\"width: 100%;\" data-options=\"[&quot;Drug X&quot;,&quot;Drug Y&quot;]\"><\/select>\n    <\/div>\n  <\/td>\n  <td data-type=\"date\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"1641081600000\" data-max=\"1708387200000\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"date\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"1651449600000\" data-max=\"1708300800000\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n<\/tr>","extensions":["Buttons","ColReorder","Scroller"],"data":[["xyz","xyz","xyz","xyz"],["1","1","2","2"],[1,2,1,2],["Drug X","Drug Y","Drug Y","Drug X"],["2022-01-02","2022-05-03","2023-10-20","2024-02-20"],["2022-05-02",null,"2024-02-19",null]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th>STUDYID<\/th>\n      <th>USUBJID<\/th>\n      <th>APERIOD<\/th>\n      <th>TRTA<\/th>\n      <th>APERSDT<\/th>\n      <th>APEREDT<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-right","targets":2},{"name":"STUDYID","targets":0},{"name":"USUBJID","targets":1},{"name":"APERIOD","targets":2},{"name":"TRTA","targets":3},{"name":"APERSDT","targets":4},{"name":"APEREDT","targets":5}],"searchHighlight":true,"searching":true,"pageLength":5,"lengthMenu":[5,10,15,20,50,100],"dom":"<Bfr<\"dt-scroll\"t>ipl>","buttons":[{"extend":"colvis","text":"Choose the columns to display","scroller":true,"collectionLayout":"fixed two-column"}],"colReorder":true,"order":[],"autoWidth":false,"orderClasses":false,"orderCellsTop":true}},"evals":[],"jsHooks":[]}</script><p>The workflow above populates the Period End Date <code>APEREDT</code>
for all periods except the last one. The value of the last period could
then be populated with the End of Study Date (<code>EOSDT</code>) from
ADSL, to obtain:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">adsl</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tribble.html" class="external-link">tribble</a></span><span class="op">(</span></span>
<span>  <span class="op">~</span><span class="va">STUDYID</span>,  <span class="op">~</span><span class="va">USUBJID</span>,  <span class="op">~</span><span class="va">TRTSDT</span>,           <span class="op">~</span><span class="va">TRTEDT</span>,           <span class="op">~</span><span class="va">EOSDT</span>,</span>
<span>  <span class="st">"xyz"</span>,     <span class="st">"1"</span>,       <span class="fu"><a href="https://lubridate.tidyverse.org/reference/ymd.html" class="external-link">ymd</a></span><span class="op">(</span><span class="st">"2022-01-02"</span><span class="op">)</span>, <span class="fu"><a href="https://lubridate.tidyverse.org/reference/ymd.html" class="external-link">ymd</a></span><span class="op">(</span><span class="st">"2022-08-04"</span><span class="op">)</span>, <span class="fu"><a href="https://lubridate.tidyverse.org/reference/ymd.html" class="external-link">ymd</a></span><span class="op">(</span><span class="st">"2022-09-10"</span><span class="op">)</span>,</span>
<span>  <span class="st">"xyz"</span>,     <span class="st">"2"</span>,       <span class="fu"><a href="https://lubridate.tidyverse.org/reference/ymd.html" class="external-link">ymd</a></span><span class="op">(</span><span class="st">"2023-10-20"</span><span class="op">)</span>, <span class="fu"><a href="https://lubridate.tidyverse.org/reference/ymd.html" class="external-link">ymd</a></span><span class="op">(</span><span class="st">"2024-05-21"</span><span class="op">)</span>, <span class="fu"><a href="https://lubridate.tidyverse.org/reference/ymd.html" class="external-link">ymd</a></span><span class="op">(</span><span class="st">"2024-06-30"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">period_ref</span> <span class="op">&lt;-</span> <span class="va">period_ref</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">left_join</a></span><span class="op">(</span><span class="va">adsl</span>, by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"STUDYID"</span>, <span class="st">"USUBJID"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>APEREDT <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/case_when.html" class="external-link">case_when</a></span><span class="op">(</span></span>
<span>    <span class="va">APERIOD</span> <span class="op">==</span> <span class="st">"1"</span> <span class="op">~</span> <span class="va">APEREDT</span>,</span>
<span>    <span class="va">APERIOD</span> <span class="op">==</span> <span class="st">"2"</span> <span class="op">~</span> <span class="va">EOSDT</span></span>
<span>  <span class="op">)</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="op">-</span><span class="va">EOSDT</span>, <span class="op">-</span><span class="va">TRTSDT</span>, <span class="op">-</span><span class="va">TRTEDT</span><span class="op">)</span></span></code></pre></div>
<div id="htmlwidget-36aa3d2a04d42bbc2145" style="width:auto;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-36aa3d2a04d42bbc2145">{"x":{"filter":"top","vertical":false,"filterHTML":"<tr>\n  <td data-type=\"factor\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\" disabled=\"\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"width: 100%; display: none;\">\n      <select multiple=\"multiple\" style=\"width: 100%;\" data-options=\"[&quot;xyz&quot;]\"><\/select>\n    <\/div>\n  <\/td>\n  <td data-type=\"factor\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"width: 100%; display: none;\">\n      <select multiple=\"multiple\" style=\"width: 100%;\" data-options=\"[&quot;1&quot;,&quot;2&quot;]\"><\/select>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"1\" data-max=\"2\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"factor\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"width: 100%; display: none;\">\n      <select multiple=\"multiple\" style=\"width: 100%;\" data-options=\"[&quot;Drug X&quot;,&quot;Drug Y&quot;]\"><\/select>\n    <\/div>\n  <\/td>\n  <td data-type=\"date\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"1641081600000\" data-max=\"1708387200000\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"date\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"1651449600000\" data-max=\"1719705600000\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n<\/tr>","extensions":["Buttons","ColReorder","Scroller"],"data":[["xyz","xyz","xyz","xyz"],["1","1","2","2"],[1,2,1,2],["Drug X","Drug Y","Drug Y","Drug X"],["2022-01-02","2022-05-03","2023-10-20","2024-02-20"],["2022-05-02","2022-09-10","2024-02-19","2024-06-30"]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th>STUDYID<\/th>\n      <th>USUBJID<\/th>\n      <th>APERIOD<\/th>\n      <th>TRTA<\/th>\n      <th>APERSDT<\/th>\n      <th>APEREDT<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-right","targets":2},{"name":"STUDYID","targets":0},{"name":"USUBJID","targets":1},{"name":"APERIOD","targets":2},{"name":"TRTA","targets":3},{"name":"APERSDT","targets":4},{"name":"APEREDT","targets":5}],"searchHighlight":true,"searching":true,"pageLength":5,"lengthMenu":[5,10,15,20,50,100],"dom":"<Bfr<\"dt-scroll\"t>ipl>","buttons":[{"extend":"colvis","text":"Choose the columns to display","scroller":true,"collectionLayout":"fixed two-column"}],"colReorder":true,"order":[],"autoWidth":false,"orderClasses":false,"orderCellsTop":true}},"evals":[],"jsHooks":[]}</script>
</div>
<div class="section level4">
<h4 id="from_adsl">Creating the Period/Phase Reference Dataset from ADSL<a class="anchor" aria-label="anchor" href="#from_adsl"></a>
</h4>
<p>If the treatment start and end dates are already included in ADSL, we
can derive the phase variables directly in ADSL and create a phase
reference dataset by employing <code><a href="../reference/create_period_dataset.html">create_period_dataset()</a></code>.
Here is an example command to achieve this goal:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">adsl1</span> <span class="op">&lt;-</span> <span class="va">adsl</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>    PH1SDT <span class="op">=</span> <span class="va">TRTSDT</span>,</span>
<span>    PH1EDT <span class="op">=</span> <span class="va">TRTEDT</span> <span class="op">+</span> <span class="fl">28</span>,</span>
<span>    APHASE1 <span class="op">=</span> <span class="st">"TREATMENT"</span>,</span>
<span>    PH2SDT <span class="op">=</span> <span class="va">TRTEDT</span> <span class="op">+</span> <span class="fl">29</span>,</span>
<span>    PH2EDT <span class="op">=</span> <span class="va">EOSDT</span>,</span>
<span>    APHASE2 <span class="op">=</span> <span class="st">"FUP"</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="va">phase_ref</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/create_period_dataset.html">create_period_dataset</a></span><span class="op">(</span></span>
<span>  <span class="va">adsl1</span>,</span>
<span>  new_vars <span class="op">=</span> <span class="fu"><a href="../reference/reexport-exprs.html">exprs</a></span><span class="op">(</span>PHSDT <span class="op">=</span> <span class="va">PHwSDT</span>, PHEDT <span class="op">=</span> <span class="va">PHwEDT</span>, APHASE <span class="op">=</span> <span class="va">APHASEw</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<div id="htmlwidget-febe03efa1a2d8d52a86" style="width:auto;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-febe03efa1a2d8d52a86">{"x":{"filter":"top","vertical":false,"filterHTML":"<tr>\n  <td data-type=\"factor\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\" disabled=\"\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"width: 100%; display: none;\">\n      <select multiple=\"multiple\" style=\"width: 100%;\" data-options=\"[&quot;xyz&quot;]\"><\/select>\n    <\/div>\n  <\/td>\n  <td data-type=\"factor\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"width: 100%; display: none;\">\n      <select multiple=\"multiple\" style=\"width: 100%;\" data-options=\"[&quot;1&quot;,&quot;2&quot;]\"><\/select>\n    <\/div>\n  <\/td>\n  <td data-type=\"integer\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"1\" data-max=\"2\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"date\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"1641081600000\" data-max=\"1718755200000\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"date\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"1661990400000\" data-max=\"1719705600000\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"factor\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"width: 100%; display: none;\">\n      <select multiple=\"multiple\" style=\"width: 100%;\" data-options=\"[&quot;FUP&quot;,&quot;TREATMENT&quot;]\"><\/select>\n    <\/div>\n  <\/td>\n<\/tr>","extensions":["Buttons","ColReorder","Scroller"],"data":[["xyz","xyz","xyz","xyz"],["1","1","2","2"],[1,2,1,2],["2022-01-02","2022-09-02","2023-10-20","2024-06-19"],["2022-09-01","2022-09-10","2024-06-18","2024-06-30"],["TREATMENT","FUP","TREATMENT","FUP"]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th>STUDYID<\/th>\n      <th>USUBJID<\/th>\n      <th>APHASEN<\/th>\n      <th>PHSDT<\/th>\n      <th>PHEDT<\/th>\n      <th>APHASE<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-right","targets":2},{"name":"STUDYID","targets":0},{"name":"USUBJID","targets":1},{"name":"APHASEN","targets":2},{"name":"PHSDT","targets":3},{"name":"PHEDT","targets":4},{"name":"APHASE","targets":5}],"searchHighlight":true,"searching":true,"pageLength":5,"lengthMenu":[5,10,15,20,50,100],"dom":"<Bfr<\"dt-scroll\"t>ipl>","buttons":[{"extend":"colvis","text":"Choose the columns to display","scroller":true,"collectionLayout":"fixed two-column"}],"colReorder":true,"order":[],"autoWidth":false,"orderClasses":false,"orderCellsTop":true}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<div class="section level3">
<h3 id="periods_adsl">Creating ADSL Period, Subperiod, or Phase Variables<a class="anchor" aria-label="anchor" href="#periods_adsl"></a>
</h3>
<p>If a period/phase reference dataset is available, the ADSL variables
for periods, subperiods, or phases can be created from this dataset by
calling <code><a href="../reference/derive_vars_period.html">derive_vars_period()</a></code>.</p>
<p>For example the period reference dataset from the previous section
can be used to add the period variables (<code>APxxSDT</code>,
<code>APxxEDT</code>) to ADSL:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">adsl2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/derive_vars_period.html">derive_vars_period</a></span><span class="op">(</span></span>
<span>  <span class="va">adsl</span>,</span>
<span>  dataset_ref <span class="op">=</span> <span class="va">period_ref</span>,</span>
<span>  new_vars <span class="op">=</span> <span class="fu"><a href="../reference/reexport-exprs.html">exprs</a></span><span class="op">(</span>APxxSDT <span class="op">=</span> <span class="va">APERSDT</span>, APxxEDT <span class="op">=</span> <span class="va">APEREDT</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<div id="htmlwidget-1fb4450895fe099f74a1" style="width:auto;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-1fb4450895fe099f74a1">{"x":{"filter":"top","vertical":false,"filterHTML":"<tr>\n  <td data-type=\"factor\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\" disabled=\"\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"width: 100%; display: none;\">\n      <select multiple=\"multiple\" style=\"width: 100%;\" data-options=\"[&quot;xyz&quot;]\"><\/select>\n    <\/div>\n  <\/td>\n  <td data-type=\"factor\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"width: 100%; display: none;\">\n      <select multiple=\"multiple\" style=\"width: 100%;\" data-options=\"[&quot;1&quot;,&quot;2&quot;]\"><\/select>\n    <\/div>\n  <\/td>\n  <td data-type=\"date\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"1641081600000\" data-max=\"1.69776e+12\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"date\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"1659571200000\" data-max=\"1716249600000\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"date\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"1.662768e+12\" data-max=\"1719705600000\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"date\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"1641081600000\" data-max=\"1.69776e+12\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"date\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"1.651536e+12\" data-max=\"1708387200000\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"date\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"1651449600000\" data-max=\"1708300800000\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"date\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"1.662768e+12\" data-max=\"1719705600000\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n<\/tr>","extensions":["Buttons","ColReorder","Scroller"],"data":[["xyz","xyz"],["1","2"],["2022-01-02","2023-10-20"],["2022-08-04","2024-05-21"],["2022-09-10","2024-06-30"],["2022-01-02","2023-10-20"],["2022-05-03","2024-02-20"],["2022-05-02","2024-02-19"],["2022-09-10","2024-06-30"]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th>STUDYID<\/th>\n      <th>USUBJID<\/th>\n      <th>TRTSDT<\/th>\n      <th>TRTEDT<\/th>\n      <th>EOSDT<\/th>\n      <th>AP01SDT<\/th>\n      <th>AP02SDT<\/th>\n      <th>AP01EDT<\/th>\n      <th>AP02EDT<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"targets":[2,3,4],"visible":false},{"name":"STUDYID","targets":0},{"name":"USUBJID","targets":1},{"name":"TRTSDT","targets":2},{"name":"TRTEDT","targets":3},{"name":"EOSDT","targets":4},{"name":"AP01SDT","targets":5},{"name":"AP02SDT","targets":6},{"name":"AP01EDT","targets":7},{"name":"AP02EDT","targets":8}],"searchHighlight":true,"searching":true,"pageLength":5,"lengthMenu":[5,10,15,20,50,100],"dom":"<Bfr<\"dt-scroll\"t>ipl>","buttons":[{"extend":"colvis","text":"Choose the columns to display","scroller":true,"collectionLayout":"fixed two-column"}],"colReorder":true,"order":[],"autoWidth":false,"orderClasses":false,"orderCellsTop":true}},"evals":[],"jsHooks":[]}</script>
</div>
<div class="section level3">
<h3 id="periods_bds">Creating BDS and OCCDS Period, Subperiod, or Phase Variables<a class="anchor" aria-label="anchor" href="#periods_bds"></a>
</h3>
<p>If a period/phase reference dataset is available, BDS and OCCDS
variables for periods, subperiods, or phases can be created by calling
<code><a href="../reference/derive_vars_joined.html">derive_vars_joined()</a></code>.</p>
<p>For example the variables <code>APHASEN</code>, <code>PHSDT</code>,
<code>PHEDT</code>, <code>APHASE</code> can be derived from the phase
reference dataset defined above.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">adae</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tribble.html" class="external-link">tribble</a></span><span class="op">(</span></span>
<span>  <span class="op">~</span><span class="va">STUDYID</span>, <span class="op">~</span><span class="va">USUBJID</span>, <span class="op">~</span><span class="va">ASTDT</span>,</span>
<span>  <span class="st">"xyz"</span>,    <span class="st">"1"</span>,      <span class="st">"2022-01-31"</span>,</span>
<span>  <span class="st">"xyz"</span>,    <span class="st">"1"</span>,      <span class="st">"2022-05-02"</span>,</span>
<span>  <span class="st">"xyz"</span>,    <span class="st">"1"</span>,      <span class="st">"2022-09-03"</span>,</span>
<span>  <span class="st">"xyz"</span>,    <span class="st">"1"</span>,      <span class="st">"2022-09-09"</span>,</span>
<span>  <span class="st">"xyz"</span>,    <span class="st">"2"</span>,      <span class="st">"2023-12-25"</span>,</span>
<span>  <span class="st">"xyz"</span>,    <span class="st">"2"</span>,      <span class="st">"2024-06-19"</span>,</span>
<span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>ASTDT <span class="op">=</span> <span class="fu"><a href="https://lubridate.tidyverse.org/reference/ymd.html" class="external-link">ymd</a></span><span class="op">(</span><span class="va">ASTDT</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">adae1</span> <span class="op">&lt;-</span> <span class="va">adae</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/derive_vars_joined.html">derive_vars_joined</a></span><span class="op">(</span></span>
<span>    dataset_add <span class="op">=</span> <span class="va">phase_ref</span>,</span>
<span>    by_vars <span class="op">=</span> <span class="fu"><a href="../reference/reexport-exprs.html">exprs</a></span><span class="op">(</span><span class="va">STUDYID</span>, <span class="va">USUBJID</span><span class="op">)</span>,</span>
<span>    filter_join <span class="op">=</span> <span class="va">PHSDT</span> <span class="op">&lt;=</span> <span class="va">ASTDT</span> <span class="op">&amp;</span> <span class="va">ASTDT</span> <span class="op">&lt;=</span> <span class="va">PHEDT</span>,</span>
<span>    join_type <span class="op">=</span> <span class="st">"all"</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<div id="htmlwidget-10b3b7155e8045a1b2ad" style="width:auto;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-10b3b7155e8045a1b2ad">{"x":{"filter":"top","vertical":false,"filterHTML":"<tr>\n  <td data-type=\"factor\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\" disabled=\"\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"width: 100%; display: none;\">\n      <select multiple=\"multiple\" style=\"width: 100%;\" data-options=\"[&quot;xyz&quot;]\"><\/select>\n    <\/div>\n  <\/td>\n  <td data-type=\"factor\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"width: 100%; display: none;\">\n      <select multiple=\"multiple\" style=\"width: 100%;\" data-options=\"[&quot;1&quot;,&quot;2&quot;]\"><\/select>\n    <\/div>\n  <\/td>\n  <td data-type=\"date\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"1643587200000\" data-max=\"1718755200000\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"integer\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"1\" data-max=\"2\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"date\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"1641081600000\" data-max=\"1718755200000\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"date\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"1661990400000\" data-max=\"1719705600000\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"factor\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"width: 100%; display: none;\">\n      <select multiple=\"multiple\" style=\"width: 100%;\" data-options=\"[&quot;FUP&quot;,&quot;TREATMENT&quot;]\"><\/select>\n    <\/div>\n  <\/td>\n<\/tr>","extensions":["Buttons","ColReorder","Scroller"],"data":[["xyz","xyz","xyz","xyz","xyz","xyz"],["1","1","1","1","2","2"],["2022-01-31","2022-05-02","2022-09-03","2022-09-09","2023-12-25","2024-06-19"],[1,1,2,2,1,2],["2022-01-02","2022-01-02","2022-09-02","2022-09-02","2023-10-20","2024-06-19"],["2022-09-01","2022-09-01","2022-09-10","2022-09-10","2024-06-18","2024-06-30"],["TREATMENT","TREATMENT","FUP","FUP","TREATMENT","FUP"]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th>STUDYID<\/th>\n      <th>USUBJID<\/th>\n      <th>ASTDT<\/th>\n      <th>APHASEN<\/th>\n      <th>PHSDT<\/th>\n      <th>PHEDT<\/th>\n      <th>APHASE<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-right","targets":3},{"name":"STUDYID","targets":0},{"name":"USUBJID","targets":1},{"name":"ASTDT","targets":2},{"name":"APHASEN","targets":3},{"name":"PHSDT","targets":4},{"name":"PHEDT","targets":5},{"name":"APHASE","targets":6}],"searchHighlight":true,"searching":true,"pageLength":5,"lengthMenu":[5,10,15,20,50,100],"dom":"<Bfr<\"dt-scroll\"t>ipl>","buttons":[{"extend":"colvis","text":"Choose the columns to display","scroller":true,"collectionLayout":"fixed two-column"}],"colReorder":true,"order":[],"autoWidth":false,"orderClasses":false,"orderCellsTop":true}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<div class="section level2">
<h2 id="treatment-variables-trtxxp-trtxxa-trtp-trta">Treatment Variables (<code>TRTxxP</code>, <code>TRTxxA</code>,
<code>TRTP</code>, <code>TRTA</code>, â€¦)<a class="anchor" aria-label="anchor" href="#treatment-variables-trtxxp-trtxxa-trtp-trta"></a>
</h2>
<p>In studies with multiple periods the treatment can differ by period,
e.g.Â for a crossover trial - see the <a href="#example_period">previous
section</a> for an example design showcasing this. CDISC defines
variables for planned and actual treatments in ADSL
(<code>TRTxxP</code>, <code>TRTxxA</code>, <code>TRxxPGy</code>,
<code>TRxxAGy</code>, â€¦) and corresponding variables in BDS and OCCDS
datasets (<code>TRTP</code>, <code>TRTA</code>, <code>TRTPGy</code>,
<code>TRTAGy</code>, â€¦). They can be derived in the same way (and same
step) as the period, subperiod, and phase variables.</p>
<div class="section level3">
<h3 id="treatment_adsl">Creating ADSL Treatment Variables<a class="anchor" aria-label="anchor" href="#treatment_adsl"></a>
</h3>
<p>If the treatment information is included in the period/phase
reference dataset, the treatment ADSL variables can be created by
calling <code><a href="../reference/derive_vars_period.html">derive_vars_period()</a></code>. This is showcased below using
the period reference dataset from previous sections.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">adsl</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/derive_vars_period.html">derive_vars_period</a></span><span class="op">(</span></span>
<span>  <span class="va">adsl</span>,</span>
<span>  dataset_ref <span class="op">=</span> <span class="va">period_ref</span>,</span>
<span>  new_vars <span class="op">=</span> <span class="fu"><a href="../reference/reexport-exprs.html">exprs</a></span><span class="op">(</span></span>
<span>    APxxSDT <span class="op">=</span> <span class="va">APERSDT</span>,</span>
<span>    APxxEDT <span class="op">=</span> <span class="va">APEREDT</span>,</span>
<span>    TRTxxA <span class="op">=</span> <span class="va">TRTA</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<div id="htmlwidget-4018eef1a407a0df6b52" style="width:auto;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-4018eef1a407a0df6b52">{"x":{"filter":"top","vertical":false,"filterHTML":"<tr>\n  <td data-type=\"factor\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\" disabled=\"\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"width: 100%; display: none;\">\n      <select multiple=\"multiple\" style=\"width: 100%;\" data-options=\"[&quot;xyz&quot;]\"><\/select>\n    <\/div>\n  <\/td>\n  <td data-type=\"factor\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"width: 100%; display: none;\">\n      <select multiple=\"multiple\" style=\"width: 100%;\" data-options=\"[&quot;1&quot;,&quot;2&quot;]\"><\/select>\n    <\/div>\n  <\/td>\n  <td data-type=\"date\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"1641081600000\" data-max=\"1.69776e+12\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"date\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"1659571200000\" data-max=\"1716249600000\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"date\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"1.662768e+12\" data-max=\"1719705600000\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"date\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"1641081600000\" data-max=\"1.69776e+12\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"date\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"1.651536e+12\" data-max=\"1708387200000\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"date\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"1651449600000\" data-max=\"1708300800000\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"date\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"1.662768e+12\" data-max=\"1719705600000\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"factor\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"width: 100%; display: none;\">\n      <select multiple=\"multiple\" style=\"width: 100%;\" data-options=\"[&quot;Drug X&quot;,&quot;Drug Y&quot;]\"><\/select>\n    <\/div>\n  <\/td>\n  <td data-type=\"factor\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"width: 100%; display: none;\">\n      <select multiple=\"multiple\" style=\"width: 100%;\" data-options=\"[&quot;Drug X&quot;,&quot;Drug Y&quot;]\"><\/select>\n    <\/div>\n  <\/td>\n<\/tr>","extensions":["Buttons","ColReorder","Scroller"],"data":[["xyz","xyz"],["1","2"],["2022-01-02","2023-10-20"],["2022-08-04","2024-05-21"],["2022-09-10","2024-06-30"],["2022-01-02","2023-10-20"],["2022-05-03","2024-02-20"],["2022-05-02","2024-02-19"],["2022-09-10","2024-06-30"],["Drug X","Drug Y"],["Drug Y","Drug X"]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th>STUDYID<\/th>\n      <th>USUBJID<\/th>\n      <th>TRTSDT<\/th>\n      <th>TRTEDT<\/th>\n      <th>EOSDT<\/th>\n      <th>AP01SDT<\/th>\n      <th>AP02SDT<\/th>\n      <th>AP01EDT<\/th>\n      <th>AP02EDT<\/th>\n      <th>TRT01A<\/th>\n      <th>TRT02A<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"targets":[2,3,4],"visible":false},{"name":"STUDYID","targets":0},{"name":"USUBJID","targets":1},{"name":"TRTSDT","targets":2},{"name":"TRTEDT","targets":3},{"name":"EOSDT","targets":4},{"name":"AP01SDT","targets":5},{"name":"AP02SDT","targets":6},{"name":"AP01EDT","targets":7},{"name":"AP02EDT","targets":8},{"name":"TRT01A","targets":9},{"name":"TRT02A","targets":10}],"searchHighlight":true,"searching":true,"pageLength":5,"lengthMenu":[5,10,15,20,50,100],"dom":"<Bfr<\"dt-scroll\"t>ipl>","buttons":[{"extend":"colvis","text":"Choose the columns to display","scroller":true,"collectionLayout":"fixed two-column"}],"colReorder":true,"order":[],"autoWidth":false,"orderClasses":false,"orderCellsTop":true}},"evals":[],"jsHooks":[]}</script>
</div>
<div class="section level3">
<h3 id="treatment_bds">Creating BDS and OCCDS Treatment Variables<a class="anchor" aria-label="anchor" href="#treatment_bds"></a>
</h3>
<p>If a period/phase reference dataset is available, BDS and OCCDS
variables for treatment can be created by calling
<code><a href="../reference/derive_vars_joined.html">derive_vars_joined()</a></code>.</p>
<p>For example the variables <code>APERIOD</code> and <code>TRTA</code>
can be derived from the period reference dataset defined above.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">adae</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tribble.html" class="external-link">tribble</a></span><span class="op">(</span></span>
<span>  <span class="op">~</span><span class="va">STUDYID</span>, <span class="op">~</span><span class="va">USUBJID</span>, <span class="op">~</span><span class="va">ASTDT</span>,</span>
<span>  <span class="st">"xyz"</span>,    <span class="st">"1"</span>,      <span class="st">"2022-01-31"</span>,</span>
<span>  <span class="st">"xyz"</span>,    <span class="st">"1"</span>,      <span class="st">"2022-05-02"</span>,</span>
<span>  <span class="st">"xyz"</span>,    <span class="st">"1"</span>,      <span class="st">"2022-08-24"</span>,</span>
<span>  <span class="st">"xyz"</span>,    <span class="st">"1"</span>,      <span class="st">"2022-09-09"</span>,</span>
<span>  <span class="st">"xyz"</span>,    <span class="st">"2"</span>,      <span class="st">"2023-12-25"</span>,</span>
<span>  <span class="st">"xyz"</span>,    <span class="st">"2"</span>,      <span class="st">"2024-06-07"</span>,</span>
<span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>ASTDT <span class="op">=</span> <span class="fu"><a href="https://lubridate.tidyverse.org/reference/ymd.html" class="external-link">ymd</a></span><span class="op">(</span><span class="va">ASTDT</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">adae2</span> <span class="op">&lt;-</span> <span class="va">adae</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/derive_vars_joined.html">derive_vars_joined</a></span><span class="op">(</span></span>
<span>    dataset_add <span class="op">=</span> <span class="va">period_ref</span>,</span>
<span>    by_vars <span class="op">=</span> <span class="fu"><a href="../reference/reexport-exprs.html">exprs</a></span><span class="op">(</span><span class="va">STUDYID</span>, <span class="va">USUBJID</span><span class="op">)</span>,</span>
<span>    new_vars <span class="op">=</span> <span class="fu"><a href="../reference/reexport-exprs.html">exprs</a></span><span class="op">(</span><span class="va">APERIOD</span>, <span class="va">TRTA</span><span class="op">)</span>,</span>
<span>    join_vars <span class="op">=</span> <span class="fu"><a href="../reference/reexport-exprs.html">exprs</a></span><span class="op">(</span><span class="va">APERSDT</span>, <span class="va">APEREDT</span><span class="op">)</span>,</span>
<span>    join_type <span class="op">=</span> <span class="st">"all"</span>,</span>
<span>    filter_join <span class="op">=</span> <span class="va">APERSDT</span> <span class="op">&lt;=</span> <span class="va">ASTDT</span> <span class="op">&amp;</span> <span class="va">ASTDT</span> <span class="op">&lt;=</span> <span class="va">APEREDT</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<div id="htmlwidget-5b1b2f4ad92281566982" style="width:auto;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-5b1b2f4ad92281566982">{"x":{"filter":"top","vertical":false,"filterHTML":"<tr>\n  <td data-type=\"factor\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\" disabled=\"\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"width: 100%; display: none;\">\n      <select multiple=\"multiple\" style=\"width: 100%;\" data-options=\"[&quot;xyz&quot;]\"><\/select>\n    <\/div>\n  <\/td>\n  <td data-type=\"factor\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"width: 100%; display: none;\">\n      <select multiple=\"multiple\" style=\"width: 100%;\" data-options=\"[&quot;1&quot;,&quot;2&quot;]\"><\/select>\n    <\/div>\n  <\/td>\n  <td data-type=\"date\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"1643587200000\" data-max=\"1717718400000\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"1\" data-max=\"2\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"factor\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"width: 100%; display: none;\">\n      <select multiple=\"multiple\" style=\"width: 100%;\" data-options=\"[&quot;Drug X&quot;,&quot;Drug Y&quot;]\"><\/select>\n    <\/div>\n  <\/td>\n<\/tr>","extensions":["Buttons","ColReorder","Scroller"],"data":[["xyz","xyz","xyz","xyz","xyz","xyz"],["1","1","1","1","2","2"],["2022-01-31","2022-05-02","2022-08-24","2022-09-09","2023-12-25","2024-06-07"],[1,1,2,2,1,2],["Drug X","Drug X","Drug Y","Drug Y","Drug Y","Drug X"]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th>STUDYID<\/th>\n      <th>USUBJID<\/th>\n      <th>ASTDT<\/th>\n      <th>APERIOD<\/th>\n      <th>TRTA<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-right","targets":3},{"name":"STUDYID","targets":0},{"name":"USUBJID","targets":1},{"name":"ASTDT","targets":2},{"name":"APERIOD","targets":3},{"name":"TRTA","targets":4}],"searchHighlight":true,"searching":true,"pageLength":5,"lengthMenu":[5,10,15,20,50,100],"dom":"<Bfr<\"dt-scroll\"t>ipl>","buttons":[{"extend":"colvis","text":"Choose the columns to display","scroller":true,"collectionLayout":"fixed two-column"}],"colReorder":true,"order":[],"autoWidth":false,"orderClasses":false,"orderCellsTop":true}},"evals":[],"jsHooks":[]}</script><p>If no period/phase reference dataset is available but period/phase
variables are in ADSL, then the former can again be created from ADSL by
calling <code><a href="../reference/create_period_dataset.html">create_period_dataset()</a></code>, as was showcased <a href="#from_adsl">here</a>.</p>
<p>This time, when calling <code><a href="../reference/create_period_dataset.html">create_period_dataset()</a></code> we just
need to make sure we include <code>TRTA = TRTxxA</code> as part of the
<code>new_vars</code> argument to create the treatment variables as
well.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">period_ref1</span> <span class="op">&lt;-</span> <span class="va">adsl</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/create_period_dataset.html">create_period_dataset</a></span><span class="op">(</span></span>
<span>    new_vars <span class="op">=</span> <span class="fu"><a href="../reference/reexport-exprs.html">exprs</a></span><span class="op">(</span>APERSDT <span class="op">=</span> <span class="va">APxxSDT</span>, APEREDT <span class="op">=</span> <span class="va">APxxEDT</span>, TRTA <span class="op">=</span> <span class="va">TRTxxA</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<div id="htmlwidget-25c3e940e6859592f801" style="width:auto;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-25c3e940e6859592f801">{"x":{"filter":"top","vertical":false,"filterHTML":"<tr>\n  <td data-type=\"factor\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\" disabled=\"\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"width: 100%; display: none;\">\n      <select multiple=\"multiple\" style=\"width: 100%;\" data-options=\"[&quot;xyz&quot;]\"><\/select>\n    <\/div>\n  <\/td>\n  <td data-type=\"factor\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"width: 100%; display: none;\">\n      <select multiple=\"multiple\" style=\"width: 100%;\" data-options=\"[&quot;1&quot;,&quot;2&quot;]\"><\/select>\n    <\/div>\n  <\/td>\n  <td data-type=\"integer\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"1\" data-max=\"2\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"date\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"1641081600000\" data-max=\"1708387200000\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"date\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"1651449600000\" data-max=\"1719705600000\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"factor\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"width: 100%; display: none;\">\n      <select multiple=\"multiple\" style=\"width: 100%;\" data-options=\"[&quot;Drug X&quot;,&quot;Drug Y&quot;]\"><\/select>\n    <\/div>\n  <\/td>\n<\/tr>","extensions":["Buttons","ColReorder","Scroller"],"data":[["xyz","xyz","xyz","xyz"],["1","1","2","2"],[1,2,1,2],["2022-01-02","2022-05-03","2023-10-20","2024-02-20"],["2022-05-02","2022-09-10","2024-02-19","2024-06-30"],["Drug X","Drug Y","Drug Y","Drug X"]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th>STUDYID<\/th>\n      <th>USUBJID<\/th>\n      <th>APERIOD<\/th>\n      <th>APERSDT<\/th>\n      <th>APEREDT<\/th>\n      <th>TRTA<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-right","targets":2},{"name":"STUDYID","targets":0},{"name":"USUBJID","targets":1},{"name":"APERIOD","targets":2},{"name":"APERSDT","targets":3},{"name":"APEREDT","targets":4},{"name":"TRTA","targets":5}],"searchHighlight":true,"searching":true,"pageLength":5,"lengthMenu":[5,10,15,20,50,100],"dom":"<Bfr<\"dt-scroll\"t>ipl>","buttons":[{"extend":"colvis","text":"Choose the columns to display","scroller":true,"collectionLayout":"fixed two-column"}],"colReorder":true,"order":[],"autoWidth":false,"orderClasses":false,"orderCellsTop":true}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Ben Straub, Stefan Bundfuss, Jeffrey Dickinson, Ross Farrugia, Fanny Gautier, Dinakar Kulkarni, Edoardo Mancini, Sadchla Mascary, Gordon Miller, Jim Rothstein, Sophie Shapcott, Eric Simms, Daniel Sjoberg, Stefan Thoma, Phillip Webster, Zelos Zhu, F. Hoffmann-La Roche AG, GlaxoSmithKline LLC.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
