<!DOCTYPE html>
<!-- Generated by pkgdown + https://github.com/insightsengineering/r-pkgdown-multiversion -->
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Add New Records Within By Groups Using Aggregation Functions â€” derive_summary_records â€¢ admiral</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><script src="../deps/MathJax-3.2.2/tex-chtml.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Add New Records Within By Groups Using Aggregation Functions â€” derive_summary_records">
<meta name="description" content="It is not uncommon to have an analysis need whereby one needs to derive an
analysis value (AVAL) from multiple records. The ADaM basic dataset
structure variable DTYPE is available to indicate when a new derived
records has been added to a dataset, if the derivation deviates from the
standard derivation of the parameter.">
<meta property="og:description" content="It is not uncommon to have an analysis need whereby one needs to derive an
analysis value (AVAL) from multiple records. The ADaM basic dataset
structure variable DTYPE is available to indicate when a new derived
records has been added to a dataset, if the derivation deviates from the
standard derivation of the parameter.">
<meta property="og:image" content="https:/pharmaverse.github.io/admiral/main/logo.png">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">admiral</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.3.1.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-get-started" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Get Started</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-get-started">
<li><a class="dropdown-item" href="../articles/admiral.html">Get Started</a></li>
    <li><a class="external-link dropdown-item" href="https://github.com/pharmaverse/admiral/blob/main/inst/cheatsheet/admiral_cheatsheet.pdf">Cheatsheet</a></li>
    <li><a class="external-link dropdown-item" href="https://pharmaverse.github.io/admiraldiscovery/articles/presentation_archive.html">Presentation Archive</a></li>
  </ul>
</li>
<li class="active nav-item"><a class="nav-link" href="../reference/">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-user-guides" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">User Guides</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-user-guides">
<li><h6 class="dropdown-header" data-toc-skip>General Guides</h6></li>
    <li><a class="dropdown-item" href="../articles/concepts_conventions.html">Programming Concepts and Conventions</a></li>
    <li><a class="dropdown-item" href="../articles/generic.html">Generic Derivations</a></li>
    <li><a class="dropdown-item" href="../articles/higher_order.html">Higher Order Functions</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>ADaM Script Guides</h6></li>
    <li><a class="dropdown-item" href="../articles/adsl.html">Creating a Basic ADSL</a></li>
    <li><a class="dropdown-item" href="../articles/occds.html">Creating an OCCDS ADaM</a></li>
    <li><a class="dropdown-item" href="../articles/bds_finding.html">Creating a BDS Findings ADAM</a></li>
    <li><a class="dropdown-item" href="../articles/bds_exposure.html">Creating a BDS Exposure ADaM</a></li>
    <li><a class="dropdown-item" href="../articles/bds_tte.html">Creating a BDS Time-to-Event ADaM</a></li>
    <li><a class="dropdown-item" href="../articles/questionnaires.html">Creating Questionnaire ADaMs</a></li>
    <li><a class="dropdown-item" href="../articles/pk_adnca.html">Creating a PK NCA or Population PK ADaM</a></li>
    <li><a class="dropdown-item" href="../articles/hys_law.html">Hy's Law Implementation</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Special Topics Guides</h6></li>
    <li><a class="dropdown-item" href="../articles/imputation.html">Date and Time Imputation</a></li>
    <li><a class="dropdown-item" href="../articles/visits_periods.html">Visit and Period Variables</a></li>
    <li><a class="dropdown-item" href="../articles/queries_dataset.html">Queries Dataset Documentation</a></li>
    <li><a class="dropdown-item" href="../articles/lab_grading.html">Lab Grading</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><a class="dropdown-item" href="../articles/faq.html">FAQ</a></li>
  </ul>
</li>
<li class="nav-item"><a class="external-link nav-link" href="https://pharmaverse.github.io/admiraldiscovery/articles/reactable.html">ðŸ”Ž Find my function</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      <div><li class="nav-item dropdown">
    <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-versions">Versions</a>
    <div class="dropdown-menu" aria-labelledby="dropdown-versions">
    <a class="dropdown-item" data-toggle="tooltip" title="" href="https://pharmaverse.github.io/admiral/main">main</a>
<a class="dropdown-item" data-toggle="tooltip" title="" href="https://pharmaverse.github.io/admiral/cran-release">cran-release</a>
<a class="dropdown-item" data-toggle="tooltip" title="" href="https://pharmaverse.github.io/admiral/v1.3.0">v1.3.0</a>
<a class="dropdown-item" data-toggle="tooltip" title="" href="https://pharmaverse.github.io/admiral/v1.2.0">v1.2.0</a>
<a class="dropdown-item" data-toggle="tooltip" title="" href="https://pharmaverse.github.io/admiral/v1.1.1">v1.1.1</a>
<a class="dropdown-item" data-toggle="tooltip" title="" href="https://pharmaverse.github.io/admiral/v1.1.0">v1.1.0</a>
<a class="dropdown-item" data-toggle="tooltip" title="" href="https://pharmaverse.github.io/admiral/v1.0.2">v1.0.2</a>
<a class="dropdown-item" data-toggle="tooltip" title="" href="https://pharmaverse.github.io/admiral/v1.0.1">v1.0.1</a>
<a class="dropdown-item" data-toggle="tooltip" title="" href="https://pharmaverse.github.io/admiral/v1.0.0">v1.0.0</a>
</div>
</li></div>
</ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://pharmaverse.slack.com/" aria-label="Slack"><span class="fa fa-slack"></span></a></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/pharmaverse/admiral/issues/new/choose" aria-label="New Issue"><span class="fa fa-bug"></span></a></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/pharmaverse/admiral/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Add New Records Within By Groups Using Aggregation Functions</h1>
      <small class="dont-index">Source: <a href="https://github.com/pharmaverse/admiral/blob/main/R/derive_summary_records.R" class="external-link"><code>R/derive_summary_records.R</code></a></small>
      <div class="d-none name"><code>derive_summary_records.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>It is not uncommon to have an analysis need whereby one needs to derive an
analysis value (<code>AVAL</code>) from multiple records. The ADaM basic dataset
structure variable <code>DTYPE</code> is available to indicate when a new derived
records has been added to a dataset, if the derivation deviates from the
standard derivation of the parameter.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a>
</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">derive_summary_records</span><span class="op">(</span></span>
<span>  dataset <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">dataset_add</span>,</span>
<span>  dataset_ref <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">by_vars</span>,</span>
<span>  filter_add <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">set_values_to</span>,</span>
<span>  missing_values <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a>
</h2>


<dl>
<dt id="arg-dataset">dataset<a class="anchor" aria-label="anchor" href="#arg-dataset"></a>
</dt>
<dd>
<p>Input dataset</p>
<p>If the argument is not specified (or set to <code>NULL</code>), a new dataset is
created. Otherwise, the new records are appended to the specified dataset.</p>
<dl>
<dt>Permitted values</dt>
<dd><p>a dataset, i.e., a <code>data.frame</code> or tibble</p></dd>

<dt>Default value</dt>
<dd><p><code>NULL</code></p></dd>


</dl>
</dd>


<dt id="arg-dataset-add">dataset_add<a class="anchor" aria-label="anchor" href="#arg-dataset-add"></a>
</dt>
<dd>
<p>Additional dataset</p>
<p>The variables specified for <code>by_vars</code> are expected.
Observations from the specified dataset are going to be used to calculate and added
as new records to the input dataset (<code>dataset</code>).</p>
<dl>
<dt>Permitted values</dt>
<dd><p>a dataset, i.e., a <code>data.frame</code> or tibble</p></dd>

<dt>Default value</dt>
<dd><p>none</p></dd>


</dl>
</dd>


<dt id="arg-dataset-ref">dataset_ref<a class="anchor" aria-label="anchor" href="#arg-dataset-ref"></a>
</dt>
<dd>
<p>Reference dataset</p>
<p>The variables specified for <code>by_vars</code> are expected. For each
observation of the specified dataset a new observation is added to the
input dataset.</p>
<dl>
<dt>Permitted values</dt>
<dd><p>a dataset, i.e., a <code>data.frame</code> or tibble</p></dd>

<dt>Default value</dt>
<dd><p><code>NULL</code></p></dd>


</dl>
</dd>


<dt id="arg-by-vars">by_vars<a class="anchor" aria-label="anchor" href="#arg-by-vars"></a>
</dt>
<dd>
<p>Grouping variables</p>
<p>Variables to consider for generation of groupwise summary
records. Providing the names of variables in <code><a href="reexport-exprs.html">exprs()</a></code> will create a
groupwise summary and generate summary records for the specified groups.</p>
<dl>
<dt>Permitted values</dt>
<dd><p>list of variables created by <code><a href="reexport-exprs.html">exprs()</a></code>, e.g., <code>exprs(USUBJID, VISIT)</code></p></dd>

<dt>Default value</dt>
<dd><p>none</p></dd>


</dl>
</dd>


<dt id="arg-filter-add">filter_add<a class="anchor" aria-label="anchor" href="#arg-filter-add"></a>
</dt>
<dd>
<p>Filter condition as logical expression to apply during
summary calculation. By default, filtering expressions are computed within
<code>by_vars</code> as this will help when an aggregating, lagging, or ranking
function is involved.</p>
<p>For example,</p>
<ul>
<li><p><code>filter_add = (AVAL &gt; mean(AVAL, na.rm = TRUE))</code> will filter all <code>AVAL</code>
values greater than mean of <code>AVAL</code> with in <code>by_vars</code>.</p></li>
<li><p><code>filter_add = (dplyr::n() &gt; 2)</code> will filter n count of <code>by_vars</code> greater
than 2.</p></li>
</ul>
<dl>
<dt>Permitted values</dt>
<dd><p>an unquoted condition, e.g., <code>AVISIT == "BASELINE"</code></p></dd>

<dt>Default value</dt>
<dd><p><code>NULL</code></p></dd>


</dl>
</dd>


<dt id="arg-set-values-to">set_values_to<a class="anchor" aria-label="anchor" href="#arg-set-values-to"></a>
</dt>
<dd>
<p>Variables to be set</p>
<p>The specified variables are set to the specified values for the new
observations.</p>
<p>Set a list of variables to some specified value for the new records</p>
<ul>
<li><p>LHS refer to a variable.</p></li>
<li><p>RHS refers to the values to set to the variable. This can be a string, a
symbol, a numeric value, an expression or NA. If summary functions are
used, the values are summarized by the variables specified for <code>by_vars</code>.</p></li>
</ul>
<p>For example:</p>
<p></p>
<div class="sourceCode">
<pre><code><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a>  set_values_to <span class="ot">=</span> <span class="fu">exprs</span>(</span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a>    <span class="at">AVAL =</span> <span class="fu">sum</span>(AVAL),</span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a>    <span class="at">DTYPE =</span> <span class="st">"AVERAGE"</span>,</span>
<span id="cb1-4"><a href="#cb1-4" tabindex="-1"></a>  )</span></code></pre>
<p></p>
</div>
<dl>
<dt>Permitted values</dt>
<dd><p>list of named expressions created by <code><a href="reexport-exprs.html">exprs()</a></code>, e.g., <code>exprs(CUMDOSA = sum(AVAL, na.rm = TRUE), AVALU = "ml")</code></p></dd>

<dt>Default value</dt>
<dd><p>none</p></dd>


</dl>
</dd>


<dt id="arg-missing-values">missing_values<a class="anchor" aria-label="anchor" href="#arg-missing-values"></a>
</dt>
<dd>
<p>Values for missing summary values</p>
<p>For observations of the reference dataset (<code>dataset_ref</code>) which do not have a
complete mapping defined by the summarization defined in <code>set_values_to</code>.  Only variables
specified for <code>set_values_to</code> can be specified for <code>missing_values</code>.</p>
<dl>
<dt>Permitted values</dt>
<dd><p>list of named expressions created by <code><a href="reexport-exprs.html">exprs()</a></code>, e.g., <code>exprs(CUMDOSA = sum(AVAL, na.rm = TRUE), AVALU = "ml")</code></p></dd>

<dt>Default value</dt>
<dd><p><code>NULL</code></p></dd>


</dl>
</dd>

</dl>
</div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a>
</h2>
    <p>A data frame with derived records appended to original dataset.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a>
</h2>
    <p>For the newly derived records, only variables specified within <code>by_vars</code> or
<code>set_values_to</code> will be populated. All other variables will be set to <code>NA</code>.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a>
</h2>
    <div class="dont-index">
<p><code><a href="derive_var_merged_summary.html">derive_var_merged_summary()</a></code></p>
<p>BDS-Findings Functions for adding Parameters/Records:
<code><a href="default_qtc_paramcd.html">default_qtc_paramcd</a>()</code>,
<code><a href="derive_expected_records.html">derive_expected_records</a>()</code>,
<code><a href="derive_extreme_event.html">derive_extreme_event</a>()</code>,
<code><a href="derive_extreme_records.html">derive_extreme_records</a>()</code>,
<code><a href="derive_locf_records.html">derive_locf_records</a>()</code>,
<code><a href="derive_param_bmi.html">derive_param_bmi</a>()</code>,
<code><a href="derive_param_bsa.html">derive_param_bsa</a>()</code>,
<code><a href="derive_param_computed.html">derive_param_computed</a>()</code>,
<code><a href="derive_param_doseint.html">derive_param_doseint</a>()</code>,
<code><a href="derive_param_exist_flag.html">derive_param_exist_flag</a>()</code>,
<code><a href="derive_param_exposure.html">derive_param_exposure</a>()</code>,
<code><a href="derive_param_framingham.html">derive_param_framingham</a>()</code>,
<code><a href="derive_param_map.html">derive_param_map</a>()</code>,
<code><a href="derive_param_qtc.html">derive_param_qtc</a>()</code>,
<code><a href="derive_param_rr.html">derive_param_rr</a>()</code>,
<code><a href="derive_param_wbc_abs.html">derive_param_wbc_abs</a>()</code></p>
</div>
    </div>
    <div class="section level2">
    <h2 id="examples">Examples<a class="anchor" aria-label="anchor" href="#examples"></a>
</h2>

<div class="section">
<h3 id="data-setup">Data setup<a class="anchor" aria-label="anchor" href="#data-setup"></a>
</h3>


<p>The following examples use the ECG dataset below as a basis.</p>
<p></p>
<div class="sourceCode r">
<pre><code><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tibble.tidyverse.org/" class="external-link">tibble</a></span>, warn.conflicts <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span>, warn.conflicts <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="va">adeg</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tribble.html" class="external-link">tribble</a></span><span class="op">(</span></span>
<span>  <span class="op">~</span><span class="va">USUBJID</span>,   <span class="op">~</span><span class="va">PARAM</span>,             <span class="op">~</span><span class="va">AVISIT</span>,    <span class="op">~</span><span class="va">EGDTC</span>,             <span class="op">~</span><span class="va">AVAL</span>,</span>
<span>  <span class="st">"XYZ-1001"</span>, <span class="st">"QTcF Int. (msec)"</span>, <span class="st">"Baseline"</span>, <span class="st">"2016-02-24T07:50"</span>, <span class="fl">385</span>,</span>
<span>  <span class="st">"XYZ-1001"</span>, <span class="st">"QTcF Int. (msec)"</span>, <span class="st">"Baseline"</span>, <span class="st">"2016-02-24T07:52"</span>, <span class="fl">399</span>,</span>
<span>  <span class="st">"XYZ-1001"</span>, <span class="st">"QTcF Int. (msec)"</span>, <span class="st">"Baseline"</span>, <span class="st">"2016-02-24T07:56"</span>, <span class="fl">396</span>,</span>
<span>  <span class="st">"XYZ-1001"</span>, <span class="st">"QTcF Int. (msec)"</span>, <span class="st">"Visit 2"</span>,  <span class="st">"2016-03-08T09:48"</span>, <span class="fl">393</span>,</span>
<span>  <span class="st">"XYZ-1001"</span>, <span class="st">"QTcF Int. (msec)"</span>, <span class="st">"Visit 2"</span>,  <span class="st">"2016-03-08T09:51"</span>, <span class="fl">388</span>,</span>
<span>  <span class="st">"XYZ-1001"</span>, <span class="st">"QTcF Int. (msec)"</span>, <span class="st">"Visit 3"</span>,  <span class="st">"2016-03-22T10:48"</span>, <span class="fl">394</span>,</span>
<span>  <span class="st">"XYZ-1001"</span>, <span class="st">"QTcF Int. (msec)"</span>, <span class="st">"Visit 3"</span>,  <span class="st">"2016-03-22T10:51"</span>, <span class="fl">402</span>,</span>
<span>  <span class="st">"XYZ-1002"</span>, <span class="st">"QTcF Int. (msec)"</span>, <span class="st">"Baseline"</span>, <span class="st">"2016-02-22T07:58"</span>, <span class="fl">399</span>,</span>
<span>  <span class="st">"XYZ-1002"</span>, <span class="st">"QTcF Int. (msec)"</span>, <span class="st">"Baseline"</span>, <span class="st">"2016-02-22T07:58"</span>, <span class="fl">200</span>,</span>
<span>  <span class="st">"XYZ-1002"</span>, <span class="st">"QTcF Int. (msec)"</span>, <span class="st">"Baseline"</span>, <span class="st">"2016-02-22T08:01"</span>, <span class="fl">392</span>,</span>
<span>  <span class="st">"XYZ-1002"</span>, <span class="st">"QTcF Int. (msec)"</span>, <span class="st">"Visit 3"</span>,  <span class="st">"2016-03-24T10:53"</span>, <span class="fl">414</span>,</span>
<span>  <span class="st">"XYZ-1002"</span>, <span class="st">"QTcF Int. (msec)"</span>, <span class="st">"Visit 3"</span>,  <span class="st">"2016-03-24T10:56"</span>, <span class="fl">402</span></span>
<span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>ADTM <span class="op">=</span> <span class="fu"><a href="../reference/convert_dtc_to_dtm.html">convert_dtc_to_dtm</a></span><span class="op">(</span><span class="va">EGDTC</span><span class="op">)</span><span class="op">)</span></span></code></pre>
<p></p>
</div>
</div>
<div class="section">
<h3 id="summarize-one-or-more-variables-using-summary-functions">Summarize one or more variables using summary functions<a class="anchor" aria-label="anchor" href="#summarize-one-or-more-variables-using-summary-functions"></a>
</h3>


<p>A derived record is generated for each subject, containing the mean of the triplicate ECG
interval values (<code>AVAL</code>) and the latest measurement's time (<code>ADTM</code>) by using summary functions
within the <code>set_values_to</code> argument.</p>
<p></p>
<div class="sourceCode r">
<pre><code><span><span class="fu"><a href="../reference/derive_summary_records.html">derive_summary_records</a></span><span class="op">(</span></span>
<span>  <span class="va">adeg</span>,</span>
<span>  dataset_add <span class="op">=</span> <span class="va">adeg</span>,</span>
<span>  by_vars <span class="op">=</span> <span class="fu"><a href="../reference/reexport-exprs.html">exprs</a></span><span class="op">(</span><span class="va">USUBJID</span>, <span class="va">PARAM</span>, <span class="va">AVISIT</span><span class="op">)</span>,</span>
<span>  set_values_to <span class="op">=</span> <span class="fu"><a href="../reference/reexport-exprs.html">exprs</a></span><span class="op">(</span></span>
<span>    AVAL <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">AVAL</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>    ADTM <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">ADTM</span><span class="op">)</span>,</span>
<span>    DTYPE <span class="op">=</span> <span class="st">"AVERAGE"</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html" class="external-link">arrange</a></span><span class="op">(</span><span class="va">USUBJID</span>, <span class="va">AVISIT</span><span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 17 Ã— 7</span></span>
<span><span class="co">#&gt;    USUBJID  PARAM            AVISIT   EGDTC       AVAL ADTM                DTYPE</span></span>
<span><span class="co">#&gt;    &lt;chr&gt;    &lt;chr&gt;            &lt;chr&gt;    &lt;chr&gt;      &lt;dbl&gt; &lt;dttm&gt;              &lt;chr&gt;</span></span>
<span><span class="co">#&gt;  1 XYZ-1001 QTcF Int. (msec) Baseline 2016-02-2â€¦  385  2016-02-24 07:50:00 &lt;NA&gt;</span></span>
<span><span class="co">#&gt;  2 XYZ-1001 QTcF Int. (msec) Baseline 2016-02-2â€¦  399  2016-02-24 07:52:00 &lt;NA&gt;</span></span>
<span><span class="co">#&gt;  3 XYZ-1001 QTcF Int. (msec) Baseline 2016-02-2â€¦  396  2016-02-24 07:56:00 &lt;NA&gt;</span></span>
<span><span class="co">#&gt;  4 XYZ-1001 QTcF Int. (msec) Baseline &lt;NA&gt;        393. 2016-02-24 07:56:00 AVERâ€¦</span></span>
<span><span class="co">#&gt;  5 XYZ-1001 QTcF Int. (msec) Visit 2  2016-03-0â€¦  393  2016-03-08 09:48:00 &lt;NA&gt;</span></span>
<span><span class="co">#&gt;  6 XYZ-1001 QTcF Int. (msec) Visit 2  2016-03-0â€¦  388  2016-03-08 09:51:00 &lt;NA&gt;</span></span>
<span><span class="co">#&gt;  7 XYZ-1001 QTcF Int. (msec) Visit 2  &lt;NA&gt;        390. 2016-03-08 09:51:00 AVERâ€¦</span></span>
<span><span class="co">#&gt;  8 XYZ-1001 QTcF Int. (msec) Visit 3  2016-03-2â€¦  394  2016-03-22 10:48:00 &lt;NA&gt;</span></span>
<span><span class="co">#&gt;  9 XYZ-1001 QTcF Int. (msec) Visit 3  2016-03-2â€¦  402  2016-03-22 10:51:00 &lt;NA&gt;</span></span>
<span><span class="co">#&gt; 10 XYZ-1001 QTcF Int. (msec) Visit 3  &lt;NA&gt;        398  2016-03-22 10:51:00 AVERâ€¦</span></span>
<span><span class="co">#&gt; 11 XYZ-1002 QTcF Int. (msec) Baseline 2016-02-2â€¦  399  2016-02-22 07:58:00 &lt;NA&gt;</span></span>
<span><span class="co">#&gt; 12 XYZ-1002 QTcF Int. (msec) Baseline 2016-02-2â€¦  200  2016-02-22 07:58:00 &lt;NA&gt;</span></span>
<span><span class="co">#&gt; 13 XYZ-1002 QTcF Int. (msec) Baseline 2016-02-2â€¦  392  2016-02-22 08:01:00 &lt;NA&gt;</span></span>
<span><span class="co">#&gt; 14 XYZ-1002 QTcF Int. (msec) Baseline &lt;NA&gt;        330. 2016-02-22 08:01:00 AVERâ€¦</span></span>
<span><span class="co">#&gt; 15 XYZ-1002 QTcF Int. (msec) Visit 3  2016-03-2â€¦  414  2016-03-24 10:53:00 &lt;NA&gt;</span></span>
<span><span class="co">#&gt; 16 XYZ-1002 QTcF Int. (msec) Visit 3  2016-03-2â€¦  402  2016-03-24 10:56:00 &lt;NA&gt;</span></span>
<span><span class="co">#&gt; 17 XYZ-1002 QTcF Int. (msec) Visit 3  &lt;NA&gt;        408  2016-03-24 10:56:00 AVERâ€¦</span></span></code></pre>
<p></p>
</div>
<p>Functions such as <code><a href="https://rdrr.io/r/base/all.html" class="external-link">all()</a></code> and <code><a href="https://rdrr.io/r/base/any.html" class="external-link">any()</a></code> are also often useful when creating
summary records. For instance, the above example can be extended to flag which derived
records were affected by outliers. Note that the outlier flag is created before <code>AVAL</code>
is set for the summary record. Otherwise, referencing <code>AVAL</code> later on would pick up the
<code>AVAL</code> from the summary record rather than the source records.</p>
<p></p>
<div class="sourceCode r">
<pre><code><span><span class="fu"><a href="../reference/derive_summary_records.html">derive_summary_records</a></span><span class="op">(</span></span>
<span>  <span class="va">adeg</span>,</span>
<span>  dataset_add <span class="op">=</span> <span class="va">adeg</span>,</span>
<span>  by_vars <span class="op">=</span> <span class="fu"><a href="../reference/reexport-exprs.html">exprs</a></span><span class="op">(</span><span class="va">USUBJID</span>, <span class="va">PARAM</span>, <span class="va">AVISIT</span><span class="op">)</span>,</span>
<span>  set_values_to <span class="op">=</span> <span class="fu"><a href="../reference/reexport-exprs.html">exprs</a></span><span class="op">(</span></span>
<span>    OUTLIEFL <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/if_else.html" class="external-link">if_else</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/any.html" class="external-link">any</a></span><span class="op">(</span><span class="va">AVAL</span> <span class="op">&gt;=</span> <span class="fl">500</span> <span class="op">|</span> <span class="va">AVAL</span> <span class="op">&lt;=</span> <span class="fl">300</span><span class="op">)</span>, <span class="st">"Y"</span>, <span class="st">"N"</span><span class="op">)</span>,</span>
<span>    AVAL <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">AVAL</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>    ADTM <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">ADTM</span><span class="op">)</span>,</span>
<span>    DTYPE <span class="op">=</span> <span class="st">"AVERAGE"</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html" class="external-link">arrange</a></span><span class="op">(</span><span class="va">USUBJID</span>, <span class="va">AVISIT</span><span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 17 Ã— 8</span></span>
<span><span class="co">#&gt;    USUBJID  PARAM          AVISIT EGDTC  AVAL ADTM                OUTLIEFL DTYPE</span></span>
<span><span class="co">#&gt;    &lt;chr&gt;    &lt;chr&gt;          &lt;chr&gt;  &lt;chr&gt; &lt;dbl&gt; &lt;dttm&gt;              &lt;chr&gt;    &lt;chr&gt;</span></span>
<span><span class="co">#&gt;  1 XYZ-1001 QTcF Int. (msâ€¦ Baselâ€¦ 2016â€¦  385  2016-02-24 07:50:00 &lt;NA&gt;     &lt;NA&gt;</span></span>
<span><span class="co">#&gt;  2 XYZ-1001 QTcF Int. (msâ€¦ Baselâ€¦ 2016â€¦  399  2016-02-24 07:52:00 &lt;NA&gt;     &lt;NA&gt;</span></span>
<span><span class="co">#&gt;  3 XYZ-1001 QTcF Int. (msâ€¦ Baselâ€¦ 2016â€¦  396  2016-02-24 07:56:00 &lt;NA&gt;     &lt;NA&gt;</span></span>
<span><span class="co">#&gt;  4 XYZ-1001 QTcF Int. (msâ€¦ Baselâ€¦ &lt;NA&gt;   393. 2016-02-24 07:56:00 N        AVERâ€¦</span></span>
<span><span class="co">#&gt;  5 XYZ-1001 QTcF Int. (msâ€¦ Visitâ€¦ 2016â€¦  393  2016-03-08 09:48:00 &lt;NA&gt;     &lt;NA&gt;</span></span>
<span><span class="co">#&gt;  6 XYZ-1001 QTcF Int. (msâ€¦ Visitâ€¦ 2016â€¦  388  2016-03-08 09:51:00 &lt;NA&gt;     &lt;NA&gt;</span></span>
<span><span class="co">#&gt;  7 XYZ-1001 QTcF Int. (msâ€¦ Visitâ€¦ &lt;NA&gt;   390. 2016-03-08 09:51:00 N        AVERâ€¦</span></span>
<span><span class="co">#&gt;  8 XYZ-1001 QTcF Int. (msâ€¦ Visitâ€¦ 2016â€¦  394  2016-03-22 10:48:00 &lt;NA&gt;     &lt;NA&gt;</span></span>
<span><span class="co">#&gt;  9 XYZ-1001 QTcF Int. (msâ€¦ Visitâ€¦ 2016â€¦  402  2016-03-22 10:51:00 &lt;NA&gt;     &lt;NA&gt;</span></span>
<span><span class="co">#&gt; 10 XYZ-1001 QTcF Int. (msâ€¦ Visitâ€¦ &lt;NA&gt;   398  2016-03-22 10:51:00 N        AVERâ€¦</span></span>
<span><span class="co">#&gt; 11 XYZ-1002 QTcF Int. (msâ€¦ Baselâ€¦ 2016â€¦  399  2016-02-22 07:58:00 &lt;NA&gt;     &lt;NA&gt;</span></span>
<span><span class="co">#&gt; 12 XYZ-1002 QTcF Int. (msâ€¦ Baselâ€¦ 2016â€¦  200  2016-02-22 07:58:00 &lt;NA&gt;     &lt;NA&gt;</span></span>
<span><span class="co">#&gt; 13 XYZ-1002 QTcF Int. (msâ€¦ Baselâ€¦ 2016â€¦  392  2016-02-22 08:01:00 &lt;NA&gt;     &lt;NA&gt;</span></span>
<span><span class="co">#&gt; 14 XYZ-1002 QTcF Int. (msâ€¦ Baselâ€¦ &lt;NA&gt;   330. 2016-02-22 08:01:00 Y        AVERâ€¦</span></span>
<span><span class="co">#&gt; 15 XYZ-1002 QTcF Int. (msâ€¦ Visitâ€¦ 2016â€¦  414  2016-03-24 10:53:00 &lt;NA&gt;     &lt;NA&gt;</span></span>
<span><span class="co">#&gt; 16 XYZ-1002 QTcF Int. (msâ€¦ Visitâ€¦ 2016â€¦  402  2016-03-24 10:56:00 &lt;NA&gt;     &lt;NA&gt;</span></span>
<span><span class="co">#&gt; 17 XYZ-1002 QTcF Int. (msâ€¦ Visitâ€¦ &lt;NA&gt;   408  2016-03-24 10:56:00 N        AVERâ€¦</span></span></code></pre>
<p></p>
</div>
</div>
<div class="section">
<h3 id="restricting-source-records-filter-add-">Restricting source records (<code>filter_add</code>)<a class="anchor" aria-label="anchor" href="#restricting-source-records-filter-add-"></a>
</h3>


<p>The <code>filter_add</code> argument can be used to restrict the records that are being summarized.
For instance, the mean of the triplicates above can be computed only for the baseline records
by passing <code>filter_add = AVISIT == "Baseline"</code>.</p>
<p></p>
<div class="sourceCode r">
<pre><code><span><span class="fu"><a href="../reference/derive_summary_records.html">derive_summary_records</a></span><span class="op">(</span></span>
<span>  <span class="va">adeg</span>,</span>
<span>  dataset_add <span class="op">=</span> <span class="va">adeg</span>,</span>
<span>  by_vars <span class="op">=</span> <span class="fu"><a href="../reference/reexport-exprs.html">exprs</a></span><span class="op">(</span><span class="va">USUBJID</span>, <span class="va">PARAM</span>, <span class="va">AVISIT</span><span class="op">)</span>,</span>
<span>  filter_add <span class="op">=</span> <span class="va">AVISIT</span> <span class="op">==</span> <span class="st">"Baseline"</span>,</span>
<span>  set_values_to <span class="op">=</span> <span class="fu"><a href="../reference/reexport-exprs.html">exprs</a></span><span class="op">(</span></span>
<span>    AVAL <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">AVAL</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>    DTYPE <span class="op">=</span> <span class="st">"AVERAGE"</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html" class="external-link">arrange</a></span><span class="op">(</span><span class="va">USUBJID</span>, <span class="va">AVISIT</span><span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 14 Ã— 7</span></span>
<span><span class="co">#&gt;    USUBJID  PARAM            AVISIT   EGDTC       AVAL ADTM                DTYPE</span></span>
<span><span class="co">#&gt;    &lt;chr&gt;    &lt;chr&gt;            &lt;chr&gt;    &lt;chr&gt;      &lt;dbl&gt; &lt;dttm&gt;              &lt;chr&gt;</span></span>
<span><span class="co">#&gt;  1 XYZ-1001 QTcF Int. (msec) Baseline 2016-02-2â€¦  385  2016-02-24 07:50:00 &lt;NA&gt;</span></span>
<span><span class="co">#&gt;  2 XYZ-1001 QTcF Int. (msec) Baseline 2016-02-2â€¦  399  2016-02-24 07:52:00 &lt;NA&gt;</span></span>
<span><span class="co">#&gt;  3 XYZ-1001 QTcF Int. (msec) Baseline 2016-02-2â€¦  396  2016-02-24 07:56:00 &lt;NA&gt;</span></span>
<span><span class="co">#&gt;  4 XYZ-1001 QTcF Int. (msec) Baseline &lt;NA&gt;        393. NA                  AVERâ€¦</span></span>
<span><span class="co">#&gt;  5 XYZ-1001 QTcF Int. (msec) Visit 2  2016-03-0â€¦  393  2016-03-08 09:48:00 &lt;NA&gt;</span></span>
<span><span class="co">#&gt;  6 XYZ-1001 QTcF Int. (msec) Visit 2  2016-03-0â€¦  388  2016-03-08 09:51:00 &lt;NA&gt;</span></span>
<span><span class="co">#&gt;  7 XYZ-1001 QTcF Int. (msec) Visit 3  2016-03-2â€¦  394  2016-03-22 10:48:00 &lt;NA&gt;</span></span>
<span><span class="co">#&gt;  8 XYZ-1001 QTcF Int. (msec) Visit 3  2016-03-2â€¦  402  2016-03-22 10:51:00 &lt;NA&gt;</span></span>
<span><span class="co">#&gt;  9 XYZ-1002 QTcF Int. (msec) Baseline 2016-02-2â€¦  399  2016-02-22 07:58:00 &lt;NA&gt;</span></span>
<span><span class="co">#&gt; 10 XYZ-1002 QTcF Int. (msec) Baseline 2016-02-2â€¦  200  2016-02-22 07:58:00 &lt;NA&gt;</span></span>
<span><span class="co">#&gt; 11 XYZ-1002 QTcF Int. (msec) Baseline 2016-02-2â€¦  392  2016-02-22 08:01:00 &lt;NA&gt;</span></span>
<span><span class="co">#&gt; 12 XYZ-1002 QTcF Int. (msec) Baseline &lt;NA&gt;        330. NA                  AVERâ€¦</span></span>
<span><span class="co">#&gt; 13 XYZ-1002 QTcF Int. (msec) Visit 3  2016-03-2â€¦  414  2016-03-24 10:53:00 &lt;NA&gt;</span></span>
<span><span class="co">#&gt; 14 XYZ-1002 QTcF Int. (msec) Visit 3  2016-03-2â€¦  402  2016-03-24 10:56:00 &lt;NA&gt; </span></span></code></pre>
<p></p>
</div>
<p>Summary functions can also be used within <code>filter_add</code> to filter based on conditions
applied to the whole of the by group specified in <code>by_vars</code>. For instance, the mean of
the triplicates can be computed only for by groups  which do indeed contain three records
by passing <code>filter_add = n() &gt; 2</code>.</p>
<p></p>
<div class="sourceCode r">
<pre><code><span><span class="fu"><a href="../reference/derive_summary_records.html">derive_summary_records</a></span><span class="op">(</span></span>
<span>  <span class="va">adeg</span>,</span>
<span>  dataset_add <span class="op">=</span> <span class="va">adeg</span>,</span>
<span>  by_vars <span class="op">=</span> <span class="fu"><a href="../reference/reexport-exprs.html">exprs</a></span><span class="op">(</span><span class="va">USUBJID</span>, <span class="va">PARAM</span>, <span class="va">AVISIT</span><span class="op">)</span>,</span>
<span>  filter_add <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html" class="external-link">n</a></span><span class="op">(</span><span class="op">)</span> <span class="op">&gt;</span> <span class="fl">2</span>,</span>
<span>  set_values_to <span class="op">=</span> <span class="fu"><a href="../reference/reexport-exprs.html">exprs</a></span><span class="op">(</span></span>
<span>    AVAL <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">AVAL</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>    DTYPE <span class="op">=</span> <span class="st">"AVERAGE"</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html" class="external-link">arrange</a></span><span class="op">(</span><span class="va">USUBJID</span>, <span class="va">AVISIT</span><span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 14 Ã— 7</span></span>
<span><span class="co">#&gt;    USUBJID  PARAM            AVISIT   EGDTC       AVAL ADTM                DTYPE</span></span>
<span><span class="co">#&gt;    &lt;chr&gt;    &lt;chr&gt;            &lt;chr&gt;    &lt;chr&gt;      &lt;dbl&gt; &lt;dttm&gt;              &lt;chr&gt;</span></span>
<span><span class="co">#&gt;  1 XYZ-1001 QTcF Int. (msec) Baseline 2016-02-2â€¦  385  2016-02-24 07:50:00 &lt;NA&gt;</span></span>
<span><span class="co">#&gt;  2 XYZ-1001 QTcF Int. (msec) Baseline 2016-02-2â€¦  399  2016-02-24 07:52:00 &lt;NA&gt;</span></span>
<span><span class="co">#&gt;  3 XYZ-1001 QTcF Int. (msec) Baseline 2016-02-2â€¦  396  2016-02-24 07:56:00 &lt;NA&gt;</span></span>
<span><span class="co">#&gt;  4 XYZ-1001 QTcF Int. (msec) Baseline &lt;NA&gt;        393. NA                  AVERâ€¦</span></span>
<span><span class="co">#&gt;  5 XYZ-1001 QTcF Int. (msec) Visit 2  2016-03-0â€¦  393  2016-03-08 09:48:00 &lt;NA&gt;</span></span>
<span><span class="co">#&gt;  6 XYZ-1001 QTcF Int. (msec) Visit 2  2016-03-0â€¦  388  2016-03-08 09:51:00 &lt;NA&gt;</span></span>
<span><span class="co">#&gt;  7 XYZ-1001 QTcF Int. (msec) Visit 3  2016-03-2â€¦  394  2016-03-22 10:48:00 &lt;NA&gt;</span></span>
<span><span class="co">#&gt;  8 XYZ-1001 QTcF Int. (msec) Visit 3  2016-03-2â€¦  402  2016-03-22 10:51:00 &lt;NA&gt;</span></span>
<span><span class="co">#&gt;  9 XYZ-1002 QTcF Int. (msec) Baseline 2016-02-2â€¦  399  2016-02-22 07:58:00 &lt;NA&gt;</span></span>
<span><span class="co">#&gt; 10 XYZ-1002 QTcF Int. (msec) Baseline 2016-02-2â€¦  200  2016-02-22 07:58:00 &lt;NA&gt;</span></span>
<span><span class="co">#&gt; 11 XYZ-1002 QTcF Int. (msec) Baseline 2016-02-2â€¦  392  2016-02-22 08:01:00 &lt;NA&gt;</span></span>
<span><span class="co">#&gt; 12 XYZ-1002 QTcF Int. (msec) Baseline &lt;NA&gt;        330. NA                  AVERâ€¦</span></span>
<span><span class="co">#&gt; 13 XYZ-1002 QTcF Int. (msec) Visit 3  2016-03-2â€¦  414  2016-03-24 10:53:00 &lt;NA&gt;</span></span>
<span><span class="co">#&gt; 14 XYZ-1002 QTcF Int. (msec) Visit 3  2016-03-2â€¦  402  2016-03-24 10:56:00 &lt;NA&gt; </span></span></code></pre>
<p></p>
</div>
</div>
<div class="section">
<h3 id="adding-records-for-groups-not-in-source-dataset-ref-and-missing-values-">Adding records for groups not in source (<code>dataset_ref</code> and <code>missing_values</code>)<a class="anchor" aria-label="anchor" href="#adding-records-for-groups-not-in-source-dataset-ref-and-missing-values-"></a>
</h3>


<p>Adding records for groups which are not in the source data can be achieved by
specifying a reference dataset in the <code>dataset_ref</code> argument. For example, specifying
the input dataset <code>adeg_allparamvis</code> (containing an extra <code>"Visit 2"</code> for patient
<code>1002</code>) ensures a summary record is derived for that visit as well. For these records,
the values of the analysis variables to be populated should be specified within the
<code>missing_values</code> argument. Here, <code>DTYPE = "PHANTOM"</code> was chosen as <code>AVAL</code> is set to
missing.</p>
<p></p>
<div class="sourceCode r">
<pre><code><span><span class="va">adeg_allparamvis</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tribble.html" class="external-link">tribble</a></span><span class="op">(</span></span>
<span>  <span class="op">~</span><span class="va">USUBJID</span>,   <span class="op">~</span><span class="va">PARAM</span>,             <span class="op">~</span><span class="va">AVISIT</span>,</span>
<span>  <span class="st">"XYZ-1001"</span>, <span class="st">"QTcF Int. (msec)"</span>, <span class="st">"Baseline"</span>,</span>
<span>  <span class="st">"XYZ-1001"</span>, <span class="st">"QTcF Int. (msec)"</span>, <span class="st">"Visit 2"</span>,</span>
<span>  <span class="st">"XYZ-1001"</span>, <span class="st">"QTcF Int. (msec)"</span>, <span class="st">"Visit 3"</span>,</span>
<span>  <span class="st">"XYZ-1002"</span>, <span class="st">"QTcF Int. (msec)"</span>, <span class="st">"Baseline"</span>,</span>
<span>  <span class="st">"XYZ-1002"</span>, <span class="st">"QTcF Int. (msec)"</span>, <span class="st">"Visit 2"</span>,</span>
<span>  <span class="st">"XYZ-1002"</span>, <span class="st">"QTcF Int. (msec)"</span>, <span class="st">"Visit 3"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/derive_summary_records.html">derive_summary_records</a></span><span class="op">(</span></span>
<span>  <span class="va">adeg</span>,</span>
<span>  dataset_add <span class="op">=</span> <span class="va">adeg</span>,</span>
<span>  dataset_ref <span class="op">=</span> <span class="va">adeg_allparamvis</span>,</span>
<span>  by_vars <span class="op">=</span> <span class="fu"><a href="../reference/reexport-exprs.html">exprs</a></span><span class="op">(</span><span class="va">USUBJID</span>, <span class="va">PARAM</span>, <span class="va">AVISIT</span><span class="op">)</span>,</span>
<span>  set_values_to <span class="op">=</span> <span class="fu"><a href="../reference/reexport-exprs.html">exprs</a></span><span class="op">(</span></span>
<span>    AVAL <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">AVAL</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>    ADTM <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">ADTM</span><span class="op">)</span>,</span>
<span>    DTYPE <span class="op">=</span> <span class="st">"AVERAGE"</span></span>
<span>  <span class="op">)</span>,</span>
<span>  missing_values <span class="op">=</span> <span class="fu"><a href="../reference/reexport-exprs.html">exprs</a></span><span class="op">(</span></span>
<span>    AVAL <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>    ADTM <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>    DTYPE <span class="op">=</span> <span class="st">"PHANTOM"</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html" class="external-link">arrange</a></span><span class="op">(</span><span class="va">USUBJID</span>, <span class="va">AVISIT</span><span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 18 Ã— 7</span></span>
<span><span class="co">#&gt;    USUBJID  PARAM            AVISIT   EGDTC       AVAL ADTM                DTYPE</span></span>
<span><span class="co">#&gt;    &lt;chr&gt;    &lt;chr&gt;            &lt;chr&gt;    &lt;chr&gt;      &lt;dbl&gt; &lt;dttm&gt;              &lt;chr&gt;</span></span>
<span><span class="co">#&gt;  1 XYZ-1001 QTcF Int. (msec) Baseline 2016-02-2â€¦  385  2016-02-24 07:50:00 &lt;NA&gt;</span></span>
<span><span class="co">#&gt;  2 XYZ-1001 QTcF Int. (msec) Baseline 2016-02-2â€¦  399  2016-02-24 07:52:00 &lt;NA&gt;</span></span>
<span><span class="co">#&gt;  3 XYZ-1001 QTcF Int. (msec) Baseline 2016-02-2â€¦  396  2016-02-24 07:56:00 &lt;NA&gt;</span></span>
<span><span class="co">#&gt;  4 XYZ-1001 QTcF Int. (msec) Baseline &lt;NA&gt;        393. 2016-02-24 07:56:00 AVERâ€¦</span></span>
<span><span class="co">#&gt;  5 XYZ-1001 QTcF Int. (msec) Visit 2  2016-03-0â€¦  393  2016-03-08 09:48:00 &lt;NA&gt;</span></span>
<span><span class="co">#&gt;  6 XYZ-1001 QTcF Int. (msec) Visit 2  2016-03-0â€¦  388  2016-03-08 09:51:00 &lt;NA&gt;</span></span>
<span><span class="co">#&gt;  7 XYZ-1001 QTcF Int. (msec) Visit 2  &lt;NA&gt;        390. 2016-03-08 09:51:00 AVERâ€¦</span></span>
<span><span class="co">#&gt;  8 XYZ-1001 QTcF Int. (msec) Visit 3  2016-03-2â€¦  394  2016-03-22 10:48:00 &lt;NA&gt;</span></span>
<span><span class="co">#&gt;  9 XYZ-1001 QTcF Int. (msec) Visit 3  2016-03-2â€¦  402  2016-03-22 10:51:00 &lt;NA&gt;</span></span>
<span><span class="co">#&gt; 10 XYZ-1001 QTcF Int. (msec) Visit 3  &lt;NA&gt;        398  2016-03-22 10:51:00 AVERâ€¦</span></span>
<span><span class="co">#&gt; 11 XYZ-1002 QTcF Int. (msec) Baseline 2016-02-2â€¦  399  2016-02-22 07:58:00 &lt;NA&gt;</span></span>
<span><span class="co">#&gt; 12 XYZ-1002 QTcF Int. (msec) Baseline 2016-02-2â€¦  200  2016-02-22 07:58:00 &lt;NA&gt;</span></span>
<span><span class="co">#&gt; 13 XYZ-1002 QTcF Int. (msec) Baseline 2016-02-2â€¦  392  2016-02-22 08:01:00 &lt;NA&gt;</span></span>
<span><span class="co">#&gt; 14 XYZ-1002 QTcF Int. (msec) Baseline &lt;NA&gt;        330. 2016-02-22 08:01:00 AVERâ€¦</span></span>
<span><span class="co">#&gt; 15 XYZ-1002 QTcF Int. (msec) Visit 2  &lt;NA&gt;         NA  NA                  PHANâ€¦</span></span>
<span><span class="co">#&gt; 16 XYZ-1002 QTcF Int. (msec) Visit 3  2016-03-2â€¦  414  2016-03-24 10:53:00 &lt;NA&gt;</span></span>
<span><span class="co">#&gt; 17 XYZ-1002 QTcF Int. (msec) Visit 3  2016-03-2â€¦  402  2016-03-24 10:56:00 &lt;NA&gt;</span></span>
<span><span class="co">#&gt; 18 XYZ-1002 QTcF Int. (msec) Visit 3  &lt;NA&gt;        408  2016-03-24 10:56:00 AVERâ€¦</span></span></code></pre>
<p></p>
</div>
</div>
    </div>

  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by F. Hoffmann-La Roche AG, GlaxoSmithKline LLC, Ben Straub, Stefan Bundfuss, Arianna Cascone, Jeffrey Dickinson, Ross Farrugia, Fanny Gautier, G Gayatri, Solveig Holmgaard, Dinakar Kulkarni, Edoardo Mancini, Gordon Miller, Jim Rothstein, Daniel Sjoberg, Stefan Thoma, Junze Zhang.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
