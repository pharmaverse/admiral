<!DOCTYPE html>
<!-- Generated by pkgdown + https://github.com/insightsengineering/r-pkgdown-multiversion -->
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Derive a Time-to-Event Parameter â€” derive_param_tte â€¢ admiral</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><script src="../deps/MathJax-3.2.2/tex-chtml.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Derive a Time-to-Event Parameter â€” derive_param_tte">
<meta name="description" content="Add a time-to-event parameter to the input dataset.">
<meta property="og:description" content="Add a time-to-event parameter to the input dataset.">
<meta property="og:image" content="https:/pharmaverse.github.io/admiral/main/logo.png">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">admiral</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.3.1.9004</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-get-started" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Get Started</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-get-started">
<li><a class="dropdown-item" href="../articles/admiral.html">Get Started</a></li>
    <li><a class="external-link dropdown-item" href="https://github.com/pharmaverse/admiral/blob/main/inst/cheatsheet/admiral_cheatsheet.pdf">Cheatsheet</a></li>
    <li><a class="external-link dropdown-item" href="https://pharmaverse.github.io/admiraldiscovery/articles/presentation_archive.html">Presentation Archive</a></li>
  </ul>
</li>
<li class="active nav-item"><a class="nav-link" href="../reference/">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-user-guides" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">User Guides</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-user-guides">
<li><h6 class="dropdown-header" data-toc-skip>General Guides</h6></li>
    <li><a class="dropdown-item" href="../articles/concepts_conventions.html">Programming Concepts and Conventions</a></li>
    <li><a class="dropdown-item" href="../articles/generic.html">Generic Derivations</a></li>
    <li><a class="dropdown-item" href="../articles/higher_order.html">Higher Order Functions</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>ADaM Script Guides</h6></li>
    <li><a class="dropdown-item" href="../articles/adsl.html">Creating a Basic ADSL</a></li>
    <li><a class="dropdown-item" href="../articles/occds.html">Creating an OCCDS ADaM</a></li>
    <li><a class="dropdown-item" href="../articles/bds_finding.html">Creating a BDS Findings ADAM</a></li>
    <li><a class="dropdown-item" href="../articles/bds_exposure.html">Creating a BDS Exposure ADaM</a></li>
    <li><a class="dropdown-item" href="../articles/bds_tte.html">Creating a BDS Time-to-Event ADaM</a></li>
    <li><a class="dropdown-item" href="../articles/questionnaires.html">Creating Questionnaire ADaMs</a></li>
    <li><a class="dropdown-item" href="../articles/pk_adnca.html">Creating a PK NCA or Population PK ADaM</a></li>
    <li><a class="dropdown-item" href="../articles/hys_law.html">Hy's Law Implementation</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Special Topics Guides</h6></li>
    <li><a class="dropdown-item" href="../articles/imputation.html">Date and Time Imputation</a></li>
    <li><a class="dropdown-item" href="../articles/visits_periods.html">Visit and Period Variables</a></li>
    <li><a class="dropdown-item" href="../articles/queries_dataset.html">Queries Dataset Documentation</a></li>
    <li><a class="dropdown-item" href="../articles/lab_grading.html">Lab Grading</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><a class="dropdown-item" href="../articles/faq.html">FAQ</a></li>
  </ul>
</li>
<li class="nav-item"><a class="external-link nav-link" href="https://pharmaverse.github.io/admiraldiscovery/articles/reactable.html">ðŸ”Ž Find my function</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      <div><li class="nav-item dropdown">
    <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-versions">Versions</a>
    <div class="dropdown-menu" aria-labelledby="dropdown-versions">
    <a class="dropdown-item" data-toggle="tooltip" title="" href="https://pharmaverse.github.io/admiral/main">main</a>
<a class="dropdown-item" data-toggle="tooltip" title="" href="https://pharmaverse.github.io/admiral/cran-release">cran-release</a>
<a class="dropdown-item" data-toggle="tooltip" title="" href="https://pharmaverse.github.io/admiral/v1.3.1">v1.3.1</a>
<a class="dropdown-item" data-toggle="tooltip" title="" href="https://pharmaverse.github.io/admiral/v1.3.0">v1.3.0</a>
<a class="dropdown-item" data-toggle="tooltip" title="" href="https://pharmaverse.github.io/admiral/v1.2.0">v1.2.0</a>
<a class="dropdown-item" data-toggle="tooltip" title="" href="https://pharmaverse.github.io/admiral/v1.1.1">v1.1.1</a>
<a class="dropdown-item" data-toggle="tooltip" title="" href="https://pharmaverse.github.io/admiral/v1.1.0">v1.1.0</a>
<a class="dropdown-item" data-toggle="tooltip" title="" href="https://pharmaverse.github.io/admiral/v1.0.2">v1.0.2</a>
<a class="dropdown-item" data-toggle="tooltip" title="" href="https://pharmaverse.github.io/admiral/v1.0.1">v1.0.1</a>
<a class="dropdown-item" data-toggle="tooltip" title="" href="https://pharmaverse.github.io/admiral/v1.0.0">v1.0.0</a>
</div>
</li></div>
</ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://pharmaverse.slack.com/" aria-label="Slack"><span class="fa fa-slack"></span></a></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/pharmaverse/admiral/issues/new/choose" aria-label="New Issue"><span class="fa fa-bug"></span></a></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/pharmaverse/admiral/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Derive a Time-to-Event Parameter</h1>
      <small class="dont-index">Source: <a href="https://github.com/pharmaverse/admiral/blob/main/R/derive_param_tte.R" class="external-link"><code>R/derive_param_tte.R</code></a></small>
      <div class="d-none name"><code>derive_param_tte.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Add a time-to-event parameter to the input dataset.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a>
</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">derive_param_tte</span><span class="op">(</span></span>
<span>  dataset <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">dataset_adsl</span>,</span>
<span>  <span class="va">source_datasets</span>,</span>
<span>  by_vars <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  start_date <span class="op">=</span> <span class="va">TRTSDT</span>,</span>
<span>  <span class="va">event_conditions</span>,</span>
<span>  <span class="va">censor_conditions</span>,</span>
<span>  create_datetime <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  <span class="va">set_values_to</span>,</span>
<span>  subject_keys <span class="op">=</span> <span class="fu"><a href="get_admiral_option.html">get_admiral_option</a></span><span class="op">(</span><span class="st">"subject_keys"</span><span class="op">)</span>,</span>
<span>  check_type <span class="op">=</span> <span class="st">"warning"</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a>
</h2>


<dl>
<dt id="arg-dataset">dataset<a class="anchor" aria-label="anchor" href="#arg-dataset"></a>
</dt>
<dd>
<p>Input dataset</p>
<p><code>PARAMCD</code> is expected.</p>
<dl>
<dt>Permitted values</dt>
<dd><p>a dataset, i.e., a <code>data.frame</code> or tibble</p></dd>

<dt>Default value</dt>
<dd><p><code>NULL</code></p></dd>


</dl>
</dd>


<dt id="arg-dataset-adsl">dataset_adsl<a class="anchor" aria-label="anchor" href="#arg-dataset-adsl"></a>
</dt>
<dd>
<p>ADSL input dataset</p>
<p>The variables specified for <code>start_date</code>, and
<code>subject_keys</code> are expected.</p>
<dl>
<dt>Permitted values</dt>
<dd><p>a dataset, i.e., a <code>data.frame</code> or tibble</p></dd>

<dt>Default value</dt>
<dd><p>none</p></dd>


</dl>
</dd>


<dt id="arg-source-datasets">source_datasets<a class="anchor" aria-label="anchor" href="#arg-source-datasets"></a>
</dt>
<dd>
<p>Source datasets</p>
<p>A named list of datasets is expected. The <code>dataset_name</code> field of
<code><a href="tte_source.html">tte_source()</a></code> refers to the dataset provided in the list.</p>
<dl>
<dt>Permitted values</dt>
<dd><p>named list of datasets, e.g., <code>list(adsl = adsl, ae = ae)</code></p></dd>

<dt>Default value</dt>
<dd><p>none</p></dd>


</dl>
</dd>


<dt id="arg-by-vars">by_vars<a class="anchor" aria-label="anchor" href="#arg-by-vars"></a>
</dt>
<dd>
<p>By variables</p>
<p>If the parameter is specified, separate time to event parameters are
derived for each by group.</p>
<p>The by variables must be in at least one of the source datasets. Each
source dataset must contain either all by variables or none of the by
variables.</p>
<p>The by variables are not included in the output dataset.</p>
<dl>
<dt>Permitted values</dt>
<dd><p>list of variables created by <code><a href="reexport-exprs.html">exprs()</a></code>, e.g., <code>exprs(USUBJID, VISIT)</code></p></dd>

<dt>Default value</dt>
<dd><p><code>NULL</code></p></dd>


</dl>
</dd>


<dt id="arg-start-date">start_date<a class="anchor" aria-label="anchor" href="#arg-start-date"></a>
</dt>
<dd>
<p>Time to event origin date</p>
<p>The variable <code>STARTDT</code> is set to the specified date. The value is taken
from the ADSL dataset.</p>
<p>If the event or censoring date is before the origin date, <code>ADT</code> is set to
the origin date.</p>
<dl>
<dt>Permitted values</dt>
<dd><p>a date or datetime variable</p></dd>

<dt>Default value</dt>
<dd><p><code>TRTSDT</code></p></dd>


</dl>
</dd>


<dt id="arg-event-conditions">event_conditions<a class="anchor" aria-label="anchor" href="#arg-event-conditions"></a>
</dt>
<dd>
<p>Sources and conditions defining events</p>
<p>A list of <code><a href="event_source.html">event_source()</a></code> objects is expected.</p>
<dl>
<dt>Permitted values</dt>
<dd><p>a list of source objects, e.g., <code>list(pd, death)</code></p></dd>

<dt>Default value</dt>
<dd><p>none</p></dd>


</dl>
</dd>


<dt id="arg-censor-conditions">censor_conditions<a class="anchor" aria-label="anchor" href="#arg-censor-conditions"></a>
</dt>
<dd>
<p>Sources and conditions defining censorings</p>
<p>A list of <code><a href="censor_source.html">censor_source()</a></code> objects is expected.</p>
<dl>
<dt>Permitted values</dt>
<dd><p>a list of source objects, e.g., <code>list(pd, death)</code></p></dd>

<dt>Default value</dt>
<dd><p>none</p></dd>


</dl>
</dd>


<dt id="arg-create-datetime">create_datetime<a class="anchor" aria-label="anchor" href="#arg-create-datetime"></a>
</dt>
<dd>
<p>Create datetime variables?</p>
<p>If set to <code>TRUE</code>, variables <code>ADTM</code> and <code>STARTDTM</code> are created. Otherwise,
variables <code>ADT</code> and <code>STARTDT</code> are created.</p>
<dl>
<dt>Permitted values</dt>
<dd><p><code>"TRUE"</code>, <code>"FALSE"</code></p></dd>

<dt>Default value</dt>
<dd><p><code>FALSE</code></p></dd>


</dl>
</dd>


<dt id="arg-set-values-to">set_values_to<a class="anchor" aria-label="anchor" href="#arg-set-values-to"></a>
</dt>
<dd>
<p>Variables to set</p>
<p>A named list returned by <code><a href="reexport-exprs.html">exprs()</a></code> defining the variables to be set for the
new parameter, e.g. <code>exprs(PARAMCD = "OS", PARAM = "Overall Survival")</code> is
expected. The values must be symbols, character strings, numeric values,
expressions, or <code>NA</code>.</p>
<dl>
<dt>Permitted values</dt>
<dd><p>list of named expressions created by a formula using <code><a href="reexport-exprs.html">exprs()</a></code>, e.g., <code>exprs(AVALC = VSSTRESC, AVAL = yn_to_numeric(AVALC))</code></p></dd>

<dt>Default value</dt>
<dd><p>none</p></dd>


</dl>
</dd>


<dt id="arg-subject-keys">subject_keys<a class="anchor" aria-label="anchor" href="#arg-subject-keys"></a>
</dt>
<dd>
<p>Variables to uniquely identify a subject</p>
<p>A list of symbols created using <code><a href="reexport-exprs.html">exprs()</a></code> is expected.</p>
<dl>
<dt>Permitted values</dt>
<dd><p>list of variables created by <code><a href="reexport-exprs.html">exprs()</a></code>, e.g., <code>exprs(USUBJID, VISIT)</code></p></dd>

<dt>Default value</dt>
<dd><p><code>get_admiral_option("subject_keys")</code></p></dd>


</dl>
</dd>


<dt id="arg-check-type">check_type<a class="anchor" aria-label="anchor" href="#arg-check-type"></a>
</dt>
<dd>
<p>Check uniqueness</p>
<p>If <code>"warning"</code>, <code>"message"</code>, or <code>"error"</code> is specified, the specified message is issued
if the observations of the source datasets are not unique with respect to the
by variables and the date and order specified in the <code><a href="event_source.html">event_source()</a></code> and
<code><a href="censor_source.html">censor_source()</a></code> objects.</p>
<dl>
<dt>Permitted values</dt>
<dd><p><code>"none"</code>, <code>"message"</code>, <code>"warning"</code>, <code>"error"</code></p></dd>

<dt>Default value</dt>
<dd><p><code>"warning"</code></p></dd>


</dl>
</dd>

</dl>
</div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a>
</h2>
    <p>The input dataset with the new parameter added</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a>
</h2>
    <p>The following steps are performed to create the observations of the
new parameter:</p>
<p><strong>Deriving the events:</strong></p>
<ol>
<li><p>For each event source dataset the observations as
specified by the <code>filter</code> element are selected. Then for each subject the
first observation (with respect to <code>date</code> and <code>order</code>) is selected.</p></li>
<li><p>The <code>ADT</code> variable is set to the variable specified by the
<code>date</code> element. If the date variable is a datetime variable, only
the datepart is copied.</p></li>
<li><p>The <code>CNSR</code> variable is added and set to the <code>censor</code> element.</p></li>
<li><p>The variables specified by the <code>set_values_to</code> element are
added.</p></li>
<li><p>The selected observations of all event source datasets are combined into a
single dataset.</p></li>
<li><p>For each subject the first observation (with respect to the
<code>ADT</code>/<code>ADTM</code> variable) from the single dataset is selected. If there is
more than one event with the same date, the first event with respect to the
order of events in <code>event_conditions</code> is selected.</p></li>
</ol>
<p><strong>Deriving the censoring observations:</strong></p>
<ol>
<li><p>For each censoring source dataset the observations as
specified by the <code>filter</code> element are selected. Then for each subject the
last observation (with respect to <code>date</code> and <code>order</code>) is selected.</p></li>
<li><p>The <code>ADT</code> variable is set to the variable specified by the
<code>date</code> element. If the date variable is a datetime variable, only
the datepart is copied.</p></li>
<li><p>The <code>CNSR</code> variable is added and set to the <code>censor</code> element.</p></li>
<li><p>The variables specified by the <code>set_values_to</code> element are
added.</p></li>
<li><p>The selected observations of all censoring source datasets are
combined into a single dataset.</p></li>
<li><p>For each subject the last observation (with respect to the
<code>ADT</code>/<code>ADTM</code> variable) from the single dataset is selected.  If there is
more than one censoring with the same date, the last censoring with respect
to the order of censorings in <code>censor_conditions</code> is selected.</p></li>
</ol>
<p>For each subject (as defined by the <code>subject_keys</code> parameter) an
observation is selected. If an event is available, the event observation is
selected. Otherwise the censoring observation is selected.</p>
<p>Finally:</p>
<ol>
<li><p>The variable specified for <code>start_date</code> is joined from the
ADSL dataset. Only subjects in both datasets are kept,
i.e., subjects with both an event or censoring and an observation in
<code>dataset_adsl</code>.</p></li>
<li><p>The variables as defined by the <code>set_values_to</code> parameter are added.</p></li>
<li><p>The <code>ADT</code>/<code>ADTM</code> variable is set to the maximum of <code>ADT</code>/<code>ADTM</code> and
<code>STARTDT</code>/<code>STARTDTM</code> (depending on the <code>create_datetime</code> parameter).</p></li>
<li><p>The new observations are added to the output dataset.</p></li>
</ol>
</div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a>
</h2>
    <div class="dont-index"><p><code><a href="event_source.html">event_source()</a></code>, <code><a href="censor_source.html">censor_source()</a></code></p></div>
    </div>
    <div class="section level2">
    <h2 id="examples">Examples<a class="anchor" aria-label="anchor" href="#examples"></a>
</h2>

<div class="section">
<h3 id="add-a-basic-time-to-event-parameter">Add a basic time to event parameter<a class="anchor" aria-label="anchor" href="#add-a-basic-time-to-event-parameter"></a>
</h3>


<p>For each subject the time to first adverse event should be created as a parameter.</p>
<ul>
<li><p>The event source object is created using <code><a href="event_source.html">event_source()</a></code> and the date is
set to adverse event start date.</p></li>
<li><p>The censor source object is created using <code><a href="censor_source.html">censor_source()</a></code> and the date is
set to end of study date.</p></li>
<li><p>The event and censor source objects are then passed to <code>derive_param_tte()</code>
to derive the time to event parameter with the provided parameter
descriptions (<code>PARAMCD</code> and <code>PARAM</code>).</p></li>
<li><p>Note the values of the censor variable (<code>CNSR</code>) that are derived below,
where the first subject has an event and the second does not.</p></li>
</ul>
<p></p>
<div class="sourceCode r">
<pre><code><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tibble.tidyverse.org/" class="external-link">tibble</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span>, warn.conflicts <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://lubridate.tidyverse.org" class="external-link">lubridate</a></span>, warn.conflicts <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="va">adsl</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tribble.html" class="external-link">tribble</a></span><span class="op">(</span></span>
<span>  <span class="op">~</span><span class="va">USUBJID</span>, <span class="op">~</span><span class="va">TRTSDT</span>,           <span class="op">~</span><span class="va">EOSDT</span>,            <span class="op">~</span><span class="va">NEWDRGDT</span>,</span>
<span>  <span class="st">"01"</span>,     <span class="fu"><a href="https://lubridate.tidyverse.org/reference/ymd.html" class="external-link">ymd</a></span><span class="op">(</span><span class="st">"2020-12-06"</span><span class="op">)</span>, <span class="fu"><a href="https://lubridate.tidyverse.org/reference/ymd.html" class="external-link">ymd</a></span><span class="op">(</span><span class="st">"2021-03-06"</span><span class="op">)</span>, <span class="cn">NA</span>,</span>
<span>  <span class="st">"02"</span>,     <span class="fu"><a href="https://lubridate.tidyverse.org/reference/ymd.html" class="external-link">ymd</a></span><span class="op">(</span><span class="st">"2021-01-16"</span><span class="op">)</span>, <span class="fu"><a href="https://lubridate.tidyverse.org/reference/ymd.html" class="external-link">ymd</a></span><span class="op">(</span><span class="st">"2021-02-03"</span><span class="op">)</span>, <span class="fu"><a href="https://lubridate.tidyverse.org/reference/ymd.html" class="external-link">ymd</a></span><span class="op">(</span><span class="st">"2021-01-03"</span><span class="op">)</span></span>
<span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>STUDYID <span class="op">=</span> <span class="st">"AB42"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">adae</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tribble.html" class="external-link">tribble</a></span><span class="op">(</span></span>
<span>  <span class="op">~</span><span class="va">USUBJID</span>, <span class="op">~</span><span class="va">ASTDT</span>,            <span class="op">~</span><span class="va">AESEQ</span>, <span class="op">~</span><span class="va">AEDECOD</span>,</span>
<span>  <span class="st">"01"</span>,     <span class="fu"><a href="https://lubridate.tidyverse.org/reference/ymd.html" class="external-link">ymd</a></span><span class="op">(</span><span class="st">"2021-01-03"</span><span class="op">)</span>,      <span class="fl">1</span>, <span class="st">"Flu"</span>,</span>
<span>  <span class="st">"01"</span>,     <span class="fu"><a href="https://lubridate.tidyverse.org/reference/ymd.html" class="external-link">ymd</a></span><span class="op">(</span><span class="st">"2021-03-04"</span><span class="op">)</span>,      <span class="fl">2</span>, <span class="st">"Cough"</span>,</span>
<span>  <span class="st">"01"</span>,     <span class="fu"><a href="https://lubridate.tidyverse.org/reference/ymd.html" class="external-link">ymd</a></span><span class="op">(</span><span class="st">"2021-03-05"</span><span class="op">)</span>,      <span class="fl">3</span>, <span class="st">"Cough"</span></span>
<span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>STUDYID <span class="op">=</span> <span class="st">"AB42"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">ttae</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/event_source.html">event_source</a></span><span class="op">(</span></span>
<span>  dataset_name <span class="op">=</span> <span class="st">"adae"</span>,</span>
<span>  date <span class="op">=</span> <span class="va">ASTDT</span>,</span>
<span>  set_values_to <span class="op">=</span> <span class="fu"><a href="../reference/reexport-exprs.html">exprs</a></span><span class="op">(</span></span>
<span>    EVNTDESC <span class="op">=</span> <span class="st">"AE"</span>,</span>
<span>    SRCDOM <span class="op">=</span> <span class="st">"ADAE"</span>,</span>
<span>    SRCVAR <span class="op">=</span> <span class="st">"ASTDT"</span>,</span>
<span>    SRCSEQ <span class="op">=</span> <span class="va">AESEQ</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">eos</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/censor_source.html">censor_source</a></span><span class="op">(</span></span>
<span>  dataset_name <span class="op">=</span> <span class="st">"adsl"</span>,</span>
<span>  date <span class="op">=</span> <span class="va">EOSDT</span>,</span>
<span>  set_values_to <span class="op">=</span> <span class="fu"><a href="../reference/reexport-exprs.html">exprs</a></span><span class="op">(</span></span>
<span>    EVNTDESC <span class="op">=</span> <span class="st">"END OF STUDY"</span>,</span>
<span>    SRCDOM <span class="op">=</span> <span class="st">"ADSL"</span>,</span>
<span>    SRCVAR <span class="op">=</span> <span class="st">"EOSDT"</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/derive_param_tte.html">derive_param_tte</a></span><span class="op">(</span></span>
<span>  dataset_adsl <span class="op">=</span> <span class="va">adsl</span>,</span>
<span>  event_conditions <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">ttae</span><span class="op">)</span>,</span>
<span>  censor_conditions <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">eos</span><span class="op">)</span>,</span>
<span>  source_datasets <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>adsl <span class="op">=</span> <span class="va">adsl</span>, adae <span class="op">=</span> <span class="va">adae</span><span class="op">)</span>,</span>
<span>  set_values_to <span class="op">=</span> <span class="fu"><a href="../reference/reexport-exprs.html">exprs</a></span><span class="op">(</span></span>
<span>    PARAMCD <span class="op">=</span> <span class="st">"TTAE"</span>,</span>
<span>    PARAM <span class="op">=</span> <span class="st">"Time to First Adverse Event"</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">USUBJID</span>, <span class="va">STARTDT</span>, <span class="va">PARAMCD</span>, <span class="va">PARAM</span>, <span class="va">ADT</span>, <span class="va">CNSR</span>, <span class="va">SRCSEQ</span><span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 2 Ã— 7</span></span>
<span><span class="co">#&gt;   USUBJID STARTDT    PARAMCD PARAM                       ADT         CNSR SRCSEQ</span></span>
<span><span class="co">#&gt;   &lt;chr&gt;   &lt;date&gt;     &lt;chr&gt;   &lt;chr&gt;                       &lt;date&gt;     &lt;int&gt;  &lt;dbl&gt;</span></span>
<span><span class="co">#&gt; 1 01      2020-12-06 TTAE    Time to First Adverse Event 2021-01-03     0      1</span></span>
<span><span class="co">#&gt; 2 02      2021-01-16 TTAE    Time to First Adverse Event 2021-02-03     1     NA</span></span></code></pre>
<p></p>
</div>
</div>
<div class="section">
<h3 id="adding-a-by-variable-by-vars-">Adding a by variable (<code>by_vars</code>)<a class="anchor" aria-label="anchor" href="#adding-a-by-variable-by-vars-"></a>
</h3>


<p>By variables can be added using the <code>by_vars</code> argument, e.g., now for
each subject the time to first occurrence of each adverse event preferred
term (<code>AEDECOD</code>) should be created as parameters.</p>
<p></p>
<div class="sourceCode r">
<pre><code><span><span class="fu"><a href="../reference/derive_param_tte.html">derive_param_tte</a></span><span class="op">(</span></span>
<span>  dataset_adsl <span class="op">=</span> <span class="va">adsl</span>,</span>
<span>  by_vars <span class="op">=</span> <span class="fu"><a href="../reference/reexport-exprs.html">exprs</a></span><span class="op">(</span><span class="va">AEDECOD</span><span class="op">)</span>,</span>
<span>  event_conditions <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">ttae</span><span class="op">)</span>,</span>
<span>  censor_conditions <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">eos</span><span class="op">)</span>,</span>
<span>  source_datasets <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>adsl <span class="op">=</span> <span class="va">adsl</span>, adae <span class="op">=</span> <span class="va">adae</span><span class="op">)</span>,</span>
<span>  set_values_to <span class="op">=</span> <span class="fu"><a href="../reference/reexport-exprs.html">exprs</a></span><span class="op">(</span></span>
<span>    PARAMCD <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"TTAE"</span>, <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="va">AEDECOD</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    PARAM <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"Time to First"</span>, <span class="va">AEDECOD</span>, <span class="st">"Adverse Event"</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">USUBJID</span>, <span class="va">STARTDT</span>, <span class="va">PARAMCD</span>, <span class="va">PARAM</span>, <span class="va">ADT</span>, <span class="va">CNSR</span>, <span class="va">SRCSEQ</span><span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 4 Ã— 7</span></span>
<span><span class="co">#&gt;   USUBJID STARTDT    PARAMCD PARAM                       ADT         CNSR SRCSEQ</span></span>
<span><span class="co">#&gt;   &lt;chr&gt;   &lt;date&gt;     &lt;chr&gt;   &lt;chr&gt;                       &lt;date&gt;     &lt;int&gt;  &lt;dbl&gt;</span></span>
<span><span class="co">#&gt; 1 01      2020-12-06 TTAE1   Time to First Cough Adversâ€¦ 2021-03-04     0      2</span></span>
<span><span class="co">#&gt; 2 01      2020-12-06 TTAE2   Time to First Flu Adverse â€¦ 2021-01-03     0      1</span></span>
<span><span class="co">#&gt; 3 02      2021-01-16 TTAE1   Time to First Cough Adversâ€¦ 2021-02-03     1     NA</span></span>
<span><span class="co">#&gt; 4 02      2021-01-16 TTAE2   Time to First Flu Adverse â€¦ 2021-02-03     1     NA</span></span></code></pre>
<p></p>
</div>
</div>
<div class="section">
<h3 id="handling-duplicates-check-type-">Handling duplicates (<code>check_type</code>)<a class="anchor" aria-label="anchor" href="#handling-duplicates-check-type-"></a>
</h3>


<p>The source records are checked regarding duplicates with respect to the
by variables and the date and order specified in the source objects.
By default, a warning is issued if any duplicates are found.
Note here how after creating a new adverse event dataset containing a
duplicate date for <code>"Cough"</code>, it was then passed to the function using the
<code>source_datasets</code> argument - where you see below <code>adae = adae_dup</code>.</p>
<p></p>
<div class="sourceCode r">
<pre><code><span><span class="va">adae_dup</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tribble.html" class="external-link">tribble</a></span><span class="op">(</span></span>
<span>  <span class="op">~</span><span class="va">USUBJID</span>, <span class="op">~</span><span class="va">ASTDT</span>,            <span class="op">~</span><span class="va">AESEQ</span>, <span class="op">~</span><span class="va">AEDECOD</span>, <span class="op">~</span><span class="va">AESER</span>,</span>
<span>  <span class="st">"01"</span>,     <span class="fu"><a href="https://lubridate.tidyverse.org/reference/ymd.html" class="external-link">ymd</a></span><span class="op">(</span><span class="st">"2021-01-03"</span><span class="op">)</span>,      <span class="fl">1</span>, <span class="st">"Flu"</span>,    <span class="st">"Y"</span>,</span>
<span>  <span class="st">"01"</span>,     <span class="fu"><a href="https://lubridate.tidyverse.org/reference/ymd.html" class="external-link">ymd</a></span><span class="op">(</span><span class="st">"2021-03-04"</span><span class="op">)</span>,      <span class="fl">2</span>, <span class="st">"Cough"</span>,  <span class="st">"N"</span>,</span>
<span>  <span class="st">"01"</span>,     <span class="fu"><a href="https://lubridate.tidyverse.org/reference/ymd.html" class="external-link">ymd</a></span><span class="op">(</span><span class="st">"2021-03-04"</span><span class="op">)</span>,      <span class="fl">3</span>, <span class="st">"Cough"</span>,  <span class="st">"Y"</span></span>
<span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>STUDYID <span class="op">=</span> <span class="st">"AB42"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/derive_param_tte.html">derive_param_tte</a></span><span class="op">(</span></span>
<span>  dataset_adsl <span class="op">=</span> <span class="va">adsl</span>,</span>
<span>  by_vars <span class="op">=</span> <span class="fu"><a href="../reference/reexport-exprs.html">exprs</a></span><span class="op">(</span><span class="va">AEDECOD</span><span class="op">)</span>,</span>
<span>  start_date <span class="op">=</span> <span class="va">TRTSDT</span>,</span>
<span>  source_datasets <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>adsl <span class="op">=</span> <span class="va">adsl</span>, adae <span class="op">=</span> <span class="va">adae_dup</span><span class="op">)</span>,</span>
<span>  event_conditions <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">ttae</span><span class="op">)</span>,</span>
<span>  censor_conditions <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">eos</span><span class="op">)</span>,</span>
<span>  set_values_to <span class="op">=</span> <span class="fu"><a href="../reference/reexport-exprs.html">exprs</a></span><span class="op">(</span></span>
<span>    PARAMCD <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"TTAE"</span>, <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="va">AEDECOD</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    PARAM <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"Time to First"</span>, <span class="va">AEDECOD</span>, <span class="st">"Adverse Event"</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 4 Ã— 11</span></span>
<span><span class="co">#&gt;   USUBJID STUDYID EVNTDESC     SRCDOM SRCVAR SRCSEQ  CNSR ADT        STARTDT</span></span>
<span><span class="co">#&gt;   &lt;chr&gt;   &lt;chr&gt;   &lt;chr&gt;        &lt;chr&gt;  &lt;chr&gt;   &lt;dbl&gt; &lt;int&gt; &lt;date&gt;     &lt;date&gt;</span></span>
<span><span class="co">#&gt; 1 01      AB42    AE           ADAE   ASTDT       2     0 2021-03-04 2020-12-06</span></span>
<span><span class="co">#&gt; 2 01      AB42    AE           ADAE   ASTDT       1     0 2021-01-03 2020-12-06</span></span>
<span><span class="co">#&gt; 3 02      AB42    END OF STUDY ADSL   EOSDT      NA     1 2021-02-03 2021-01-16</span></span>
<span><span class="co">#&gt; 4 02      AB42    END OF STUDY ADSL   EOSDT      NA     1 2021-02-03 2021-01-16</span></span>
<span><span class="co">#&gt; # i 2 more variables: PARAMCD &lt;chr&gt;, PARAM &lt;chr&gt;</span></span>
<span><span class="co">#&gt; Warning: Dataset "adae" contains duplicate records with respect to `STUDYID`, `USUBJID`,</span></span>
<span><span class="co">#&gt; `AEDECOD`, and `ASTDT`</span></span>
<span><span class="co">#&gt; i Run `admiral::get_duplicates_dataset()` to access the duplicate records</span></span></code></pre>
<p></p>
</div>
<p>For investigating the issue, the dataset of the duplicate source records
can be obtained by calling <code><a href="get_duplicates_dataset.html">get_duplicates_dataset()</a></code>:</p>
<p></p>
<div class="sourceCode r">
<pre><code><span><span class="fu"><a href="../reference/get_duplicates_dataset.html">get_duplicates_dataset</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; Duplicate records with respect to `STUDYID`, `USUBJID`, `AEDECOD`, and `ASTDT`.</span></span>
<span><span class="co">#&gt; # A tibble: 2 Ã— 6</span></span>
<span><span class="co">#&gt;   STUDYID USUBJID AEDECOD ASTDT      AESEQ AESER</span></span>
<span><span class="co">#&gt; * &lt;chr&gt;   &lt;chr&gt;   &lt;chr&gt;   &lt;date&gt;     &lt;dbl&gt; &lt;chr&gt;</span></span>
<span><span class="co">#&gt; 1 AB42    01      Cough   2021-03-04     2 N</span></span>
<span><span class="co">#&gt; 2 AB42    01      Cough   2021-03-04     3 Y    </span></span></code></pre>
<p></p>
</div>
<p>Common options to solve the issue:</p>
<ul>
<li><p>Restricting the source records by specifying/updating the <code>filter</code> argument
in the <code><a href="event_source.html">event_source()</a></code>/<code><a href="censor_source.html">censor_source()</a></code> calls.</p></li>
<li><p>Specifying additional variables for <code>order</code> in the
<code><a href="event_source.html">event_source()</a></code>/<code><a href="censor_source.html">censor_source()</a></code> calls.</p></li>
<li><p>Setting <code>check_type = "none"</code> in the <code>derive_param_tte()</code> call to ignore any
duplicates.</p></li>
</ul>
<p>In this example it does not have significant impact which record is chosen as
the dates are the same so the time to event derivation will be the same, but
it does impact <code>SRCSEQ</code> in the output dataset, so here the second option is
used.
Note here how you can also define source objects from within the <code>derive_param_tte()</code>
function call itself.</p>
<p></p>
<div class="sourceCode r">
<pre><code><span><span class="fu"><a href="../reference/derive_param_tte.html">derive_param_tte</a></span><span class="op">(</span></span>
<span>  dataset_adsl <span class="op">=</span> <span class="va">adsl</span>,</span>
<span>  by_vars <span class="op">=</span> <span class="fu"><a href="../reference/reexport-exprs.html">exprs</a></span><span class="op">(</span><span class="va">AEDECOD</span><span class="op">)</span>,</span>
<span>  start_date <span class="op">=</span> <span class="va">TRTSDT</span>,</span>
<span>  source_datasets <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>adsl <span class="op">=</span> <span class="va">adsl</span>, adae <span class="op">=</span> <span class="va">adae_dup</span><span class="op">)</span>,</span>
<span>  event_conditions <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="../reference/event_source.html">event_source</a></span><span class="op">(</span></span>
<span>    dataset_name <span class="op">=</span> <span class="st">"adae"</span>,</span>
<span>    date <span class="op">=</span> <span class="va">ASTDT</span>,</span>
<span>    set_values_to <span class="op">=</span> <span class="fu"><a href="../reference/reexport-exprs.html">exprs</a></span><span class="op">(</span></span>
<span>      EVNTDESC <span class="op">=</span> <span class="st">"AE"</span>,</span>
<span>      SRCDOM <span class="op">=</span> <span class="st">"ADAE"</span>,</span>
<span>      SRCVAR <span class="op">=</span> <span class="st">"ASTDT"</span>,</span>
<span>      SRCSEQ <span class="op">=</span> <span class="va">AESEQ</span></span>
<span>    <span class="op">)</span>,</span>
<span>    order <span class="op">=</span> <span class="fu"><a href="../reference/reexport-exprs.html">exprs</a></span><span class="op">(</span><span class="va">AESEQ</span><span class="op">)</span></span>
<span>  <span class="op">)</span><span class="op">)</span>,</span>
<span>  censor_conditions <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">eos</span><span class="op">)</span>,</span>
<span>  set_values_to <span class="op">=</span> <span class="fu"><a href="../reference/reexport-exprs.html">exprs</a></span><span class="op">(</span></span>
<span>    PARAMCD <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"TTAE"</span>, <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="va">AEDECOD</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    PARAM <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"Time to First"</span>, <span class="va">AEDECOD</span>, <span class="st">"Adverse Event"</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">USUBJID</span>, <span class="va">STARTDT</span>, <span class="va">PARAMCD</span>, <span class="va">PARAM</span>, <span class="va">ADT</span>, <span class="va">CNSR</span>, <span class="va">SRCSEQ</span><span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 4 Ã— 7</span></span>
<span><span class="co">#&gt;   USUBJID STARTDT    PARAMCD PARAM                       ADT         CNSR SRCSEQ</span></span>
<span><span class="co">#&gt;   &lt;chr&gt;   &lt;date&gt;     &lt;chr&gt;   &lt;chr&gt;                       &lt;date&gt;     &lt;int&gt;  &lt;dbl&gt;</span></span>
<span><span class="co">#&gt; 1 01      2020-12-06 TTAE1   Time to First Cough Adversâ€¦ 2021-03-04     0      2</span></span>
<span><span class="co">#&gt; 2 01      2020-12-06 TTAE2   Time to First Flu Adverse â€¦ 2021-01-03     0      1</span></span>
<span><span class="co">#&gt; 3 02      2021-01-16 TTAE1   Time to First Cough Adversâ€¦ 2021-02-03     1     NA</span></span>
<span><span class="co">#&gt; 4 02      2021-01-16 TTAE2   Time to First Flu Adverse â€¦ 2021-02-03     1     NA</span></span></code></pre>
<p></p>
</div>
</div>
<div class="section">
<h3 id="filtering-source-records-filter-">Filtering source records (<code>filter</code>)<a class="anchor" aria-label="anchor" href="#filtering-source-records-filter-"></a>
</h3>


<p>The first option from above could have been achieved using <code>filter</code>, for
example here only using serious adverse events.</p>
<p></p>
<div class="sourceCode r">
<pre><code><span><span class="fu"><a href="../reference/derive_param_tte.html">derive_param_tte</a></span><span class="op">(</span></span>
<span>  dataset_adsl <span class="op">=</span> <span class="va">adsl</span>,</span>
<span>  by_vars <span class="op">=</span> <span class="fu"><a href="../reference/reexport-exprs.html">exprs</a></span><span class="op">(</span><span class="va">AEDECOD</span><span class="op">)</span>,</span>
<span>  start_date <span class="op">=</span> <span class="va">TRTSDT</span>,</span>
<span>  source_datasets <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>adsl <span class="op">=</span> <span class="va">adsl</span>, adae <span class="op">=</span> <span class="va">adae_dup</span><span class="op">)</span>,</span>
<span>  event_conditions <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="../reference/event_source.html">event_source</a></span><span class="op">(</span></span>
<span>    dataset_name <span class="op">=</span> <span class="st">"adae"</span>,</span>
<span>    filter <span class="op">=</span> <span class="va">AESER</span> <span class="op">==</span> <span class="st">"Y"</span>,</span>
<span>    date <span class="op">=</span> <span class="va">ASTDT</span>,</span>
<span>    set_values_to <span class="op">=</span> <span class="fu"><a href="../reference/reexport-exprs.html">exprs</a></span><span class="op">(</span></span>
<span>      EVNTDESC <span class="op">=</span> <span class="st">"Serious AE"</span>,</span>
<span>      SRCDOM <span class="op">=</span> <span class="st">"ADAE"</span>,</span>
<span>      SRCVAR <span class="op">=</span> <span class="st">"ASTDT"</span>,</span>
<span>      SRCSEQ <span class="op">=</span> <span class="va">AESEQ</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span><span class="op">)</span>,</span>
<span>  censor_conditions <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">eos</span><span class="op">)</span>,</span>
<span>  set_values_to <span class="op">=</span> <span class="fu"><a href="../reference/reexport-exprs.html">exprs</a></span><span class="op">(</span></span>
<span>    PARAMCD <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"TTSAE"</span>, <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="va">AEDECOD</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    PARAM <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"Time to First Serious"</span>, <span class="va">AEDECOD</span>, <span class="st">"Adverse Event"</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">USUBJID</span>, <span class="va">STARTDT</span>, <span class="va">PARAMCD</span>, <span class="va">PARAM</span>, <span class="va">ADT</span>, <span class="va">CNSR</span>, <span class="va">SRCSEQ</span><span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 4 Ã— 7</span></span>
<span><span class="co">#&gt;   USUBJID STARTDT    PARAMCD PARAM                       ADT         CNSR SRCSEQ</span></span>
<span><span class="co">#&gt;   &lt;chr&gt;   &lt;date&gt;     &lt;chr&gt;   &lt;chr&gt;                       &lt;date&gt;     &lt;int&gt;  &lt;dbl&gt;</span></span>
<span><span class="co">#&gt; 1 01      2020-12-06 TTSAE1  Time to First Serious Cougâ€¦ 2021-03-04     0      3</span></span>
<span><span class="co">#&gt; 2 01      2020-12-06 TTSAE2  Time to First Serious Flu â€¦ 2021-01-03     0      1</span></span>
<span><span class="co">#&gt; 3 02      2021-01-16 TTSAE1  Time to First Serious Cougâ€¦ 2021-02-03     1     NA</span></span>
<span><span class="co">#&gt; 4 02      2021-01-16 TTSAE2  Time to First Serious Flu â€¦ 2021-02-03     1     NA</span></span></code></pre>
<p></p>
</div>
</div>
<div class="section">
<h3 id="using-multiple-event-censor-conditions-event-conditions-censor-conditions-">Using multiple event/censor conditions (<code>event_conditions</code>
/<code>censor_conditions</code>)<a class="anchor" aria-label="anchor" href="#using-multiple-event-censor-conditions-event-conditions-censor-conditions-"></a>
</h3>


<p>In the above examples, we only have a single event and single censor
condition. Here, we now consider multiple conditions for each passed using
<code>event_conditions</code> and <code>censor_conditions</code>.</p>
<p>For the event we are going to use first AE and additionally check a lab condition,
and for the censor we'll add in treatment start date in case end of study date
was ever missing.</p>
<p></p>
<div class="sourceCode r">
<pre><code><span><span class="va">adlb</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tribble.html" class="external-link">tribble</a></span><span class="op">(</span></span>
<span>  <span class="op">~</span><span class="va">USUBJID</span>, <span class="op">~</span><span class="va">ADT</span>,              <span class="op">~</span><span class="va">PARAMCD</span>, <span class="op">~</span><span class="va">ANRIND</span>,</span>
<span>  <span class="st">"01"</span>,     <span class="fu"><a href="https://lubridate.tidyverse.org/reference/ymd.html" class="external-link">ymd</a></span><span class="op">(</span><span class="st">"2020-12-22"</span><span class="op">)</span>, <span class="st">"HGB"</span>,    <span class="st">"LOW"</span></span>
<span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>STUDYID <span class="op">=</span> <span class="st">"AB42"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">low_hgb</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/event_source.html">event_source</a></span><span class="op">(</span></span>
<span>  dataset_name <span class="op">=</span> <span class="st">"adlb"</span>,</span>
<span>  filter <span class="op">=</span> <span class="va">PARAMCD</span> <span class="op">==</span> <span class="st">"HGB"</span> <span class="op">&amp;</span> <span class="va">ANRIND</span> <span class="op">==</span> <span class="st">"LOW"</span>,</span>
<span>  date <span class="op">=</span> <span class="va">ADT</span>,</span>
<span>  set_values_to <span class="op">=</span> <span class="fu"><a href="../reference/reexport-exprs.html">exprs</a></span><span class="op">(</span></span>
<span>    EVNTDESC <span class="op">=</span> <span class="st">"POSSIBLE ANEMIA"</span>,</span>
<span>    SRCDOM <span class="op">=</span> <span class="st">"ADLB"</span>,</span>
<span>    SRCVAR <span class="op">=</span> <span class="st">"ADT"</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">trt_start</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/censor_source.html">censor_source</a></span><span class="op">(</span></span>
<span>  dataset_name <span class="op">=</span> <span class="st">"adsl"</span>,</span>
<span>  date <span class="op">=</span> <span class="va">TRTSDT</span>,</span>
<span>  set_values_to <span class="op">=</span> <span class="fu"><a href="../reference/reexport-exprs.html">exprs</a></span><span class="op">(</span></span>
<span>    EVNTDESC <span class="op">=</span> <span class="st">"TREATMENT START"</span>,</span>
<span>    SRCDOM <span class="op">=</span> <span class="st">"ADSL"</span>,</span>
<span>    SRCVAR <span class="op">=</span> <span class="st">"TRTSDT"</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/derive_param_tte.html">derive_param_tte</a></span><span class="op">(</span></span>
<span>  dataset_adsl <span class="op">=</span> <span class="va">adsl</span>,</span>
<span>  event_conditions <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">ttae</span>, <span class="va">low_hgb</span><span class="op">)</span>,</span>
<span>  censor_conditions <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">eos</span>, <span class="va">trt_start</span><span class="op">)</span>,</span>
<span>  source_datasets <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>adsl <span class="op">=</span> <span class="va">adsl</span>, adae <span class="op">=</span> <span class="va">adae</span>, adlb <span class="op">=</span> <span class="va">adlb</span><span class="op">)</span>,</span>
<span>  set_values_to <span class="op">=</span> <span class="fu"><a href="../reference/reexport-exprs.html">exprs</a></span><span class="op">(</span></span>
<span>    PARAMCD <span class="op">=</span> <span class="st">"TTAELB"</span>,</span>
<span>    PARAM <span class="op">=</span> <span class="st">"Time to First Adverse Event or Possible Anemia (Labs)"</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">USUBJID</span>, <span class="va">STARTDT</span>, <span class="va">PARAMCD</span>, <span class="va">PARAM</span>, <span class="va">ADT</span>, <span class="va">CNSR</span>, <span class="va">SRCSEQ</span><span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 2 Ã— 7</span></span>
<span><span class="co">#&gt;   USUBJID STARTDT    PARAMCD PARAM                       ADT         CNSR SRCSEQ</span></span>
<span><span class="co">#&gt;   &lt;chr&gt;   &lt;date&gt;     &lt;chr&gt;   &lt;chr&gt;                       &lt;date&gt;     &lt;int&gt;  &lt;dbl&gt;</span></span>
<span><span class="co">#&gt; 1 01      2020-12-06 TTAELB  Time to First Adverse Evenâ€¦ 2020-12-22     0     NA</span></span>
<span><span class="co">#&gt; 2 02      2021-01-16 TTAELB  Time to First Adverse Evenâ€¦ 2021-02-03     1     NA</span></span></code></pre>
<p></p>
</div>
<p>Note above how the earliest event date is always taken and the latest
censor date.</p>
</div>
<div class="section">
<h3 id="using-different-censor-values-censor-and-censoring-at-earliest-occurring-censor-condition">Using different censor values (<code>censor</code>) and censoring at earliest
occurring censor condition<a class="anchor" aria-label="anchor" href="#using-different-censor-values-censor-and-censoring-at-earliest-occurring-censor-condition"></a>
</h3>


<p>Within <code><a href="censor_source.html">censor_source()</a></code> the value used to denote a censor can be
changed from the default of <code>1</code>.</p>
<p>In this example an extra censor is used for new drug date with the value of <code>2</code>.</p>
<p></p>
<div class="sourceCode r">
<pre><code><span><span class="va">newdrug</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/censor_source.html">censor_source</a></span><span class="op">(</span></span>
<span>  dataset_name <span class="op">=</span> <span class="st">"adsl"</span>,</span>
<span>  date <span class="op">=</span> <span class="va">NEWDRGDT</span>,</span>
<span>  censor <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  set_values_to <span class="op">=</span> <span class="fu"><a href="../reference/reexport-exprs.html">exprs</a></span><span class="op">(</span></span>
<span>    EVNTDESC <span class="op">=</span> <span class="st">"NEW DRUG RECEIVED"</span>,</span>
<span>    SRCDOM <span class="op">=</span> <span class="st">"ADSL"</span>,</span>
<span>    SRCVAR <span class="op">=</span> <span class="st">"NEWDRGDT"</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/derive_param_tte.html">derive_param_tte</a></span><span class="op">(</span></span>
<span>  dataset_adsl <span class="op">=</span> <span class="va">adsl</span>,</span>
<span>  by_vars <span class="op">=</span> <span class="fu"><a href="../reference/reexport-exprs.html">exprs</a></span><span class="op">(</span><span class="va">AEDECOD</span><span class="op">)</span>,</span>
<span>  event_conditions <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">ttae</span><span class="op">)</span>,</span>
<span>  censor_conditions <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">eos</span>, <span class="va">newdrug</span><span class="op">)</span>,</span>
<span>  source_datasets <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>adsl <span class="op">=</span> <span class="va">adsl</span>, adae <span class="op">=</span> <span class="va">adae</span><span class="op">)</span>,</span>
<span>  set_values_to <span class="op">=</span> <span class="fu"><a href="../reference/reexport-exprs.html">exprs</a></span><span class="op">(</span></span>
<span>    PARAMCD <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"TTAE"</span>, <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="va">AEDECOD</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    PARAM <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"Time to First"</span>, <span class="va">AEDECOD</span>, <span class="st">"Adverse Event"</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">USUBJID</span>, <span class="va">STARTDT</span>, <span class="va">PARAMCD</span>, <span class="va">PARAM</span>, <span class="va">ADT</span>, <span class="va">CNSR</span>, <span class="va">SRCSEQ</span><span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 4 Ã— 7</span></span>
<span><span class="co">#&gt;   USUBJID STARTDT    PARAMCD PARAM                       ADT         CNSR SRCSEQ</span></span>
<span><span class="co">#&gt;   &lt;chr&gt;   &lt;date&gt;     &lt;chr&gt;   &lt;chr&gt;                       &lt;date&gt;     &lt;int&gt;  &lt;dbl&gt;</span></span>
<span><span class="co">#&gt; 1 01      2020-12-06 TTAE1   Time to First Cough Adversâ€¦ 2021-03-04     0      2</span></span>
<span><span class="co">#&gt; 2 01      2020-12-06 TTAE2   Time to First Flu Adverse â€¦ 2021-01-03     0      1</span></span>
<span><span class="co">#&gt; 3 02      2021-01-16 TTAE1   Time to First Cough Adversâ€¦ 2021-02-03     1     NA</span></span>
<span><span class="co">#&gt; 4 02      2021-01-16 TTAE2   Time to First Flu Adverse â€¦ 2021-02-03     1     NA</span></span></code></pre>
<p></p>
</div>
<p>In this case the results are still the same, because as explained in
the above example the latest censor condition is always taken for those
without an event. For the second subject this is still the end of study
date.</p>
<p>So, if we wanted to instead censor here at the new drug date if subject
has one, then we would need to again use the <code>filter</code> argument, but this
time for a new end of study censor source object.</p>
<p></p>
<div class="sourceCode r">
<pre><code><span><span class="va">eos_nonewdrug</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/censor_source.html">censor_source</a></span><span class="op">(</span></span>
<span>  dataset_name <span class="op">=</span> <span class="st">"adsl"</span>,</span>
<span>  filter <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">NEWDRGDT</span><span class="op">)</span>,</span>
<span>  date <span class="op">=</span> <span class="va">EOSDT</span>,</span>
<span>  set_values_to <span class="op">=</span> <span class="fu"><a href="../reference/reexport-exprs.html">exprs</a></span><span class="op">(</span></span>
<span>    EVNTDESC <span class="op">=</span> <span class="st">"END OF STUDY"</span>,</span>
<span>    SRCDOM <span class="op">=</span> <span class="st">"ADSL"</span>,</span>
<span>    SRCVAR <span class="op">=</span> <span class="st">"EOSDT"</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/derive_param_tte.html">derive_param_tte</a></span><span class="op">(</span></span>
<span>  dataset_adsl <span class="op">=</span> <span class="va">adsl</span>,</span>
<span>  by_vars <span class="op">=</span> <span class="fu"><a href="../reference/reexport-exprs.html">exprs</a></span><span class="op">(</span><span class="va">AEDECOD</span><span class="op">)</span>,</span>
<span>  event_conditions <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">ttae</span><span class="op">)</span>,</span>
<span>  censor_conditions <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">eos_nonewdrug</span>, <span class="va">newdrug</span><span class="op">)</span>,</span>
<span>  source_datasets <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>adsl <span class="op">=</span> <span class="va">adsl</span>, adae <span class="op">=</span> <span class="va">adae</span><span class="op">)</span>,</span>
<span>  set_values_to <span class="op">=</span> <span class="fu"><a href="../reference/reexport-exprs.html">exprs</a></span><span class="op">(</span></span>
<span>    PARAMCD <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"TTAE"</span>, <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="va">AEDECOD</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    PARAM <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"Time to First"</span>, <span class="va">AEDECOD</span>, <span class="st">"Adverse Event"</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">USUBJID</span>, <span class="va">STARTDT</span>, <span class="va">PARAMCD</span>, <span class="va">PARAM</span>, <span class="va">ADT</span>, <span class="va">CNSR</span>, <span class="va">SRCSEQ</span><span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 4 Ã— 7</span></span>
<span><span class="co">#&gt;   USUBJID STARTDT    PARAMCD PARAM                       ADT         CNSR SRCSEQ</span></span>
<span><span class="co">#&gt;   &lt;chr&gt;   &lt;date&gt;     &lt;chr&gt;   &lt;chr&gt;                       &lt;date&gt;     &lt;int&gt;  &lt;dbl&gt;</span></span>
<span><span class="co">#&gt; 1 01      2020-12-06 TTAE1   Time to First Cough Adversâ€¦ 2021-03-04     0      2</span></span>
<span><span class="co">#&gt; 2 01      2020-12-06 TTAE2   Time to First Flu Adverse â€¦ 2021-01-03     0      1</span></span>
<span><span class="co">#&gt; 3 02      2021-01-16 TTAE1   Time to First Cough Adversâ€¦ 2021-01-16     2     NA</span></span>
<span><span class="co">#&gt; 4 02      2021-01-16 TTAE2   Time to First Flu Adverse â€¦ 2021-01-16     2     NA</span></span></code></pre>
<p></p>
</div>
</div>
<div class="section">
<h3 id="overall-survival-time-to-event-parameter">Overall survival time to event parameter<a class="anchor" aria-label="anchor" href="#overall-survival-time-to-event-parameter"></a>
</h3>


<p>In oncology trials, this is commonly derived as time from randomization
date to death. For those without event, they are censored at the last date
they are known to be alive.</p>
<ul>
<li><p>The start date is set using <code>start_date</code> argument, now that we need to use
different to the default.</p></li>
<li><p>In this example, datetime was needed, which can be achieved by setting
<code>create_datetime</code> argument to <code>TRUE</code>.</p></li>
</ul>
<p></p>
<div class="sourceCode r">
<pre><code><span><span class="va">adsl</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tribble.html" class="external-link">tribble</a></span><span class="op">(</span></span>
<span>  <span class="op">~</span><span class="va">USUBJID</span>, <span class="op">~</span><span class="va">RANDDTM</span>,                       <span class="op">~</span><span class="va">LSALVDTM</span>,                      <span class="op">~</span><span class="va">DTHDTM</span>,                        <span class="op">~</span><span class="va">DTHFL</span>,</span>
<span>  <span class="st">"01"</span>,     <span class="fu"><a href="https://lubridate.tidyverse.org/reference/ymd_hms.html" class="external-link">ymd_hms</a></span><span class="op">(</span><span class="st">"2020-10-03 00:00:00"</span><span class="op">)</span>, <span class="fu"><a href="https://lubridate.tidyverse.org/reference/ymd_hms.html" class="external-link">ymd_hms</a></span><span class="op">(</span><span class="st">"2022-12-15 23:59:59"</span><span class="op">)</span>, <span class="cn">NA</span>,                             <span class="cn">NA</span>,</span>
<span>  <span class="st">"02"</span>,     <span class="fu"><a href="https://lubridate.tidyverse.org/reference/ymd_hms.html" class="external-link">ymd_hms</a></span><span class="op">(</span><span class="st">"2021-01-23 00:00:00"</span><span class="op">)</span>, <span class="fu"><a href="https://lubridate.tidyverse.org/reference/ymd_hms.html" class="external-link">ymd_hms</a></span><span class="op">(</span><span class="st">"2021-02-03 19:45:59"</span><span class="op">)</span>, <span class="fu"><a href="https://lubridate.tidyverse.org/reference/ymd_hms.html" class="external-link">ymd_hms</a></span><span class="op">(</span><span class="st">"2021-02-03 19:45:59"</span><span class="op">)</span>, <span class="st">"Y"</span></span>
<span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>STUDYID <span class="op">=</span> <span class="st">"AB42"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># derive overall survival parameter</span></span>
<span><span class="va">death</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/event_source.html">event_source</a></span><span class="op">(</span></span>
<span>  dataset_name <span class="op">=</span> <span class="st">"adsl"</span>,</span>
<span>  filter <span class="op">=</span> <span class="va">DTHFL</span> <span class="op">==</span> <span class="st">"Y"</span>,</span>
<span>  date <span class="op">=</span> <span class="va">DTHDTM</span>,</span>
<span>  set_values_to <span class="op">=</span> <span class="fu"><a href="../reference/reexport-exprs.html">exprs</a></span><span class="op">(</span></span>
<span>    EVNTDESC <span class="op">=</span> <span class="st">"DEATH"</span>,</span>
<span>    SRCDOM <span class="op">=</span> <span class="st">"ADSL"</span>,</span>
<span>    SRCVAR <span class="op">=</span> <span class="st">"DTHDTM"</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">last_alive</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/censor_source.html">censor_source</a></span><span class="op">(</span></span>
<span>  dataset_name <span class="op">=</span> <span class="st">"adsl"</span>,</span>
<span>  date <span class="op">=</span> <span class="va">LSALVDTM</span>,</span>
<span>  set_values_to <span class="op">=</span> <span class="fu"><a href="../reference/reexport-exprs.html">exprs</a></span><span class="op">(</span></span>
<span>    EVNTDESC <span class="op">=</span> <span class="st">"LAST DATE KNOWN ALIVE"</span>,</span>
<span>    SRCDOM <span class="op">=</span> <span class="st">"ADSL"</span>,</span>
<span>    SRCVAR <span class="op">=</span> <span class="st">"LSALVDTM"</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/derive_param_tte.html">derive_param_tte</a></span><span class="op">(</span></span>
<span>  dataset_adsl <span class="op">=</span> <span class="va">adsl</span>,</span>
<span>  start_date <span class="op">=</span> <span class="va">RANDDTM</span>,</span>
<span>  event_conditions <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">death</span><span class="op">)</span>,</span>
<span>  censor_conditions <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">last_alive</span><span class="op">)</span>,</span>
<span>  create_datetime <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  source_datasets <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>adsl <span class="op">=</span> <span class="va">adsl</span><span class="op">)</span>,</span>
<span>  set_values_to <span class="op">=</span> <span class="fu"><a href="../reference/reexport-exprs.html">exprs</a></span><span class="op">(</span></span>
<span>    PARAMCD <span class="op">=</span> <span class="st">"OS"</span>,</span>
<span>    PARAM <span class="op">=</span> <span class="st">"Overall Survival"</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">USUBJID</span>, <span class="va">STARTDTM</span>, <span class="va">PARAMCD</span>, <span class="va">PARAM</span>, <span class="va">ADTM</span>, <span class="va">CNSR</span><span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 2 Ã— 6</span></span>
<span><span class="co">#&gt;   USUBJID STARTDTM            PARAMCD PARAM            ADTM                 CNSR</span></span>
<span><span class="co">#&gt;   &lt;chr&gt;   &lt;dttm&gt;              &lt;chr&gt;   &lt;chr&gt;            &lt;dttm&gt;              &lt;int&gt;</span></span>
<span><span class="co">#&gt; 1 01      2020-10-03 00:00:00 OS      Overall Survival 2022-12-15 23:59:59     1</span></span>
<span><span class="co">#&gt; 2 02      2021-01-23 00:00:00 OS      Overall Survival 2021-02-03 19:45:59     0</span></span></code></pre>
<p></p>
</div>
</div>
<div class="section">
<h3 id="duration-of-response-time-to-event-parameter">Duration of response time to event parameter<a class="anchor" aria-label="anchor" href="#duration-of-response-time-to-event-parameter"></a>
</h3>


<p>In oncology trials, this is commonly derived as time from response until
progression or death, or if neither have occurred then censor at last tumor
assessment visit date. It is only relevant for subjects with a response.
Note how only observations for subjects in <code>dataset_adsl</code> have the new
parameter created, so see below how this is filtered only on responders.</p>
<p></p>
<div class="sourceCode r">
<pre><code><span><span class="va">adsl_resp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tribble.html" class="external-link">tribble</a></span><span class="op">(</span></span>
<span>  <span class="op">~</span><span class="va">USUBJID</span>, <span class="op">~</span><span class="va">DTHFL</span>, <span class="op">~</span><span class="va">DTHDT</span>,            <span class="op">~</span><span class="va">RSPDT</span>,</span>
<span>  <span class="st">"01"</span>,     <span class="st">"Y"</span>,    <span class="fu"><a href="https://lubridate.tidyverse.org/reference/ymd.html" class="external-link">ymd</a></span><span class="op">(</span><span class="st">"2021-06-12"</span><span class="op">)</span>, <span class="fu"><a href="https://lubridate.tidyverse.org/reference/ymd.html" class="external-link">ymd</a></span><span class="op">(</span><span class="st">"2021-03-04"</span><span class="op">)</span>,</span>
<span>  <span class="st">"02"</span>,     <span class="st">"N"</span>,    <span class="cn">NA</span>,                <span class="cn">NA</span>,</span>
<span>  <span class="st">"03"</span>,     <span class="st">"Y"</span>,    <span class="fu"><a href="https://lubridate.tidyverse.org/reference/ymd.html" class="external-link">ymd</a></span><span class="op">(</span><span class="st">"2021-08-21"</span><span class="op">)</span>, <span class="cn">NA</span>,</span>
<span>  <span class="st">"04"</span>,     <span class="st">"N"</span>,    <span class="cn">NA</span>,                <span class="fu"><a href="https://lubridate.tidyverse.org/reference/ymd.html" class="external-link">ymd</a></span><span class="op">(</span><span class="st">"2021-04-14"</span><span class="op">)</span></span>
<span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>STUDYID <span class="op">=</span> <span class="st">"AB42"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">adrs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tribble.html" class="external-link">tribble</a></span><span class="op">(</span></span>
<span>  <span class="op">~</span><span class="va">USUBJID</span>, <span class="op">~</span><span class="va">AVALC</span>, <span class="op">~</span><span class="va">ADT</span>,              <span class="op">~</span><span class="va">ASEQ</span>,</span>
<span>  <span class="st">"01"</span>,     <span class="st">"SD"</span>,   <span class="fu"><a href="https://lubridate.tidyverse.org/reference/ymd.html" class="external-link">ymd</a></span><span class="op">(</span><span class="st">"2021-01-03"</span><span class="op">)</span>, <span class="fl">1</span>,</span>
<span>  <span class="st">"01"</span>,     <span class="st">"PR"</span>,   <span class="fu"><a href="https://lubridate.tidyverse.org/reference/ymd.html" class="external-link">ymd</a></span><span class="op">(</span><span class="st">"2021-03-04"</span><span class="op">)</span>, <span class="fl">2</span>,</span>
<span>  <span class="st">"01"</span>,     <span class="st">"PD"</span>,   <span class="fu"><a href="https://lubridate.tidyverse.org/reference/ymd.html" class="external-link">ymd</a></span><span class="op">(</span><span class="st">"2021-05-05"</span><span class="op">)</span>, <span class="fl">3</span>,</span>
<span>  <span class="st">"02"</span>,     <span class="st">"PD"</span>,   <span class="fu"><a href="https://lubridate.tidyverse.org/reference/ymd.html" class="external-link">ymd</a></span><span class="op">(</span><span class="st">"2021-02-03"</span><span class="op">)</span>, <span class="fl">1</span>,</span>
<span>  <span class="st">"04"</span>,     <span class="st">"SD"</span>,   <span class="fu"><a href="https://lubridate.tidyverse.org/reference/ymd.html" class="external-link">ymd</a></span><span class="op">(</span><span class="st">"2021-02-13"</span><span class="op">)</span>, <span class="fl">1</span>,</span>
<span>  <span class="st">"04"</span>,     <span class="st">"PR"</span>,   <span class="fu"><a href="https://lubridate.tidyverse.org/reference/ymd.html" class="external-link">ymd</a></span><span class="op">(</span><span class="st">"2021-04-14"</span><span class="op">)</span>, <span class="fl">2</span>,</span>
<span>  <span class="st">"04"</span>,     <span class="st">"CR"</span>,   <span class="fu"><a href="https://lubridate.tidyverse.org/reference/ymd.html" class="external-link">ymd</a></span><span class="op">(</span><span class="st">"2021-05-15"</span><span class="op">)</span>, <span class="fl">3</span></span>
<span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>STUDYID <span class="op">=</span> <span class="st">"AB42"</span>, PARAMCD <span class="op">=</span> <span class="st">"OVR"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">pd</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/event_source.html">event_source</a></span><span class="op">(</span></span>
<span>  dataset_name <span class="op">=</span> <span class="st">"adrs"</span>,</span>
<span>  filter <span class="op">=</span> <span class="va">AVALC</span> <span class="op">==</span> <span class="st">"PD"</span>,</span>
<span>  date <span class="op">=</span> <span class="va">ADT</span>,</span>
<span>  set_values_to <span class="op">=</span> <span class="fu"><a href="../reference/reexport-exprs.html">exprs</a></span><span class="op">(</span></span>
<span>    EVENTDESC <span class="op">=</span> <span class="st">"PD"</span>,</span>
<span>    SRCDOM <span class="op">=</span> <span class="st">"ADRS"</span>,</span>
<span>    SRCVAR <span class="op">=</span> <span class="st">"ADTM"</span>,</span>
<span>    SRCSEQ <span class="op">=</span> <span class="va">ASEQ</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">death</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/event_source.html">event_source</a></span><span class="op">(</span></span>
<span>  dataset_name <span class="op">=</span> <span class="st">"adsl"</span>,</span>
<span>  filter <span class="op">=</span> <span class="va">DTHFL</span> <span class="op">==</span> <span class="st">"Y"</span>,</span>
<span>  date <span class="op">=</span> <span class="va">DTHDT</span>,</span>
<span>  set_values_to <span class="op">=</span> <span class="fu"><a href="../reference/reexport-exprs.html">exprs</a></span><span class="op">(</span></span>
<span>    EVENTDESC <span class="op">=</span> <span class="st">"DEATH"</span>,</span>
<span>    SRCDOM <span class="op">=</span> <span class="st">"ADSL"</span>,</span>
<span>    SRCVAR <span class="op">=</span> <span class="st">"DTHDT"</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">last_visit</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/censor_source.html">censor_source</a></span><span class="op">(</span></span>
<span>  dataset_name <span class="op">=</span> <span class="st">"adrs"</span>,</span>
<span>  date <span class="op">=</span> <span class="va">ADT</span>,</span>
<span>  set_values_to <span class="op">=</span> <span class="fu"><a href="../reference/reexport-exprs.html">exprs</a></span><span class="op">(</span></span>
<span>    EVENTDESC <span class="op">=</span> <span class="st">"LAST TUMOR ASSESSMENT"</span>,</span>
<span>    SRCDOM <span class="op">=</span> <span class="st">"ADRS"</span>,</span>
<span>    SRCVAR <span class="op">=</span> <span class="st">"ADTM"</span>,</span>
<span>    SRCSEQ <span class="op">=</span> <span class="va">ASEQ</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/derive_param_tte.html">derive_param_tte</a></span><span class="op">(</span></span>
<span>  dataset_adsl <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">adsl_resp</span>, <span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">RSPDT</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  start_date <span class="op">=</span> <span class="va">RSPDT</span>,</span>
<span>  event_conditions <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">pd</span>, <span class="va">death</span><span class="op">)</span>,</span>
<span>  censor_conditions <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">last_visit</span><span class="op">)</span>,</span>
<span>  source_datasets <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>adsl <span class="op">=</span> <span class="va">adsl_resp</span>, adrs <span class="op">=</span> <span class="va">adrs</span><span class="op">)</span>,</span>
<span>  set_values_to <span class="op">=</span> <span class="fu"><a href="../reference/reexport-exprs.html">exprs</a></span><span class="op">(</span></span>
<span>    PARAMCD <span class="op">=</span> <span class="st">"DURRSP"</span>,</span>
<span>    PARAM <span class="op">=</span> <span class="st">"Duration of Response"</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">USUBJID</span>, <span class="va">STARTDT</span>, <span class="va">PARAMCD</span>, <span class="va">PARAM</span>, <span class="va">ADT</span>, <span class="va">CNSR</span>, <span class="va">SRCSEQ</span><span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 2 Ã— 7</span></span>
<span><span class="co">#&gt;   USUBJID STARTDT    PARAMCD PARAM                ADT         CNSR SRCSEQ</span></span>
<span><span class="co">#&gt;   &lt;chr&gt;   &lt;date&gt;     &lt;chr&gt;   &lt;chr&gt;                &lt;date&gt;     &lt;int&gt;  &lt;dbl&gt;</span></span>
<span><span class="co">#&gt; 1 01      2021-03-04 DURRSP  Duration of Response 2021-05-05     0      3</span></span>
<span><span class="co">#&gt; 2 04      2021-04-14 DURRSP  Duration of Response 2021-05-15     1      3</span></span></code></pre>
<p></p>
</div>
</div>
<div class="section">
<h3 id="further-examples">Further examples<a class="anchor" aria-label="anchor" href="#further-examples"></a>
</h3>


<p>Further example usages of this function can be found in the
<code><a href="../articles/bds_tte.html">vignette("bds_tte")</a></code>.</p>
</div>
    </div>

  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by F. Hoffmann-La Roche AG, GlaxoSmithKline LLC, Ben Straub, Stefan Bundfuss, Arianna Cascone, Jeffrey Dickinson, Ross Farrugia, Fanny Gautier, G Gayatri, Solveig Holmgaard, Dinakar Kulkarni, Edoardo Mancini, Gordon Miller, Lina Patil, Jim Rothstein, Daniel Sjoberg, Stefan Thoma, Junze Zhang.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
