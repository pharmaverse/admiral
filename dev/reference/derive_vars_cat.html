<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Derive Categorization Variables Like AVALCATy and AVALCAyN â€” derive_vars_cat â€¢ admiral</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><script src="../deps/MathJax-3.2.2/tex-chtml.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Derive Categorization Variables Like AVALCATy and AVALCAyN â€” derive_vars_cat"><meta name="description" content="Derive Categorization Variables Like AVALCATy and AVALCAyN"><meta property="og:description" content="Derive Categorization Variables Like AVALCATy and AVALCAyN"><meta property="og:image" content="https://pharmaverse.github.io/admiral/logo.png"><meta name="robots" content="noindex"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">admiral</a>

    <small class="nav-text text-default me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="In-development version">1.2.0.9020</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-get-started" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Get Started</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-get-started"><li><a class="dropdown-item" href="../articles/admiral.html">Get Started</a></li>
    <li><a class="external-link dropdown-item" href="https://github.com/pharmaverse/admiral/blob/main/inst/cheatsheet/admiral_cheatsheet.pdf">Cheatsheet</a></li>
    <li><a class="dropdown-item" href="https://pharmaverse.github.io/admiraldiscovery/articles/presentation_archive.html">Presentation Archive</a></li>
  </ul></li>
<li class="active nav-item"><a class="nav-link" href="../reference/">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-user-guides" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">User Guides</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-user-guides"><li><h6 class="dropdown-header" data-toc-skip>General Guides</h6></li>
    <li><a class="dropdown-item" href="../articles/concepts_conventions.html">Programming Concepts and Conventions</a></li>
    <li><a class="dropdown-item" href="../articles/generic.html">Generic Derivations</a></li>
    <li><a class="dropdown-item" href="../articles/higher_order.html">Higher Order Functions</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>ADaM Script Guides</h6></li>
    <li><a class="dropdown-item" href="../articles/adsl.html">Creating a Basic ADSL</a></li>
    <li><a class="dropdown-item" href="../articles/occds.html">Creating an OCCDS ADaM</a></li>
    <li><a class="dropdown-item" href="../articles/bds_finding.html">Creating a BDS Findings ADAM</a></li>
    <li><a class="dropdown-item" href="../articles/bds_exposure.html">Creating a BDS Exposure ADaM</a></li>
    <li><a class="dropdown-item" href="../articles/bds_tte.html">Creating a BDS Time-to-Event ADaM</a></li>
    <li><a class="dropdown-item" href="../articles/questionnaires.html">Creating Questionnaire ADaMs</a></li>
    <li><a class="dropdown-item" href="../articles/pk_adnca.html">Creating a PK NCA or Population PK ADaM</a></li>
    <li><a class="dropdown-item" href="../articles/hys_law.html">Hy's Law Implementation</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Special Topics Guides</h6></li>
    <li><a class="dropdown-item" href="../articles/imputation.html">Date and Time Imputation</a></li>
    <li><a class="dropdown-item" href="../articles/visits_periods.html">Visit and Period Variables</a></li>
    <li><a class="dropdown-item" href="../articles/queries_dataset.html">Queries Dataset Documentation</a></li>
    <li><a class="dropdown-item" href="../articles/lab_grading.html">Lab Grading</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><a class="dropdown-item" href="../articles/faq.html">FAQ</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="https://pharmaverse.github.io/admiraldiscovery/articles/reactable.html">ðŸ”Ž Find my function</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://pharmaverse.slack.com/" aria-label="Slack"><span class="fa fa-slack"></span></a></li>
<li class="nav-item"><a class="nav-link" href="../articles/website-versions.html" aria-label="Previous Release Websites"><span class="fa fa-history"></span></a></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/pharmaverse/admiral/issues/new/choose" aria-label="New Issue"><span class="fa fa-bug"></span></a></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/pharmaverse/admiral/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Derive Categorization Variables Like <code>AVALCATy</code> and <code>AVALCAyN</code></h1>
      <small class="dont-index">Source: <a href="https://github.com/pharmaverse/admiral/blob/main/R/derive_vars_cat.R" class="external-link"><code>R/derive_vars_cat.R</code></a></small>
      <div class="d-none name"><code>derive_vars_cat.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Derive Categorization Variables Like <code>AVALCATy</code> and <code>AVALCAyN</code></p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">derive_vars_cat</span><span class="op">(</span><span class="va">dataset</span>, <span class="va">definition</span>, by_vars <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-dataset">dataset<a class="anchor" aria-label="anchor" href="#arg-dataset"></a></dt>
<dd><p>Input dataset</p>
<p>The variables specified by the <code>by_vars</code> and <code>definition</code> arguments are expected to be in the dataset.</p>
<dl><dt>Default value</dt>
<dd><p>none</p></dd>


</dl></dd>


<dt id="arg-definition">definition<a class="anchor" aria-label="anchor" href="#arg-definition"></a></dt>
<dd><p>List of expressions created by <code><a href="reexport-exprs.html">exprs()</a></code>.
Must be in rectangular format and specified using the same syntax as when creating
a <code>tibble</code> using the <code><a href="https://tibble.tidyverse.org/reference/tribble.html" class="external-link">tribble()</a></code> function.
The <code>definition</code> object will be converted to a <code>tibble</code> using <code><a href="https://tibble.tidyverse.org/reference/tribble.html" class="external-link">tribble()</a></code> inside this function.</p>
<p>Must contain:</p><ul><li><p>the column <code>condition</code> which will be converted to a logical expression and
will be used on the <code>dataset</code> input.</p></li>
<li><p>at least one additional column with the new column name and
the category value(s) used by the logical expression.</p></li>
<li><p>the column specified in <code>by_vars</code> (if <code>by_vars</code> is specified)</p></li>
</ul><p>e.g. if <code>by_vars</code> is not specified:</p>
<p></p><div class="sourceCode r"><pre><code><span><span class="fu"><a href="../reference/reexport-exprs.html">exprs</a></span><span class="op">(</span><span class="op">~</span><span class="va">condition</span>,   <span class="op">~</span><span class="va">AVALCAT1</span>, <span class="op">~</span><span class="va">AVALCA1N</span>,</span>
<span>      <span class="va">AVAL</span> <span class="op">&gt;=</span> <span class="fl">140</span>, <span class="st">"&gt;=140 cm"</span>,         <span class="fl">1</span>,</span>
<span>      <span class="va">AVAL</span> <span class="op">&lt;</span> <span class="fl">140</span>,   <span class="st">"&lt;140 cm"</span>,         <span class="fl">2</span><span class="op">)</span></span></code></pre><p></p></div>
<p>e.g. if <code>by_vars</code> is specified as <code>exprs(VSTEST)</code>:</p>
<p></p><div class="sourceCode r"><pre><code><span><span class="fu"><a href="../reference/reexport-exprs.html">exprs</a></span><span class="op">(</span><span class="op">~</span><span class="va">VSTEST</span>,   <span class="op">~</span><span class="va">condition</span>,  <span class="op">~</span><span class="va">AVALCAT1</span>, <span class="op">~</span><span class="va">AVALCA1N</span>,</span>
<span>      <span class="st">"Height"</span>, <span class="va">AVAL</span> <span class="op">&gt;=</span> <span class="fl">140</span>, <span class="st">"&gt;=140 cm"</span>,         <span class="fl">1</span>,</span>
<span>      <span class="st">"Height"</span>,  <span class="va">AVAL</span> <span class="op">&lt;</span> <span class="fl">140</span>,  <span class="st">"&lt;140 cm"</span>,         <span class="fl">2</span><span class="op">)</span></span></code></pre><p></p></div>
<dl><dt>Default value</dt>
<dd><p>none</p></dd>


</dl></dd>


<dt id="arg-by-vars">by_vars<a class="anchor" aria-label="anchor" href="#arg-by-vars"></a></dt>
<dd><p>list of expressions with one element. <code>NULL</code> by default.
Allows for specifying by groups, e.g. <code>exprs(PARAMCD)</code>.
Variable must be present in both <code>dataset</code> and <code>definition</code>.
The conditions in <code>definition</code> are applied only to those records that match <code>by_vars</code>.
The categorization variables are set to <code>NA</code> for records
not matching any of the by groups in <code>definition</code>.</p>
<dl><dt>Default value</dt>
<dd><p><code>NULL</code></p></dd>


</dl></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>The input dataset with the new variables defined in <code>definition</code> added</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>If conditions are overlapping, the row order of <code>definitions</code> must be carefully considered.
The <strong>first</strong> match will determine the category.
i.e. if</p>
<p><code>AVAL = 155</code></p>
<p>and the <code>definition</code> is:</p>
<p></p><div class="sourceCode r"><pre><code><span><span class="va">definition</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/reexport-exprs.html">exprs</a></span><span class="op">(</span></span>
<span>  <span class="op">~</span><span class="va">VSTEST</span>,   <span class="op">~</span><span class="va">condition</span>,  <span class="op">~</span><span class="va">AVALCAT1</span>, <span class="op">~</span><span class="va">AVALCA1N</span>,</span>
<span>  <span class="st">"Height"</span>,  <span class="va">AVAL</span> <span class="op">&gt;</span> <span class="fl">170</span>,  <span class="st">"&gt;170 cm"</span>,         <span class="fl">1</span>,</span>
<span>  <span class="st">"Height"</span>, <span class="va">AVAL</span> <span class="op">&lt;=</span> <span class="fl">170</span>, <span class="st">"&lt;=170 cm"</span>,         <span class="fl">2</span>,</span>
<span>  <span class="st">"Height"</span>, <span class="va">AVAL</span> <span class="op">&lt;=</span> <span class="fl">160</span>, <span class="st">"&lt;=160 cm"</span>,         <span class="fl">3</span></span>
<span><span class="op">)</span></span></code></pre><p></p></div>
<p>then <code>AVALCAT1</code> will be <code>"&lt;=170 cm"</code>, as this is the first match for <code>AVAL</code>.
If you specify:</p>
<p></p><div class="sourceCode r"><pre><code><span><span class="va">definition</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/reexport-exprs.html">exprs</a></span><span class="op">(</span></span>
<span>  <span class="op">~</span><span class="va">VSTEST</span>,   <span class="op">~</span><span class="va">condition</span>,  <span class="op">~</span><span class="va">AVALCAT1</span>, <span class="op">~</span><span class="va">AVALCA1N</span>,</span>
<span>  <span class="st">"Height"</span>, <span class="va">AVAL</span> <span class="op">&lt;=</span> <span class="fl">160</span>, <span class="st">"&lt;=160 cm"</span>,         <span class="fl">3</span>,</span>
<span>  <span class="st">"Height"</span>, <span class="va">AVAL</span> <span class="op">&lt;=</span> <span class="fl">170</span>, <span class="st">"&lt;=170 cm"</span>,         <span class="fl">2</span>,</span>
<span>  <span class="st">"Height"</span>,  <span class="va">AVAL</span> <span class="op">&gt;</span> <span class="fl">170</span>,  <span class="st">"&gt;170 cm"</span>,         <span class="fl">1</span></span>
<span><span class="op">)</span></span></code></pre><p></p></div>
<p>Then <code>AVAL &lt;= 160</code> will lead to <code>AVALCAT1 == "&lt;=160 cm"</code>,
<code>AVAL</code> in-between <code>160</code> and <code>170</code> will lead to <code>AVALCAT1 == "&lt;=170 cm"</code>,
and <code>AVAL &lt;= 170</code> will lead to <code>AVALCAT1 == "&gt;170 cm"</code>.</p>
<p>However, we suggest to be more explicit when defining the <code>condition</code>, to avoid overlap.
In this case, the middle condition should be:
<code>AVAL &lt;= 170 &amp; AVAL &gt; 160</code></p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p>General Derivation Functions for all ADaMs that returns variable appended to dataset:
<code><a href="derive_var_extreme_flag.html">derive_var_extreme_flag</a>()</code>,
<code><a href="derive_var_joined_exist_flag.html">derive_var_joined_exist_flag</a>()</code>,
<code><a href="derive_var_merged_ef_msrc.html">derive_var_merged_ef_msrc</a>()</code>,
<code><a href="derive_var_merged_exist_flag.html">derive_var_merged_exist_flag</a>()</code>,
<code><a href="derive_var_merged_summary.html">derive_var_merged_summary</a>()</code>,
<code><a href="derive_var_obs_number.html">derive_var_obs_number</a>()</code>,
<code><a href="derive_var_relative_flag.html">derive_var_relative_flag</a>()</code>,
<code><a href="derive_vars_computed.html">derive_vars_computed</a>()</code>,
<code><a href="derive_vars_joined.html">derive_vars_joined</a>()</code>,
<code><a href="derive_vars_merged.html">derive_vars_merged</a>()</code>,
<code><a href="derive_vars_merged_lookup.html">derive_vars_merged_lookup</a>()</code>,
<code><a href="derive_vars_transposed.html">derive_vars_transposed</a>()</code></p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tibble.tidyverse.org/" class="external-link">tibble</a></span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">advs</span> <span class="op">&lt;-</span> <span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/tribble.html" class="external-link">tribble</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="op">~</span><span class="va">USUBJID</span>,       <span class="op">~</span><span class="va">VSTEST</span>,  <span class="op">~</span><span class="va">AVAL</span>,</span></span>
<span class="r-in"><span>  <span class="st">"01-701-1015"</span>, <span class="st">"Height"</span>, <span class="fl">147.32</span>,</span></span>
<span class="r-in"><span>  <span class="st">"01-701-1015"</span>, <span class="st">"Weight"</span>,  <span class="fl">53.98</span>,</span></span>
<span class="r-in"><span>  <span class="st">"01-701-1023"</span>, <span class="st">"Height"</span>, <span class="fl">162.56</span>,</span></span>
<span class="r-in"><span>  <span class="st">"01-701-1023"</span>, <span class="st">"Weight"</span>,     <span class="cn">NA</span>,</span></span>
<span class="r-in"><span>  <span class="st">"01-701-1028"</span>, <span class="st">"Height"</span>,     <span class="cn">NA</span>,</span></span>
<span class="r-in"><span>  <span class="st">"01-701-1028"</span>, <span class="st">"Weight"</span>,     <span class="cn">NA</span>,</span></span>
<span class="r-in"><span>  <span class="st">"01-701-1033"</span>, <span class="st">"Height"</span>, <span class="fl">175.26</span>,</span></span>
<span class="r-in"><span>  <span class="st">"01-701-1033"</span>, <span class="st">"Weight"</span>,  <span class="fl">88.45</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">definition</span> <span class="op">&lt;-</span> <span class="fu"><a href="reexport-exprs.html">exprs</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="op">~</span><span class="va">condition</span>,                        <span class="op">~</span><span class="va">AVALCAT1</span>, <span class="op">~</span><span class="va">AVALCA1N</span>,  <span class="op">~</span><span class="va">NEWCOL</span>,</span></span>
<span class="r-in"><span>  <span class="va">VSTEST</span> <span class="op">==</span> <span class="st">"Height"</span> <span class="op">&amp;</span> <span class="va">AVAL</span> <span class="op">&gt;</span> <span class="fl">160</span>,   <span class="st">"&gt;160 cm"</span>,         <span class="fl">1</span>, <span class="st">"extra1"</span>,</span></span>
<span class="r-in"><span>  <span class="va">VSTEST</span> <span class="op">==</span> <span class="st">"Height"</span> <span class="op">&amp;</span> <span class="va">AVAL</span> <span class="op">&lt;=</span> <span class="fl">160</span>, <span class="st">"&lt;=160 cm"</span>,         <span class="fl">2</span>, <span class="st">"extra2"</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">derive_vars_cat</span><span class="op">(</span></span></span>
<span class="r-in"><span>  dataset <span class="op">=</span> <span class="va">advs</span>,</span></span>
<span class="r-in"><span>  definition <span class="op">=</span> <span class="va">definition</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 8 Ã— 6</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   USUBJID     VSTEST  AVAL AVALCAT1 AVALCA1N NEWCOL</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">1</span> 01-701-1015 Height 147.  &lt;=160 cm        2 extra2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">2</span> 01-701-1015 Weight  54.0 <span style="color: #BB0000;">NA</span>             <span style="color: #BB0000;">NA</span> <span style="color: #BB0000;">NA</span>    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">3</span> 01-701-1023 Height 163.  &gt;160 cm         1 extra1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">4</span> 01-701-1023 Weight  <span style="color: #BB0000;">NA</span>   <span style="color: #BB0000;">NA</span>             <span style="color: #BB0000;">NA</span> <span style="color: #BB0000;">NA</span>    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">5</span> 01-701-1028 Height  <span style="color: #BB0000;">NA</span>   <span style="color: #BB0000;">NA</span>             <span style="color: #BB0000;">NA</span> <span style="color: #BB0000;">NA</span>    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">6</span> 01-701-1028 Weight  <span style="color: #BB0000;">NA</span>   <span style="color: #BB0000;">NA</span>             <span style="color: #BB0000;">NA</span> <span style="color: #BB0000;">NA</span>    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">7</span> 01-701-1033 Height 175.  &gt;160 cm         1 extra1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">8</span> 01-701-1033 Weight  88.4 <span style="color: #BB0000;">NA</span>             <span style="color: #BB0000;">NA</span> <span style="color: #BB0000;">NA</span>    </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Using by_vars:</span></span></span>
<span class="r-in"><span><span class="va">definition2</span> <span class="op">&lt;-</span> <span class="fu"><a href="reexport-exprs.html">exprs</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="op">~</span><span class="va">VSTEST</span>,   <span class="op">~</span><span class="va">condition</span>,  <span class="op">~</span><span class="va">AVALCAT1</span>, <span class="op">~</span><span class="va">AVALCA1N</span>,</span></span>
<span class="r-in"><span>  <span class="st">"Height"</span>,  <span class="va">AVAL</span> <span class="op">&gt;</span> <span class="fl">160</span>,  <span class="st">"&gt;160 cm"</span>,         <span class="fl">1</span>,</span></span>
<span class="r-in"><span>  <span class="st">"Height"</span>, <span class="va">AVAL</span> <span class="op">&lt;=</span> <span class="fl">160</span>, <span class="st">"&lt;=160 cm"</span>,         <span class="fl">2</span>,</span></span>
<span class="r-in"><span>  <span class="st">"Weight"</span>,   <span class="va">AVAL</span> <span class="op">&gt;</span> <span class="fl">70</span>,   <span class="st">"&gt;70 kg"</span>,         <span class="fl">1</span>,</span></span>
<span class="r-in"><span>  <span class="st">"Weight"</span>,  <span class="va">AVAL</span> <span class="op">&lt;=</span> <span class="fl">70</span>,  <span class="st">"&lt;=70 kg"</span>,         <span class="fl">2</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">derive_vars_cat</span><span class="op">(</span></span></span>
<span class="r-in"><span>  dataset <span class="op">=</span> <span class="va">advs</span>,</span></span>
<span class="r-in"><span>  definition <span class="op">=</span> <span class="va">definition2</span>,</span></span>
<span class="r-in"><span>  by_vars <span class="op">=</span> <span class="fu"><a href="reexport-exprs.html">exprs</a></span><span class="op">(</span><span class="va">VSTEST</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 8 Ã— 5</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   USUBJID     VSTEST  AVAL AVALCAT1 AVALCA1N</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">1</span> 01-701-1015 Height 147.  &lt;=160 cm        2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">2</span> 01-701-1015 Weight  54.0 &lt;=70 kg         2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">3</span> 01-701-1023 Height 163.  &gt;160 cm         1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">4</span> 01-701-1023 Weight  <span style="color: #BB0000;">NA</span>   <span style="color: #BB0000;">NA</span>             <span style="color: #BB0000;">NA</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">5</span> 01-701-1028 Height  <span style="color: #BB0000;">NA</span>   <span style="color: #BB0000;">NA</span>             <span style="color: #BB0000;">NA</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">6</span> 01-701-1028 Weight  <span style="color: #BB0000;">NA</span>   <span style="color: #BB0000;">NA</span>             <span style="color: #BB0000;">NA</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">7</span> 01-701-1033 Height 175.  &gt;160 cm         1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">8</span> 01-701-1033 Weight  88.4 &gt;70 kg          1</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># With three conditions:</span></span></span>
<span class="r-in"><span><span class="va">definition3</span> <span class="op">&lt;-</span> <span class="fu"><a href="reexport-exprs.html">exprs</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="op">~</span><span class="va">VSTEST</span>,                <span class="op">~</span><span class="va">condition</span>,  <span class="op">~</span><span class="va">AVALCAT1</span>, <span class="op">~</span><span class="va">AVALCA1N</span>,</span></span>
<span class="r-in"><span>  <span class="st">"Height"</span>,               <span class="va">AVAL</span> <span class="op">&gt;</span> <span class="fl">170</span>,  <span class="st">"&gt;170 cm"</span>,         <span class="fl">1</span>,</span></span>
<span class="r-in"><span>  <span class="st">"Height"</span>, <span class="va">AVAL</span> <span class="op">&lt;=</span> <span class="fl">170</span> <span class="op">&amp;</span> <span class="va">AVAL</span> <span class="op">&gt;</span> <span class="fl">160</span>, <span class="st">"&lt;=170 cm"</span>,         <span class="fl">2</span>,</span></span>
<span class="r-in"><span>  <span class="st">"Height"</span>,              <span class="va">AVAL</span> <span class="op">&lt;=</span> <span class="fl">160</span>, <span class="st">"&lt;=160 cm"</span>,         <span class="fl">3</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">derive_vars_cat</span><span class="op">(</span></span></span>
<span class="r-in"><span>  dataset <span class="op">=</span> <span class="va">advs</span>,</span></span>
<span class="r-in"><span>  definition <span class="op">=</span> <span class="va">definition3</span>,</span></span>
<span class="r-in"><span>  by_vars <span class="op">=</span> <span class="fu"><a href="reexport-exprs.html">exprs</a></span><span class="op">(</span><span class="va">VSTEST</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 8 Ã— 5</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   USUBJID     VSTEST  AVAL AVALCAT1 AVALCA1N</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">1</span> 01-701-1015 Height 147.  &lt;=160 cm        3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">2</span> 01-701-1015 Weight  54.0 <span style="color: #BB0000;">NA</span>             <span style="color: #BB0000;">NA</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">3</span> 01-701-1023 Height 163.  &lt;=170 cm        2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">4</span> 01-701-1023 Weight  <span style="color: #BB0000;">NA</span>   <span style="color: #BB0000;">NA</span>             <span style="color: #BB0000;">NA</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">5</span> 01-701-1028 Height  <span style="color: #BB0000;">NA</span>   <span style="color: #BB0000;">NA</span>             <span style="color: #BB0000;">NA</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">6</span> 01-701-1028 Weight  <span style="color: #BB0000;">NA</span>   <span style="color: #BB0000;">NA</span>             <span style="color: #BB0000;">NA</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">7</span> 01-701-1033 Height 175.  &gt;170 cm         1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">8</span> 01-701-1033 Weight  88.4 <span style="color: #BB0000;">NA</span>             <span style="color: #BB0000;">NA</span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Let's derive both the MCRITyML and the MCRITyMN variables</span></span></span>
<span class="r-in"><span><span class="va">adlb</span> <span class="op">&lt;-</span> <span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/tribble.html" class="external-link">tribble</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="op">~</span><span class="va">USUBJID</span>,     <span class="op">~</span><span class="va">PARAM</span>, <span class="op">~</span><span class="va">AVAL</span>, <span class="op">~</span><span class="va">AVALU</span>,  <span class="op">~</span><span class="va">ANRHI</span>,</span></span>
<span class="r-in"><span>  <span class="st">"01-701-1015"</span>, <span class="st">"ALT"</span>,   <span class="fl">150</span>,  <span class="st">"U/L"</span>,      <span class="fl">40</span>,</span></span>
<span class="r-in"><span>  <span class="st">"01-701-1023"</span>, <span class="st">"ALT"</span>,    <span class="fl">70</span>,  <span class="st">"U/L"</span>,      <span class="fl">40</span>,</span></span>
<span class="r-in"><span>  <span class="st">"01-701-1036"</span>, <span class="st">"ALT"</span>,   <span class="fl">130</span>,  <span class="st">"U/L"</span>,      <span class="fl">40</span>,</span></span>
<span class="r-in"><span>  <span class="st">"01-701-1048"</span>, <span class="st">"ALT"</span>,    <span class="fl">30</span>,  <span class="st">"U/L"</span>,      <span class="fl">40</span>,</span></span>
<span class="r-in"><span>  <span class="st">"01-701-1015"</span>, <span class="st">"AST"</span>,    <span class="fl">50</span>,  <span class="st">"U/L"</span>,      <span class="fl">35</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">definition_mcrit</span> <span class="op">&lt;-</span> <span class="fu"><a href="reexport-exprs.html">exprs</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="op">~</span><span class="va">PARAM</span>,                      <span class="op">~</span><span class="va">condition</span>,    <span class="op">~</span><span class="va">MCRIT1ML</span>, <span class="op">~</span><span class="va">MCRIT1MN</span>,</span></span>
<span class="r-in"><span>  <span class="st">"ALT"</span>,                    <span class="va">AVAL</span> <span class="op">&lt;=</span> <span class="va">ANRHI</span>,    <span class="st">"&lt;=ANRHI"</span>,         <span class="fl">1</span>,</span></span>
<span class="r-in"><span>  <span class="st">"ALT"</span>, <span class="va">ANRHI</span> <span class="op">&lt;</span> <span class="va">AVAL</span> <span class="op">&amp;</span> <span class="va">AVAL</span> <span class="op">&lt;=</span> <span class="fl">3</span> <span class="op">*</span> <span class="va">ANRHI</span>, <span class="st">"&gt;1-3*ANRHI"</span>,         <span class="fl">2</span>,</span></span>
<span class="r-in"><span>  <span class="st">"ALT"</span>,                 <span class="fl">3</span> <span class="op">*</span> <span class="va">ANRHI</span> <span class="op">&lt;</span> <span class="va">AVAL</span>,   <span class="st">"&gt;3*ANRHI"</span>,         <span class="fl">3</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">adlb</span> <span class="op"><a href="pipe.html">%&gt;%</a></span></span></span>
<span class="r-in"><span>  <span class="fu">derive_vars_cat</span><span class="op">(</span></span></span>
<span class="r-in"><span>    definition <span class="op">=</span> <span class="va">definition_mcrit</span>,</span></span>
<span class="r-in"><span>    by_vars <span class="op">=</span> <span class="fu"><a href="reexport-exprs.html">exprs</a></span><span class="op">(</span><span class="va">PARAM</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 5 Ã— 7</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   USUBJID     PARAM  AVAL AVALU ANRHI MCRIT1ML   MCRIT1MN</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>         <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">1</span> 01-701-1015 ALT     150 U/L      40 &gt;3*ANRHI          3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">2</span> 01-701-1023 ALT      70 U/L      40 &gt;1-3*ANRHI        2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">3</span> 01-701-1036 ALT     130 U/L      40 &gt;3*ANRHI          3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">4</span> 01-701-1048 ALT      30 U/L      40 &lt;=ANRHI           1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">5</span> 01-701-1015 AST      50 U/L      35 <span style="color: #BB0000;">NA</span>               <span style="color: #BB0000;">NA</span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Ben Straub, Stefan Bundfuss, Jeffrey Dickinson, Ross Farrugia, Fanny Gautier, Dinakar Kulkarni, Edoardo Mancini, Sadchla Mascary, Gordon Miller, Jim Rothstein, Sophie Shapcott, Eric Simms, Daniel Sjoberg, Stefan Thoma, Phillip Webster, Zelos Zhu, F. Hoffmann-La Roche AG, GlaxoSmithKline LLC.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

