<!DOCTYPE html>
<!-- Generated by pkgdown + https://github.com/insightsengineering/r-pkgdown-multiversion -->
<html lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Derive Duration â€” derive_vars_duration â€¢ admiral</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png">
<link rel="icon" type="â€image/svg+xmlâ€" href="../favicon.svg">
<link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png">
<link rel="icon" sizes="any" href="../favicon.ico">
<link rel="manifest" href="../site.webmanifest">
<!-- mathjax math --><script src="https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-mml-chtml.js" integrity="sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI=" crossorigin="anonymous"></script><script>
  window.MathJax = {
    chtml: {
      fontURL: "https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/output/chtml/fonts/woff-v2"
    }
  };
</script><script src="../lightswitch.js"></script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet">
<meta property="og:title" content="Derive Duration â€” derive_vars_duration">
<meta name="description" content="Derives duration between two dates, specified by the variables present in
input dataset e.g., duration of adverse events, relative day, age, ...">
<meta property="og:description" content="Derives duration between two dates, specified by the variables present in
input dataset e.g., duration of adverse events, relative day, age, ...">
<meta property="og:image" content="https:/pharmaverse.github.io/admiral/test_cicd/logo.png">
<script async src="https://widget.kapa.ai/kapa-widget.bundle.js" data-website-id="2c7249cc-f1dc-4a63-8674-6ecbcb34d95c" data-project-name="admiral" data-project-color="#2c3e50" data-project-logo="https://pharmaverse.github.io/admiral/cran-release/logo.png" data-consent-required="true" data-user-analytics-cookie-enabled="true" data-consent-screen-title="Help us improve our AI assistant" data-consent-screen-disclaimer="By clicking 'Allow tracking', you consent to anonymous user tracking which helps us improve our service. We don't collect any personally identifiable information." data-consent-screen-accept-button-text="Allow tracking" data-consent-screen-reject-button-text="No, thanks" data-modal-example-questions="Tell me a little about the {admiral} package., What are some important {admiral} functions and what do they do?" data-modal-search-placeholder="Ask me a question about {admiral} or the {admiral} ecosystem..." data-modal-z-index="9999"></script><script>
document.addEventListener("DOMContentLoaded", function () {
  // Select all navbar links that have an aria-label
  var navLinks = document.querySelectorAll('.navbar-nav .nav-link[aria-label]');

  navLinks.forEach(function (link) {
    // Initialize Bootstrap 5 Tooltip
    link.setAttribute('title', link.getAttribute('aria-label'));
    new bootstrap.Tooltip(link, {
      placement: 'bottom', // Tooltip appears below the icon
      trigger: 'hover'
    });
  });
});
</script>
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top " aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">admiral</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.4.1.9004</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-get-started" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Get Started</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-get-started">
<li><a class="dropdown-item" href="../articles/admiral.html">Get Started</a></li>
    <li><a class="external-link dropdown-item" href="https://github.com/pharmaverse/admiral/blob/main/inst/cheatsheet/admiral_cheatsheet.pdf">Cheatsheet</a></li>
    <li><a class="dropdown-item" href="../articles/templates.html">Explore ADaM Templates ðŸ§­</a></li>
    <li><a class="external-link dropdown-item" href="https://pharmaverse.github.io/admiraldiscovery/articles/presentation_archive.html">Presentation Archive</a></li>
  </ul>
</li>
<li class="active nav-item"><a class="nav-link" href="../reference/">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-user-guides" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">User Guides</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-user-guides">
<li><h6 class="dropdown-header" data-toc-skip>General Guides</h6></li>
    <li><a class="dropdown-item" href="../articles/concepts_conventions.html">Programming Concepts and Conventions</a></li>
    <li><a class="dropdown-item" href="../articles/generic.html">Generic Derivations</a></li>
    <li><a class="dropdown-item" href="../articles/higher_order.html">Higher Order Functions</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>ADaM Script Guides</h6></li>
    <li><a class="dropdown-item" href="../articles/adsl.html">Creating a Basic ADSL</a></li>
    <li><a class="dropdown-item" href="../articles/occds.html">Creating an OCCDS ADaM</a></li>
    <li><a class="dropdown-item" href="../articles/bds_finding.html">Creating a BDS Findings ADAM</a></li>
    <li><a class="dropdown-item" href="../articles/bds_exposure.html">Creating a BDS Exposure ADaM</a></li>
    <li><a class="dropdown-item" href="../articles/bds_tte.html">Creating a BDS Time-to-Event ADaM</a></li>
    <li><a class="dropdown-item" href="../articles/questionnaires.html">Creating Questionnaire ADaMs</a></li>
    <li><a class="dropdown-item" href="../articles/pk_adnca.html">Creating a PK NCA or Population PK ADaM</a></li>
    <li><a class="dropdown-item" href="../articles/adab.html">Creating an Antidrug Antibody ADaM</a></li>
    <li><a class="dropdown-item" href="../articles/hys_law.html">Hy's Law Implementation</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Special Topics Guides</h6></li>
    <li><a class="dropdown-item" href="../articles/imputation.html">Date and Time Imputation</a></li>
    <li><a class="dropdown-item" href="../articles/visits_periods.html">Visit and Period Variables</a></li>
    <li><a class="dropdown-item" href="../articles/queries_dataset.html">Queries Dataset Documentation</a></li>
    <li><a class="dropdown-item" href="../articles/lab_grading.html">Lab Grading</a></li>
    <li><a class="dropdown-item" href="../articles/estimands.html">Estimands</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><a class="dropdown-item" href="../articles/faq.html">FAQ</a></li>
  </ul>
</li>
<li class="nav-item"><a class="external-link nav-link" href="https://pharmaverse.github.io/admiraldiscovery/articles/reactable.html">ðŸ”Ž Find my function</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      <div><li class="nav-item dropdown">
    <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-versions">Versions</a>
    <div class="dropdown-menu" aria-labelledby="dropdown-versions">
    <a class="dropdown-item" data-toggle="tooltip" title="" href="https://pharmaverse.github.io/admiral/main">main</a>
<a class="dropdown-item" data-toggle="tooltip" title="" href="https://pharmaverse.github.io/admiral/cran-release">cran-release</a>
<a class="dropdown-item" data-toggle="tooltip" title="" href="https://pharmaverse.github.io/admiral/v1.4.1">v1.4.1</a>
<a class="dropdown-item" data-toggle="tooltip" title="" href="https://pharmaverse.github.io/admiral/v1.4.0">v1.4.0</a>
<a class="dropdown-item" data-toggle="tooltip" title="" href="https://pharmaverse.github.io/admiral/v1.3.1">v1.3.1</a>
<a class="dropdown-item" data-toggle="tooltip" title="" href="https://pharmaverse.github.io/admiral/v1.3.0">v1.3.0</a>
<a class="dropdown-item" data-toggle="tooltip" title="" href="https://pharmaverse.github.io/admiral/v1.2.0">v1.2.0</a>
<a class="dropdown-item" data-toggle="tooltip" title="" href="https://pharmaverse.github.io/admiral/v1.1.1">v1.1.1</a>
<a class="dropdown-item" data-toggle="tooltip" title="" href="https://pharmaverse.github.io/admiral/v1.1.0">v1.1.0</a>
<a class="dropdown-item" data-toggle="tooltip" title="" href="https://pharmaverse.github.io/admiral/v1.0.2">v1.0.2</a>
<a class="dropdown-item" data-toggle="tooltip" title="" href="https://pharmaverse.github.io/admiral/v1.0.1">v1.0.1</a>
<a class="dropdown-item" data-toggle="tooltip" title="" href="https://pharmaverse.github.io/admiral/v1.0.0">v1.0.0</a>
</div>
</li></div>
</ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://pharmaverse.slack.com/" aria-label="Join the pharmaverse Slack!"><span class="fa fa-slack"></span></a></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/pharmaverse/admiral/issues/new/choose" aria-label="Report an issue"><span class="fa fa-bug"></span></a></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/pharmaverse/admiral/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-lightswitch" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true" aria-label="Light switch"><span class="fa fa-sun"></span></button>
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdown-lightswitch">
<li><button class="dropdown-item" data-bs-theme-value="light"><span class="fa fa-sun"></span> Light</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="dark"><span class="fa fa-moon"></span> Dark</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="auto"><span class="fa fa-adjust"></span> Auto</button></li>
  </ul>
</li>
      </ul>
</div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Derive Duration</h1>
      <small class="dont-index">Source: <a href="https://github.com/pharmaverse/admiral/blob/main/R/derive_vars_duration.R" class="external-link"><code>R/derive_vars_duration.R</code></a></small>
      <div class="d-none name"><code>derive_vars_duration.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Derives duration between two dates, specified by the variables present in
input dataset e.g., duration of adverse events, relative day, age, ...</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a>
</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">derive_vars_duration</span><span class="op">(</span></span>
<span>  <span class="va">dataset</span>,</span>
<span>  <span class="va">new_var</span>,</span>
<span>  new_var_unit <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">start_date</span>,</span>
<span>  <span class="va">end_date</span>,</span>
<span>  in_unit <span class="op">=</span> <span class="st">"days"</span>,</span>
<span>  out_unit <span class="op">=</span> <span class="st">"DAYS"</span>,</span>
<span>  floor_in <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  add_one <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  trunc_out <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  type <span class="op">=</span> <span class="st">"duration"</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a>
</h2>


<dl>
<dt id="arg-dataset">dataset<a class="anchor" aria-label="anchor" href="#arg-dataset"></a>
</dt>
<dd>
<p>Input dataset</p>
<p>The variables specified by the <code>start_date</code> and <code>end_date</code> arguments are expected to be in the dataset.</p>
<dl>
<dt>Default value</dt>
<dd><p>none</p></dd>


</dl>
</dd>


<dt id="arg-new-var">new_var<a class="anchor" aria-label="anchor" href="#arg-new-var"></a>
</dt>
<dd>
<p>Name of variable to create</p>
<dl>
<dt>Default value</dt>
<dd><p>none</p></dd>


</dl>
</dd>


<dt id="arg-new-var-unit">new_var_unit<a class="anchor" aria-label="anchor" href="#arg-new-var-unit"></a>
</dt>
<dd>
<p>Name of the unit variable If the parameter is not
specified, no variable for the unit is created.</p>
<dl>
<dt>Default value</dt>
<dd><p><code>NULL</code></p></dd>


</dl>
</dd>


<dt id="arg-start-date">start_date<a class="anchor" aria-label="anchor" href="#arg-start-date"></a>
</dt>
<dd>
<p>The start date</p>
<p>A date or date-time object is expected.</p>
<p>Refer to <code><a href="derive_vars_dt.html">derive_vars_dt()</a></code> to impute and derive a date from a date
character vector to a date object.</p>
<p>Refer to <code><a href="convert_dtc_to_dt.html">convert_dtc_to_dt()</a></code> to obtain a vector of imputed dates.</p>
<dl>
<dt>Default value</dt>
<dd><p>none</p></dd>


</dl>
</dd>


<dt id="arg-end-date">end_date<a class="anchor" aria-label="anchor" href="#arg-end-date"></a>
</dt>
<dd>
<p>The end date</p>
<p>A date or date-time object is expected.</p>
<p>Refer to <code><a href="derive_vars_dt.html">derive_vars_dt()</a></code> to impute and derive a date from a date
character vector to a date object.</p>
<p>Refer to <code><a href="convert_dtc_to_dt.html">convert_dtc_to_dt()</a></code> to obtain a vector of imputed dates.</p>
<dl>
<dt>Default value</dt>
<dd><p>none</p></dd>


</dl>
</dd>


<dt id="arg-in-unit">in_unit<a class="anchor" aria-label="anchor" href="#arg-in-unit"></a>
</dt>
<dd>
<p>Input unit</p>
<p>See floor_in and add_one parameter for details.</p>
<p>Permitted Values (case-insensitive):</p>
<p>For years: <code>"year"</code>, <code>"years"</code>, <code>"yr"</code>, <code>"yrs"</code>, <code>"y"</code></p>
<p>For months: <code>"month"</code>, <code>"months"</code>, <code>"mo"</code>, <code>"mos"</code></p>
<p>For days: <code>"day"</code>, <code>"days"</code>, <code>"d"</code></p>
<p>For hours: <code>"hour"</code>, <code>"hours"</code>, <code>"hr"</code>, <code>"hrs"</code>, <code>"h"</code></p>
<p>For minutes: <code>"minute"</code>, <code>"minutes"</code>, <code>"min"</code>, <code>"mins"</code></p>
<p>For seconds: <code>"second"</code>, <code>"seconds"</code>, <code>"sec"</code>, <code>"secs"</code>, <code>"s"</code></p>
<dl>
<dt>Default value</dt>
<dd><p><code>"days"</code></p></dd>


</dl>
</dd>


<dt id="arg-out-unit">out_unit<a class="anchor" aria-label="anchor" href="#arg-out-unit"></a>
</dt>
<dd>
<p>Output unit</p>
<p>The duration is derived in the specified unit</p>
<p>Permitted Values (case-insensitive):</p>
<p>For years: <code>"year"</code>, <code>"years"</code>, <code>"yr"</code>, <code>"yrs"</code>, <code>"y"</code></p>
<p>For months: <code>"month"</code>, <code>"months"</code>, <code>"mo"</code>, <code>"mos"</code></p>
<p>For weeks: <code>"week"</code>, <code>"weeks"</code>, <code>"wk"</code>, <code>"wks"</code>, <code>"w"</code></p>
<p>For days: <code>"day"</code>, <code>"days"</code>, <code>"d"</code></p>
<p>For hours: <code>"hour"</code>, <code>"hours"</code>, <code>"hr"</code>, <code>"hrs"</code>, <code>"h"</code></p>
<p>For minutes: <code>"minute"</code>, <code>"minutes"</code>, <code>"min"</code>, <code>"mins"</code></p>
<p>For seconds: <code>"second"</code>, <code>"seconds"</code>, <code>"sec"</code>, <code>"secs"</code>, <code>"s"</code></p>
<dl>
<dt>Default value</dt>
<dd><p><code>"days"</code></p></dd>


</dl>
</dd>


<dt id="arg-floor-in">floor_in<a class="anchor" aria-label="anchor" href="#arg-floor-in"></a>
</dt>
<dd>
<p>Round down input dates?</p>
<p>The input dates are round down with respect to the input unit, e.g., if the
input unit is 'days', the time of the input dates is ignored.</p>
<dl>
<dt>Permitted values</dt>
<dd><p><code>TRUE</code>, <code>FALSE</code></p></dd>

<dt>Default value</dt>
<dd><p><code>TRUE</code></p></dd>


</dl>
</dd>


<dt id="arg-add-one">add_one<a class="anchor" aria-label="anchor" href="#arg-add-one"></a>
</dt>
<dd>
<p>Add one input unit?</p>
<p>If the duration is non-negative, one input unit is added. i.e., the
duration can not be zero.</p>
<dl>
<dt>Permitted values</dt>
<dd><p><code>TRUE</code>, <code>FALSE</code></p></dd>

<dt>Default value</dt>
<dd><p><code>TRUE</code></p></dd>


</dl>
</dd>


<dt id="arg-trunc-out">trunc_out<a class="anchor" aria-label="anchor" href="#arg-trunc-out"></a>
</dt>
<dd>
<p>Return integer part</p>
<p>The fractional part of the duration (in output unit) is removed, i.e., the
integer part is returned.</p>
<dl>
<dt>Permitted values</dt>
<dd><p><code>TRUE</code>, <code>FALSE</code></p></dd>

<dt>Default value</dt>
<dd><p><code>FALSE</code></p></dd>


</dl>
</dd>


<dt id="arg-type">type<a class="anchor" aria-label="anchor" href="#arg-type"></a>
</dt>
<dd>
<p>lubridate duration type.</p>
<p>See below for details.</p>
<dl>
<dt>Permitted values</dt>
<dd><p><code>"duration"</code>, <code>"interval"</code></p></dd>

<dt>Default value</dt>
<dd><p><code>"duration"</code></p></dd>


</dl>
</dd>

</dl>
</div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a>
</h2>
    <p>The input dataset with the duration and unit variable added</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a>
</h2>
    <p>The duration is derived as time from start to end date in the
specified output unit. If the end date is before the start date, the duration
is negative. The start and end date variable must be present in the specified
input dataset.</p>
<p>The <a href="https://lubridate.tidyverse.org/" class="external-link">lubridate</a> package calculates two
types of spans between two dates: duration and interval.
While these calculations are largely the same, when the unit of the time period
is month or year the result can be slightly different.</p>
<p>The difference arises from the ambiguity in the length of <code>"1 month"</code> or
<code>"1 year"</code>.
Months may have 31, 30, 28, or 29 days, and years are 365 days and 366 during leap years.
Durations and intervals help solve the ambiguity in these measures.</p>
<p>The <strong>interval</strong> between <code>2000-02-01</code> and <code>2000-03-01</code> is <code>1</code> (i.e. one month).
The <strong>duration</strong> between these two dates is <code>0.95</code>, which accounts for the fact
that the year 2000 is a leap year, February has 29 days, and the average month
length is <code>30.4375</code>, i.e. <code>29 / 30.4375 = 0.95</code>.</p>
<p>For additional details, review the
<a href="https://lubridate.tidyverse.org/reference/timespan.html" class="external-link">lubridate time span reference page</a>.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a>
</h2>
    <div class="dont-index">
<p><code><a href="compute_duration.html">compute_duration()</a></code></p>
<p>Date/Time Derivation Functions that returns variable appended to dataset:
<code><a href="derive_var_trtdurd.html">derive_var_trtdurd()</a></code>,
<code><a href="derive_vars_dt.html">derive_vars_dt()</a></code>,
<code><a href="derive_vars_dtm.html">derive_vars_dtm()</a></code>,
<code><a href="derive_vars_dtm_to_dt.html">derive_vars_dtm_to_dt()</a></code>,
<code><a href="derive_vars_dtm_to_tm.html">derive_vars_dtm_to_tm()</a></code>,
<code><a href="derive_vars_dy.html">derive_vars_dy()</a></code></p>
</div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a>
</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://lubridate.tidyverse.org" class="external-link">lubridate</a></span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tibble.tidyverse.org/" class="external-link">tibble</a></span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Derive age in years</span></span></span>
<span class="r-in"><span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tribble.html" class="external-link">tribble</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="op">~</span><span class="va">USUBJID</span>, <span class="op">~</span><span class="va">BRTHDT</span>, <span class="op">~</span><span class="va">RANDDT</span>,</span></span>
<span class="r-in"><span>  <span class="st">"P01"</span>, <span class="fu"><a href="https://lubridate.tidyverse.org/reference/ymd.html" class="external-link">ymd</a></span><span class="op">(</span><span class="st">"1984-09-06"</span><span class="op">)</span>, <span class="fu"><a href="https://lubridate.tidyverse.org/reference/ymd.html" class="external-link">ymd</a></span><span class="op">(</span><span class="st">"2020-02-24"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  <span class="st">"P02"</span>, <span class="fu"><a href="https://lubridate.tidyverse.org/reference/ymd.html" class="external-link">ymd</a></span><span class="op">(</span><span class="st">"1985-01-01"</span><span class="op">)</span>, <span class="cn">NA</span>,</span></span>
<span class="r-in"><span>  <span class="st">"P03"</span>, <span class="cn">NA</span>, <span class="fu"><a href="https://lubridate.tidyverse.org/reference/ymd.html" class="external-link">ymd</a></span><span class="op">(</span><span class="st">"2021-03-10"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  <span class="st">"P04"</span>, <span class="cn">NA</span>, <span class="cn">NA</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">derive_vars_duration</span><span class="op">(</span><span class="va">data</span>,</span></span>
<span class="r-in"><span>  new_var <span class="op">=</span> <span class="va">AAGE</span>,</span></span>
<span class="r-in"><span>  new_var_unit <span class="op">=</span> <span class="va">AAGEU</span>,</span></span>
<span class="r-in"><span>  start_date <span class="op">=</span> <span class="va">BRTHDT</span>,</span></span>
<span class="r-in"><span>  end_date <span class="op">=</span> <span class="va">RANDDT</span>,</span></span>
<span class="r-in"><span>  out_unit <span class="op">=</span> <span class="st">"years"</span>,</span></span>
<span class="r-in"><span>  add_one <span class="op">=</span> <span class="cn">FALSE</span>,</span></span>
<span class="r-in"><span>  trunc_out <span class="op">=</span> <span class="cn">TRUE</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 4 Ã— 5</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   USUBJID BRTHDT     RANDDT      AAGE AAGEU</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;date&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;date&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">1</span> P01     1984-09-06 2020-02-24    35 years</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">2</span> P02     1985-01-01 <span style="color: #BB0000;">NA</span>            <span style="color: #BB0000;">NA</span> <span style="color: #BB0000;">NA</span>   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">3</span> P03     <span style="color: #BB0000;">NA</span>         2021-03-10    <span style="color: #BB0000;">NA</span> <span style="color: #BB0000;">NA</span>   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">4</span> P04     <span style="color: #BB0000;">NA</span>         <span style="color: #BB0000;">NA</span>            <span style="color: #BB0000;">NA</span> <span style="color: #BB0000;">NA</span>   </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Derive adverse event duration in days</span></span></span>
<span class="r-in"><span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tribble.html" class="external-link">tribble</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="op">~</span><span class="va">USUBJID</span>, <span class="op">~</span><span class="va">ASTDT</span>, <span class="op">~</span><span class="va">AENDT</span>,</span></span>
<span class="r-in"><span>  <span class="st">"P01"</span>, <span class="fu"><a href="https://lubridate.tidyverse.org/reference/ymd.html" class="external-link">ymd</a></span><span class="op">(</span><span class="st">"2021-03-05"</span><span class="op">)</span>, <span class="fu"><a href="https://lubridate.tidyverse.org/reference/ymd.html" class="external-link">ymd</a></span><span class="op">(</span><span class="st">"2021-03-02"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  <span class="st">"P02"</span>, <span class="fu"><a href="https://lubridate.tidyverse.org/reference/ymd.html" class="external-link">ymd</a></span><span class="op">(</span><span class="st">"2019-09-18"</span><span class="op">)</span>, <span class="fu"><a href="https://lubridate.tidyverse.org/reference/ymd.html" class="external-link">ymd</a></span><span class="op">(</span><span class="st">"2019-09-18"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  <span class="st">"P03"</span>, <span class="fu"><a href="https://lubridate.tidyverse.org/reference/ymd.html" class="external-link">ymd</a></span><span class="op">(</span><span class="st">"1985-01-01"</span><span class="op">)</span>, <span class="cn">NA</span>,</span></span>
<span class="r-in"><span>  <span class="st">"P04"</span>, <span class="cn">NA</span>, <span class="cn">NA</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">derive_vars_duration</span><span class="op">(</span><span class="va">data</span>,</span></span>
<span class="r-in"><span>  new_var <span class="op">=</span> <span class="va">ADURN</span>,</span></span>
<span class="r-in"><span>  new_var_unit <span class="op">=</span> <span class="va">ADURU</span>,</span></span>
<span class="r-in"><span>  start_date <span class="op">=</span> <span class="va">ASTDT</span>,</span></span>
<span class="r-in"><span>  end_date <span class="op">=</span> <span class="va">AENDT</span>,</span></span>
<span class="r-in"><span>  out_unit <span class="op">=</span> <span class="st">"days"</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 4 Ã— 5</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   USUBJID ASTDT      AENDT      ADURN ADURU</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;date&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;date&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">1</span> P01     2021-03-05 2021-03-02    -<span style="color: #BB0000;">3</span> days </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">2</span> P02     2019-09-18 2019-09-18     1 days </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">3</span> P03     1985-01-01 <span style="color: #BB0000;">NA</span>            <span style="color: #BB0000;">NA</span> <span style="color: #BB0000;">NA</span>   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">4</span> P04     <span style="color: #BB0000;">NA</span>         <span style="color: #BB0000;">NA</span>            <span style="color: #BB0000;">NA</span> <span style="color: #BB0000;">NA</span>   </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Derive adverse event duration in minutes</span></span></span>
<span class="r-in"><span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tribble.html" class="external-link">tribble</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="op">~</span><span class="va">USUBJID</span>, <span class="op">~</span><span class="va">ADTM</span>, <span class="op">~</span><span class="va">TRTSDTM</span>,</span></span>
<span class="r-in"><span>  <span class="st">"P01"</span>, <span class="fu"><a href="https://lubridate.tidyverse.org/reference/ymd_hms.html" class="external-link">ymd_hms</a></span><span class="op">(</span><span class="st">"2019-08-09T04:30:56"</span><span class="op">)</span>, <span class="fu"><a href="https://lubridate.tidyverse.org/reference/ymd_hms.html" class="external-link">ymd_hms</a></span><span class="op">(</span><span class="st">"2019-08-09T05:00:00"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  <span class="st">"P02"</span>, <span class="fu"><a href="https://lubridate.tidyverse.org/reference/ymd_hms.html" class="external-link">ymd_hms</a></span><span class="op">(</span><span class="st">"2019-11-11T10:30:00"</span><span class="op">)</span>, <span class="fu"><a href="https://lubridate.tidyverse.org/reference/ymd_hms.html" class="external-link">ymd_hms</a></span><span class="op">(</span><span class="st">"2019-11-11T11:30:00"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  <span class="st">"P03"</span>, <span class="fu"><a href="https://lubridate.tidyverse.org/reference/ymd_hms.html" class="external-link">ymd_hms</a></span><span class="op">(</span><span class="st">"2019-11-11T00:00:00"</span><span class="op">)</span>, <span class="fu"><a href="https://lubridate.tidyverse.org/reference/ymd_hms.html" class="external-link">ymd_hms</a></span><span class="op">(</span><span class="st">"2019-11-11T04:00:00"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  <span class="st">"P04"</span>, <span class="cn">NA</span>, <span class="fu"><a href="https://lubridate.tidyverse.org/reference/ymd_hms.html" class="external-link">ymd_hms</a></span><span class="op">(</span><span class="st">"2019-11-11T12:34:56"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">derive_vars_duration</span><span class="op">(</span><span class="va">data</span>,</span></span>
<span class="r-in"><span>  new_var <span class="op">=</span> <span class="va">ADURN</span>,</span></span>
<span class="r-in"><span>  new_var_unit <span class="op">=</span> <span class="va">ADURU</span>,</span></span>
<span class="r-in"><span>  start_date <span class="op">=</span> <span class="va">ADTM</span>,</span></span>
<span class="r-in"><span>  end_date <span class="op">=</span> <span class="va">TRTSDTM</span>,</span></span>
<span class="r-in"><span>  in_unit <span class="op">=</span> <span class="st">"minutes"</span>,</span></span>
<span class="r-in"><span>  out_unit <span class="op">=</span> <span class="st">"minutes"</span>,</span></span>
<span class="r-in"><span>  add_one <span class="op">=</span> <span class="cn">FALSE</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 4 Ã— 5</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   USUBJID ADTM                TRTSDTM             ADURN ADURU  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dttm&gt;</span>              <span style="color: #949494; font-style: italic;">&lt;dttm&gt;</span>              <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">1</span> P01     2019-08-09 <span style="color: #949494;">04:30:56</span> 2019-08-09 <span style="color: #949494;">05:00:00</span>    30 minutes</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">2</span> P02     2019-11-11 <span style="color: #949494;">10:30:00</span> 2019-11-11 <span style="color: #949494;">11:30:00</span>    60 minutes</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">3</span> P03     2019-11-11 <span style="color: #949494;">00:00:00</span> 2019-11-11 <span style="color: #949494;">04:00:00</span>   240 minutes</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">4</span> P04     <span style="color: #BB0000;">NA</span>                  2019-11-11 <span style="color: #949494;">12:34:56</span>    <span style="color: #BB0000;">NA</span> <span style="color: #BB0000;">NA</span>     </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Derive adverse event start time since last dose in hours</span></span></span>
<span class="r-in"><span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tribble.html" class="external-link">tribble</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="op">~</span><span class="va">USUBJID</span>, <span class="op">~</span><span class="va">ASTDTM</span>, <span class="op">~</span><span class="va">LDOSEDTM</span>,</span></span>
<span class="r-in"><span>  <span class="st">"P01"</span>, <span class="fu"><a href="https://lubridate.tidyverse.org/reference/ymd_hms.html" class="external-link">ymd_hms</a></span><span class="op">(</span><span class="st">"2019-08-09T04:30:56"</span><span class="op">)</span>, <span class="fu"><a href="https://lubridate.tidyverse.org/reference/ymd_hms.html" class="external-link">ymd_hms</a></span><span class="op">(</span><span class="st">"2019-08-08T10:05:00"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  <span class="st">"P02"</span>, <span class="fu"><a href="https://lubridate.tidyverse.org/reference/ymd_hms.html" class="external-link">ymd_hms</a></span><span class="op">(</span><span class="st">"2019-11-11T23:59:59"</span><span class="op">)</span>, <span class="fu"><a href="https://lubridate.tidyverse.org/reference/ymd_hms.html" class="external-link">ymd_hms</a></span><span class="op">(</span><span class="st">"2019-10-11T11:37:00"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  <span class="st">"P03"</span>, <span class="fu"><a href="https://lubridate.tidyverse.org/reference/ymd_hms.html" class="external-link">ymd_hms</a></span><span class="op">(</span><span class="st">"2019-11-11T00:00:00"</span><span class="op">)</span>, <span class="fu"><a href="https://lubridate.tidyverse.org/reference/ymd_hms.html" class="external-link">ymd_hms</a></span><span class="op">(</span><span class="st">"2019-11-10T23:59:59"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  <span class="st">"P04"</span>, <span class="fu"><a href="https://lubridate.tidyverse.org/reference/ymd_hms.html" class="external-link">ymd_hms</a></span><span class="op">(</span><span class="st">"2019-11-11T12:34:56"</span><span class="op">)</span>, <span class="cn">NA</span>,</span></span>
<span class="r-in"><span>  <span class="st">"P05"</span>, <span class="cn">NA</span>, <span class="fu"><a href="https://lubridate.tidyverse.org/reference/ymd_hms.html" class="external-link">ymd_hms</a></span><span class="op">(</span><span class="st">"2019-09-28T12:34:56"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">derive_vars_duration</span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="va">data</span>,</span></span>
<span class="r-in"><span>  new_var <span class="op">=</span> <span class="va">LDRELTM</span>,</span></span>
<span class="r-in"><span>  new_var_unit <span class="op">=</span> <span class="va">LDRELTMU</span>,</span></span>
<span class="r-in"><span>  start_date <span class="op">=</span> <span class="va">LDOSEDTM</span>,</span></span>
<span class="r-in"><span>  end_date <span class="op">=</span> <span class="va">ASTDTM</span>,</span></span>
<span class="r-in"><span>  in_unit <span class="op">=</span> <span class="st">"hours"</span>,</span></span>
<span class="r-in"><span>  out_unit <span class="op">=</span> <span class="st">"hours"</span>,</span></span>
<span class="r-in"><span>  add_one <span class="op">=</span> <span class="cn">FALSE</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 5 Ã— 5</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   USUBJID ASTDTM              LDOSEDTM            LDRELTM LDRELTMU</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dttm&gt;</span>              <span style="color: #949494; font-style: italic;">&lt;dttm&gt;</span>                <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">1</span> P01     2019-08-09 <span style="color: #949494;">04:30:56</span> 2019-08-08 <span style="color: #949494;">10:05:00</span>      18 hours   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">2</span> P02     2019-11-11 <span style="color: #949494;">23:59:59</span> 2019-10-11 <span style="color: #949494;">11:37:00</span>     756 hours   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">3</span> P03     2019-11-11 <span style="color: #949494;">00:00:00</span> 2019-11-10 <span style="color: #949494;">23:59:59</span>       1 hours   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">4</span> P04     2019-11-11 <span style="color: #949494;">12:34:56</span> <span style="color: #BB0000;">NA</span>                       <span style="color: #BB0000;">NA</span> <span style="color: #BB0000;">NA</span>      </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">5</span> P05     <span style="color: #BB0000;">NA</span>                  2019-09-28 <span style="color: #949494;">12:34:56</span>      <span style="color: #BB0000;">NA</span> <span style="color: #BB0000;">NA</span>      </span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by F. Hoffmann-La Roche AG, GlaxoSmithKline LLC, Ben Straub, Stefan Bundfuss, Matt Bearham, Arianna Cascone, Kristin Dahnert, Jeffrey Dickinson, Ross Farrugia, Fanny Gautier, Edoardo Mancini, Gordon Miller, Lina Patil, Jim Rothstein.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
