<!DOCTYPE html>
<!-- Generated by pkgdown + https://github.com/insightsengineering/r-pkgdown-multiversion -->
<html lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Add a Variable Flagging the First or Last Observation Within Each By Group â€” derive_var_extreme_flag â€¢ admiral</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png">
<link rel="icon" type="â€image/svg+xmlâ€" href="../favicon.svg">
<link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png">
<link rel="icon" sizes="any" href="../favicon.ico">
<link rel="manifest" href="../site.webmanifest">
<!-- mathjax math --><script src="https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-mml-chtml.js" integrity="sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI=" crossorigin="anonymous"></script><script>
  window.MathJax = {
    chtml: {
      fontURL: "https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/output/chtml/fonts/woff-v2"
    }
  };
</script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Add a Variable Flagging the First or Last Observation Within Each By Group â€” derive_var_extreme_flag">
<meta name="description" content="Add a variable flagging the first or last observation within each by group">
<meta property="og:description" content="Add a variable flagging the first or last observation within each by group">
<meta property="og:image" content="https://pharmaverse.github.io/admiral/logo.png">
<meta name="robots" content="noindex">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">admiral</a>

    <small class="nav-text text-default me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="In-development version">1.2.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-get-started" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Get Started</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-get-started">
<li><a class="dropdown-item" href="../articles/admiral.html">Get Started</a></li>
    <li><a class="external-link dropdown-item" href="https://github.com/pharmaverse/admiral/blob/main/inst/cheatsheet/admiral_cheatsheet.pdf">Cheatsheet</a></li>
    <li><a class="dropdown-item" href="https://pharmaverse.github.io/admiraldiscovery/articles/presentation_archive.html">Presentation Archive</a></li>
  </ul>
</li>
<li class="active nav-item"><a class="nav-link" href="../reference/">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-user-guides" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">User Guides</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-user-guides">
<li><h6 class="dropdown-header" data-toc-skip>General Guides</h6></li>
    <li><a class="dropdown-item" href="../articles/concepts_conventions.html">Programming Concepts and Conventions</a></li>
    <li><a class="dropdown-item" href="../articles/generic.html">Generic Derivations</a></li>
    <li><a class="dropdown-item" href="../articles/higher_order.html">Higher Order Functions</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>ADaM Script Guides</h6></li>
    <li><a class="dropdown-item" href="../articles/adsl.html">Creating a Basic ADSL</a></li>
    <li><a class="dropdown-item" href="../articles/occds.html">Creating an OCCDS ADaM</a></li>
    <li><a class="dropdown-item" href="../articles/bds_finding.html">Creating a BDS Findings ADAM</a></li>
    <li><a class="dropdown-item" href="../articles/bds_exposure.html">Creating a BDS Exposure ADaM</a></li>
    <li><a class="dropdown-item" href="../articles/bds_tte.html">Creating a BDS Time-to-Event ADaM</a></li>
    <li><a class="dropdown-item" href="../articles/questionnaires.html">Creating Questionnaire ADaMs</a></li>
    <li><a class="dropdown-item" href="../articles/pk_adnca.html">Creating a PK NCA or Population PK ADaM</a></li>
    <li><a class="dropdown-item" href="../articles/hys_law.html">Hy's Law Implementation</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Special Topics Guides</h6></li>
    <li><a class="dropdown-item" href="../articles/imputation.html">Date and Time Imputation</a></li>
    <li><a class="dropdown-item" href="../articles/visits_periods.html">Visit and Period Variables</a></li>
    <li><a class="dropdown-item" href="../articles/queries_dataset.html">Queries Dataset Documentation</a></li>
    <li><a class="dropdown-item" href="../articles/lab_grading.html">Lab Grading</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><a class="dropdown-item" href="../articles/faq.html">FAQ</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="https://pharmaverse.github.io/admiraldiscovery/articles/reactable.html">ðŸ”Ž Find my function</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      <div><li class="nav-item dropdown">
    <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-versions">Versions</a>
    <div class="dropdown-menu" aria-labelledby="dropdown-versions">
    <a class="dropdown-item" data-toggle="tooltip" title="" href="https://pharmaverse.github.io/admiral/v1.3.1-fix">v1.3.1-fix</a>
<a class="dropdown-item" data-toggle="tooltip" title="" href="https://pharmaverse.github.io/admiral/main">main</a>
<a class="dropdown-item" data-toggle="tooltip" title="" href="https://pharmaverse.github.io/admiral/cran-release">cran-release</a>
<a class="dropdown-item" data-toggle="tooltip" title="" href="https://pharmaverse.github.io/admiral/v1.3.1">v1.3.1</a>
<a class="dropdown-item" data-toggle="tooltip" title="" href="https://pharmaverse.github.io/admiral/v1.3.0">v1.3.0</a>
<a class="dropdown-item" data-toggle="tooltip" title="" href="https://pharmaverse.github.io/admiral/v1.2.0">v1.2.0</a>
<a class="dropdown-item" data-toggle="tooltip" title="" href="https://pharmaverse.github.io/admiral/v1.1.1">v1.1.1</a>
<a class="dropdown-item" data-toggle="tooltip" title="" href="https://pharmaverse.github.io/admiral/v1.1.0">v1.1.0</a>
<a class="dropdown-item" data-toggle="tooltip" title="" href="https://pharmaverse.github.io/admiral/v1.0.2">v1.0.2</a>
<a class="dropdown-item" data-toggle="tooltip" title="" href="https://pharmaverse.github.io/admiral/v1.0.1">v1.0.1</a>
<a class="dropdown-item" data-toggle="tooltip" title="" href="https://pharmaverse.github.io/admiral/v1.0.0">v1.0.0</a>
</div>
</li></div>
</ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://pharmaverse.slack.com/" aria-label="Slack"><span class="fa fa-slack"></span></a></li>
<li class="nav-item"><a class="nav-link" href="../articles/website-versions.html" aria-label="Previous Release Websites"><span class="fa fa-history"></span></a></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/pharmaverse/admiral/issues/new/choose" aria-label="New Issue"><span class="fa fa-bug"></span></a></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/pharmaverse/admiral/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Add a Variable Flagging the First or Last Observation Within Each By Group</h1>
      <small class="dont-index">Source: <a href="https://github.com/pharmaverse/admiral/blob/main/R/derive_var_extreme_flag.R" class="external-link"><code>R/derive_var_extreme_flag.R</code></a></small>
      <div class="d-none name"><code>derive_var_extreme_flag.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Add a variable flagging the first or last observation within each by group</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a>
</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">derive_var_extreme_flag</span><span class="op">(</span></span>
<span>  <span class="va">dataset</span>,</span>
<span>  <span class="va">by_vars</span>,</span>
<span>  <span class="va">order</span>,</span>
<span>  <span class="va">new_var</span>,</span>
<span>  <span class="va">mode</span>,</span>
<span>  true_value <span class="op">=</span> <span class="st">"Y"</span>,</span>
<span>  false_value <span class="op">=</span> <span class="cn">NA_character_</span>,</span>
<span>  flag_all <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  check_type <span class="op">=</span> <span class="st">"warning"</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a>
</h2>


<dl>
<dt id="arg-dataset">dataset<a class="anchor" aria-label="anchor" href="#arg-dataset"></a>
</dt>
<dd>
<p>Input dataset</p>
<p>The variables specified by the <code>by_vars</code> argument are expected to be in the dataset.</p>
</dd>


<dt id="arg-by-vars">by_vars<a class="anchor" aria-label="anchor" href="#arg-by-vars"></a>
</dt>
<dd>
<p>Grouping variables</p>
<p><em>Permitted Values</em>: list of variables created by <code><a href="reexport-exprs.html">exprs()</a></code>
e.g. <code>exprs(USUBJID, VISIT)</code></p>
</dd>


<dt id="arg-order">order<a class="anchor" aria-label="anchor" href="#arg-order"></a>
</dt>
<dd>
<p>Sort order</p>
<p>The first or last observation is determined with respect to the specified
order.</p>
<p>For handling of <code>NA</code>s in sorting variables see <a href="../articles/generic.html#sort_order">Sort Order</a>.</p>
<p>Permitted Values: list of variables or functions of variables</p>
</dd>


<dt id="arg-new-var">new_var<a class="anchor" aria-label="anchor" href="#arg-new-var"></a>
</dt>
<dd>
<p>Variable to add</p>
<p>The specified variable is added to the output dataset. It is set to the value
set in <code>true_value</code> for the first or last observation (depending on the mode) of each by group.</p>
<p>Permitted Values: list of name-value pairs</p>
</dd>


<dt id="arg-mode">mode<a class="anchor" aria-label="anchor" href="#arg-mode"></a>
</dt>
<dd>
<p>Flag mode</p>
<p>Determines of the first or last observation is flagged.</p>
<p>Permitted Values: <code>"first"</code>, <code>"last"</code></p>
</dd>


<dt id="arg-true-value">true_value<a class="anchor" aria-label="anchor" href="#arg-true-value"></a>
</dt>
<dd>
<p>True value</p>
<p>The value for the specified variable <code>new_var</code>, applicable to
the first or last observation (depending on the mode) of each by group.</p>
<p>Permitted Values: An atomic scalar</p>
</dd>


<dt id="arg-false-value">false_value<a class="anchor" aria-label="anchor" href="#arg-false-value"></a>
</dt>
<dd>
<p>False value</p>
<p>The value for the specified variable <code>new_var</code>, NOT applicable to
the first or last observation (depending on the mode) of each by group.</p>
<p>Permitted Values: An atomic scalar</p>
</dd>


<dt id="arg-flag-all">flag_all<a class="anchor" aria-label="anchor" href="#arg-flag-all"></a>
</dt>
<dd>
<p>Flag setting</p>
<p>A logical value where if set to <code>TRUE</code>, all records are flagged
and no error or warning is issued if the first or last record is not unique.</p>
</dd>


<dt id="arg-check-type">check_type<a class="anchor" aria-label="anchor" href="#arg-check-type"></a>
</dt>
<dd>
<p>Check uniqueness?</p>
<p>If <code>"warning"</code> or <code>"error"</code> is specified, the specified message is issued
if the observations of the input dataset are not unique with respect to the
by variables and the order.</p>
<p>Default: <code>"warning"</code></p>
<p>Permitted Values: <code>"none"</code>, <code>"warning"</code>, <code>"error"</code></p>
</dd>

</dl>
</div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a>
</h2>
    <p>The input dataset with the new flag variable added</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a>
</h2>
    <p>For each group (with respect to the variables specified for the
<code>by_vars</code> parameter), <code>new_var</code> is set to <code>"Y"</code> for the first or last observation
(with respect to the order specified for the <code>order</code> parameter and the flag mode
specified for the <code>mode</code> parameter). In the case where the user wants to flag multiple records
of a grouping, for example records that all happen on the same visit and time, the argument
<code>flag_all</code> can be set to <code>TRUE</code>.
Otherwise, <code>new_var</code> is set to <code>NA</code>. Thus, the direction of "worst" is considered fixed for
all parameters in the dataset depending on the <code>order</code> and the <code>mode</code>, i.e. for every
parameter the first or last record will be flagged across the whole dataset.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a>
</h2>
    <div class="dont-index"><p>General Derivation Functions for all ADaMs that returns variable appended to dataset:
<code><a href="derive_var_joined_exist_flag.html">derive_var_joined_exist_flag</a>()</code>,
<code><a href="derive_var_merged_ef_msrc.html">derive_var_merged_ef_msrc</a>()</code>,
<code><a href="derive_var_merged_exist_flag.html">derive_var_merged_exist_flag</a>()</code>,
<code><a href="derive_var_merged_summary.html">derive_var_merged_summary</a>()</code>,
<code><a href="derive_var_obs_number.html">derive_var_obs_number</a>()</code>,
<code><a href="derive_var_relative_flag.html">derive_var_relative_flag</a>()</code>,
<code><a href="derive_vars_cat.html">derive_vars_cat</a>()</code>,
<code><a href="derive_vars_computed.html">derive_vars_computed</a>()</code>,
<code><a href="derive_vars_joined.html">derive_vars_joined</a>()</code>,
<code><a href="derive_vars_merged.html">derive_vars_merged</a>()</code>,
<code><a href="derive_vars_merged_lookup.html">derive_vars_merged_lookup</a>()</code>,
<code><a href="derive_vars_transposed.html">derive_vars_transposed</a>()</code></p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a>
</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tibble.tidyverse.org/" class="external-link">tibble</a></span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span>, warn.conflicts <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">example_vs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tribble.html" class="external-link">tribble</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="op">~</span><span class="va">USUBJID</span>, <span class="op">~</span><span class="va">VSTESTCD</span>,      <span class="op">~</span><span class="va">VISIT</span>, <span class="op">~</span><span class="va">VISITNUM</span>, <span class="op">~</span><span class="va">VSTPTNUM</span>, <span class="op">~</span><span class="va">VSSTRESN</span>,</span></span>
<span class="r-in"><span>  <span class="st">"1001"</span>,     <span class="st">"DIABP"</span>, <span class="st">"SCREENING"</span>,         <span class="fl">1</span>,        <span class="fl">10</span>,        <span class="fl">64</span>,</span></span>
<span class="r-in"><span>  <span class="st">"1001"</span>,     <span class="st">"DIABP"</span>, <span class="st">"SCREENING"</span>,         <span class="fl">1</span>,        <span class="fl">11</span>,        <span class="fl">66</span>,</span></span>
<span class="r-in"><span>  <span class="st">"1001"</span>,     <span class="st">"DIABP"</span>,  <span class="st">"BASELINE"</span>,         <span class="fl">2</span>,       <span class="fl">100</span>,        <span class="fl">68</span>,</span></span>
<span class="r-in"><span>  <span class="st">"1001"</span>,     <span class="st">"DIABP"</span>,  <span class="st">"BASELINE"</span>,         <span class="fl">2</span>,       <span class="fl">101</span>,        <span class="fl">68</span>,</span></span>
<span class="r-in"><span>  <span class="st">"1001"</span>,     <span class="st">"DIABP"</span>,    <span class="st">"WEEK 2"</span>,         <span class="fl">3</span>,       <span class="fl">200</span>,        <span class="fl">72</span>,</span></span>
<span class="r-in"><span>  <span class="st">"1001"</span>,     <span class="st">"DIABP"</span>,    <span class="st">"WEEK 2"</span>,         <span class="fl">3</span>,       <span class="fl">201</span>,        <span class="fl">71</span>,</span></span>
<span class="r-in"><span>  <span class="st">"1001"</span>,     <span class="st">"DIABP"</span>,    <span class="st">"WEEK 4"</span>,         <span class="fl">4</span>,       <span class="fl">300</span>,        <span class="fl">70</span>,</span></span>
<span class="r-in"><span>  <span class="st">"1001"</span>,     <span class="st">"DIABP"</span>,    <span class="st">"WEEK 4"</span>,         <span class="fl">4</span>,       <span class="fl">301</span>,        <span class="fl">70</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Flag last value for each patient, test, and visit, baseline observations are ignored</span></span></span>
<span class="r-in"><span><span class="va">example_vs</span> <span class="op"><a href="pipe.html">%&gt;%</a></span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="restrict_derivation.html">restrict_derivation</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    derivation <span class="op">=</span> <span class="va">derive_var_extreme_flag</span>,</span></span>
<span class="r-in"><span>    args <span class="op">=</span> <span class="fu"><a href="params.html">params</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>      by_vars <span class="op">=</span> <span class="fu"><a href="reexport-exprs.html">exprs</a></span><span class="op">(</span><span class="va">USUBJID</span>, <span class="va">VSTESTCD</span>, <span class="va">VISIT</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>      order <span class="op">=</span> <span class="fu"><a href="reexport-exprs.html">exprs</a></span><span class="op">(</span><span class="va">VSTPTNUM</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>      new_var <span class="op">=</span> <span class="va">LASTFL</span>,</span></span>
<span class="r-in"><span>      mode <span class="op">=</span> <span class="st">"last"</span></span></span>
<span class="r-in"><span>    <span class="op">)</span>,</span></span>
<span class="r-in"><span>    filter <span class="op">=</span> <span class="va">VISIT</span> <span class="op">!=</span> <span class="st">"BASELINE"</span></span></span>
<span class="r-in"><span>  <span class="op">)</span> <span class="op"><a href="pipe.html">%&gt;%</a></span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html" class="external-link">arrange</a></span><span class="op">(</span><span class="va">USUBJID</span>, <span class="va">VSTESTCD</span>, <span class="va">VISITNUM</span>, <span class="va">VSTPTNUM</span><span class="op">)</span> <span class="op"><a href="pipe.html">%&gt;%</a></span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">USUBJID</span>, <span class="va">VSTESTCD</span>, <span class="va">VISIT</span>, <span class="va">VSTPTNUM</span>, <span class="va">VSSTRESN</span>, <span class="va">LASTFL</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 8 Ã— 6</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   USUBJID VSTESTCD VISIT     VSTPTNUM VSSTRESN LASTFL</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">1</span> 1001    DIABP    SCREENING       10       64 <span style="color: #BB0000;">NA</span>    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">2</span> 1001    DIABP    SCREENING       11       66 Y     </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">3</span> 1001    DIABP    BASELINE       100       68 <span style="color: #BB0000;">NA</span>    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">4</span> 1001    DIABP    BASELINE       101       68 <span style="color: #BB0000;">NA</span>    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">5</span> 1001    DIABP    WEEK 2         200       72 <span style="color: #BB0000;">NA</span>    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">6</span> 1001    DIABP    WEEK 2         201       71 Y     </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">7</span> 1001    DIABP    WEEK 4         300       70 <span style="color: #BB0000;">NA</span>    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">8</span> 1001    DIABP    WEEK 4         301       70 Y     </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Baseline (ABLFL) examples:</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">input</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tribble.html" class="external-link">tribble</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="op">~</span><span class="va">STUDYID</span>, <span class="op">~</span><span class="va">USUBJID</span>,  <span class="op">~</span><span class="va">PARAMCD</span>,     <span class="op">~</span><span class="va">AVISIT</span>,                  <span class="op">~</span><span class="va">ADT</span>, <span class="op">~</span><span class="va">AVAL</span>,    <span class="op">~</span><span class="va">DTYPE</span>,</span></span>
<span class="r-in"><span>  <span class="st">"TEST01"</span>,  <span class="st">"PAT01"</span>, <span class="st">"PARAM01"</span>,  <span class="st">"BASELINE"</span>, <span class="fu"><a href="https://rdrr.io/r/base/as.Date.html" class="external-link">as.Date</a></span><span class="op">(</span><span class="st">"2021-04-27"</span><span class="op">)</span>,  <span class="fl">15.0</span>,        <span class="cn">NA</span>,</span></span>
<span class="r-in"><span>  <span class="st">"TEST01"</span>,  <span class="st">"PAT01"</span>, <span class="st">"PARAM01"</span>,  <span class="st">"BASELINE"</span>, <span class="fu"><a href="https://rdrr.io/r/base/as.Date.html" class="external-link">as.Date</a></span><span class="op">(</span><span class="st">"2021-04-25"</span><span class="op">)</span>,  <span class="fl">14.0</span>,        <span class="cn">NA</span>,</span></span>
<span class="r-in"><span>  <span class="st">"TEST01"</span>,  <span class="st">"PAT01"</span>, <span class="st">"PARAM01"</span>,  <span class="st">"BASELINE"</span>, <span class="fu"><a href="https://rdrr.io/r/base/as.Date.html" class="external-link">as.Date</a></span><span class="op">(</span><span class="st">"2021-04-23"</span><span class="op">)</span>,  <span class="fl">15.0</span>, <span class="st">"AVERAGE"</span>,</span></span>
<span class="r-in"><span>  <span class="st">"TEST01"</span>,  <span class="st">"PAT01"</span>, <span class="st">"PARAM01"</span>,    <span class="st">"WEEK 1"</span>, <span class="fu"><a href="https://rdrr.io/r/base/as.Date.html" class="external-link">as.Date</a></span><span class="op">(</span><span class="st">"2021-04-27"</span><span class="op">)</span>,  <span class="fl">10.0</span>, <span class="st">"AVERAGE"</span>,</span></span>
<span class="r-in"><span>  <span class="st">"TEST01"</span>,  <span class="st">"PAT01"</span>, <span class="st">"PARAM01"</span>,    <span class="st">"WEEK 2"</span>, <span class="fu"><a href="https://rdrr.io/r/base/as.Date.html" class="external-link">as.Date</a></span><span class="op">(</span><span class="st">"2021-04-30"</span><span class="op">)</span>,  <span class="fl">12.0</span>,        <span class="cn">NA</span>,</span></span>
<span class="r-in"><span>  <span class="st">"TEST01"</span>,  <span class="st">"PAT02"</span>, <span class="st">"PARAM01"</span>, <span class="st">"SCREENING"</span>, <span class="fu"><a href="https://rdrr.io/r/base/as.Date.html" class="external-link">as.Date</a></span><span class="op">(</span><span class="st">"2021-04-27"</span><span class="op">)</span>,  <span class="fl">15.0</span>, <span class="st">"AVERAGE"</span>,</span></span>
<span class="r-in"><span>  <span class="st">"TEST01"</span>,  <span class="st">"PAT02"</span>, <span class="st">"PARAM01"</span>,  <span class="st">"BASELINE"</span>, <span class="fu"><a href="https://rdrr.io/r/base/as.Date.html" class="external-link">as.Date</a></span><span class="op">(</span><span class="st">"2021-04-25"</span><span class="op">)</span>,  <span class="fl">14.0</span>, <span class="st">"AVERAGE"</span>,</span></span>
<span class="r-in"><span>  <span class="st">"TEST01"</span>,  <span class="st">"PAT02"</span>, <span class="st">"PARAM01"</span>,  <span class="st">"BASELINE"</span>, <span class="fu"><a href="https://rdrr.io/r/base/as.Date.html" class="external-link">as.Date</a></span><span class="op">(</span><span class="st">"2021-04-23"</span><span class="op">)</span>,  <span class="fl">15.0</span>, <span class="st">"AVERAGE"</span>,</span></span>
<span class="r-in"><span>  <span class="st">"TEST01"</span>,  <span class="st">"PAT02"</span>, <span class="st">"PARAM01"</span>,    <span class="st">"WEEK 1"</span>, <span class="fu"><a href="https://rdrr.io/r/base/as.Date.html" class="external-link">as.Date</a></span><span class="op">(</span><span class="st">"2021-04-27"</span><span class="op">)</span>,  <span class="fl">10.0</span>, <span class="st">"AVERAGE"</span>,</span></span>
<span class="r-in"><span>  <span class="st">"TEST01"</span>,  <span class="st">"PAT02"</span>, <span class="st">"PARAM01"</span>,    <span class="st">"WEEK 2"</span>, <span class="fu"><a href="https://rdrr.io/r/base/as.Date.html" class="external-link">as.Date</a></span><span class="op">(</span><span class="st">"2021-04-30"</span><span class="op">)</span>,  <span class="fl">12.0</span>, <span class="st">"AVERAGE"</span>,</span></span>
<span class="r-in"><span>  <span class="st">"TEST01"</span>,  <span class="st">"PAT01"</span>, <span class="st">"PARAM02"</span>, <span class="st">"SCREENING"</span>, <span class="fu"><a href="https://rdrr.io/r/base/as.Date.html" class="external-link">as.Date</a></span><span class="op">(</span><span class="st">"2021-04-27"</span><span class="op">)</span>,  <span class="fl">15.0</span>, <span class="st">"AVERAGE"</span>,</span></span>
<span class="r-in"><span>  <span class="st">"TEST01"</span>,  <span class="st">"PAT01"</span>, <span class="st">"PARAM02"</span>, <span class="st">"SCREENING"</span>, <span class="fu"><a href="https://rdrr.io/r/base/as.Date.html" class="external-link">as.Date</a></span><span class="op">(</span><span class="st">"2021-04-25"</span><span class="op">)</span>,  <span class="fl">14.0</span>, <span class="st">"AVERAGE"</span>,</span></span>
<span class="r-in"><span>  <span class="st">"TEST01"</span>,  <span class="st">"PAT01"</span>, <span class="st">"PARAM02"</span>, <span class="st">"SCREENING"</span>, <span class="fu"><a href="https://rdrr.io/r/base/as.Date.html" class="external-link">as.Date</a></span><span class="op">(</span><span class="st">"2021-04-23"</span><span class="op">)</span>,  <span class="fl">15.0</span>,        <span class="cn">NA</span>,</span></span>
<span class="r-in"><span>  <span class="st">"TEST01"</span>,  <span class="st">"PAT01"</span>, <span class="st">"PARAM02"</span>,  <span class="st">"BASELINE"</span>, <span class="fu"><a href="https://rdrr.io/r/base/as.Date.html" class="external-link">as.Date</a></span><span class="op">(</span><span class="st">"2021-04-27"</span><span class="op">)</span>,  <span class="fl">10.0</span>, <span class="st">"AVERAGE"</span>,</span></span>
<span class="r-in"><span>  <span class="st">"TEST01"</span>,  <span class="st">"PAT01"</span>, <span class="st">"PARAM02"</span>,    <span class="st">"WEEK 2"</span>, <span class="fu"><a href="https://rdrr.io/r/base/as.Date.html" class="external-link">as.Date</a></span><span class="op">(</span><span class="st">"2021-04-30"</span><span class="op">)</span>,  <span class="fl">12.0</span>,        <span class="cn">NA</span>,</span></span>
<span class="r-in"><span>  <span class="st">"TEST01"</span>,  <span class="st">"PAT02"</span>, <span class="st">"PARAM02"</span>, <span class="st">"SCREENING"</span>, <span class="fu"><a href="https://rdrr.io/r/base/as.Date.html" class="external-link">as.Date</a></span><span class="op">(</span><span class="st">"2021-04-27"</span><span class="op">)</span>,  <span class="fl">15.0</span>,        <span class="cn">NA</span>,</span></span>
<span class="r-in"><span>  <span class="st">"TEST01"</span>,  <span class="st">"PAT02"</span>, <span class="st">"PARAM02"</span>,  <span class="st">"BASELINE"</span>, <span class="fu"><a href="https://rdrr.io/r/base/as.Date.html" class="external-link">as.Date</a></span><span class="op">(</span><span class="st">"2021-04-25"</span><span class="op">)</span>,  <span class="fl">14.0</span>,        <span class="cn">NA</span>,</span></span>
<span class="r-in"><span>  <span class="st">"TEST01"</span>,  <span class="st">"PAT02"</span>, <span class="st">"PARAM02"</span>,    <span class="st">"WEEK 1"</span>, <span class="fu"><a href="https://rdrr.io/r/base/as.Date.html" class="external-link">as.Date</a></span><span class="op">(</span><span class="st">"2021-04-23"</span><span class="op">)</span>,  <span class="fl">15.0</span>,        <span class="cn">NA</span>,</span></span>
<span class="r-in"><span>  <span class="st">"TEST01"</span>,  <span class="st">"PAT02"</span>, <span class="st">"PARAM02"</span>,    <span class="st">"WEEK 1"</span>, <span class="fu"><a href="https://rdrr.io/r/base/as.Date.html" class="external-link">as.Date</a></span><span class="op">(</span><span class="st">"2021-04-27"</span><span class="op">)</span>,  <span class="fl">10.0</span>,        <span class="cn">NA</span>,</span></span>
<span class="r-in"><span>  <span class="st">"TEST01"</span>,  <span class="st">"PAT02"</span>, <span class="st">"PARAM02"</span>,  <span class="st">"BASELINE"</span>, <span class="fu"><a href="https://rdrr.io/r/base/as.Date.html" class="external-link">as.Date</a></span><span class="op">(</span><span class="st">"2021-04-30"</span><span class="op">)</span>,  <span class="fl">12.0</span>,        <span class="cn">NA</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Last observation</span></span></span>
<span class="r-in"><span><span class="fu"><a href="restrict_derivation.html">restrict_derivation</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="va">input</span>,</span></span>
<span class="r-in"><span>  derivation <span class="op">=</span> <span class="va">derive_var_extreme_flag</span>,</span></span>
<span class="r-in"><span>  args <span class="op">=</span> <span class="fu"><a href="params.html">params</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    by_vars <span class="op">=</span> <span class="fu"><a href="reexport-exprs.html">exprs</a></span><span class="op">(</span><span class="va">USUBJID</span>, <span class="va">PARAMCD</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    order <span class="op">=</span> <span class="fu"><a href="reexport-exprs.html">exprs</a></span><span class="op">(</span><span class="va">ADT</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    new_var <span class="op">=</span> <span class="va">ABLFL</span>,</span></span>
<span class="r-in"><span>    mode <span class="op">=</span> <span class="st">"last"</span></span></span>
<span class="r-in"><span>  <span class="op">)</span>,</span></span>
<span class="r-in"><span>  filter <span class="op">=</span> <span class="va">AVISIT</span> <span class="op">==</span> <span class="st">"BASELINE"</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 20 Ã— 8</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    STUDYID USUBJID PARAMCD AVISIT    ADT         AVAL DTYPE   ABLFL</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;date&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 1</span> TEST01  PAT01   PARAM01 BASELINE  2021-04-23    15 AVERAGE <span style="color: #BB0000;">NA</span>   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 2</span> TEST01  PAT01   PARAM01 BASELINE  2021-04-25    14 <span style="color: #BB0000;">NA</span>      <span style="color: #BB0000;">NA</span>   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 3</span> TEST01  PAT01   PARAM01 BASELINE  2021-04-27    15 <span style="color: #BB0000;">NA</span>      Y    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 4</span> TEST01  PAT01   PARAM02 BASELINE  2021-04-27    10 AVERAGE Y    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 5</span> TEST01  PAT02   PARAM01 BASELINE  2021-04-23    15 AVERAGE <span style="color: #BB0000;">NA</span>   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 6</span> TEST01  PAT02   PARAM01 BASELINE  2021-04-25    14 AVERAGE Y    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 7</span> TEST01  PAT02   PARAM02 BASELINE  2021-04-25    14 <span style="color: #BB0000;">NA</span>      <span style="color: #BB0000;">NA</span>   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 8</span> TEST01  PAT02   PARAM02 BASELINE  2021-04-30    12 <span style="color: #BB0000;">NA</span>      Y    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 9</span> TEST01  PAT01   PARAM01 WEEK 1    2021-04-27    10 AVERAGE <span style="color: #BB0000;">NA</span>   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">10</span> TEST01  PAT01   PARAM01 WEEK 2    2021-04-30    12 <span style="color: #BB0000;">NA</span>      <span style="color: #BB0000;">NA</span>   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">11</span> TEST01  PAT02   PARAM01 SCREENING 2021-04-27    15 AVERAGE <span style="color: #BB0000;">NA</span>   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">12</span> TEST01  PAT02   PARAM01 WEEK 1    2021-04-27    10 AVERAGE <span style="color: #BB0000;">NA</span>   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">13</span> TEST01  PAT02   PARAM01 WEEK 2    2021-04-30    12 AVERAGE <span style="color: #BB0000;">NA</span>   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">14</span> TEST01  PAT01   PARAM02 SCREENING 2021-04-27    15 AVERAGE <span style="color: #BB0000;">NA</span>   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">15</span> TEST01  PAT01   PARAM02 SCREENING 2021-04-25    14 AVERAGE <span style="color: #BB0000;">NA</span>   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">16</span> TEST01  PAT01   PARAM02 SCREENING 2021-04-23    15 <span style="color: #BB0000;">NA</span>      <span style="color: #BB0000;">NA</span>   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">17</span> TEST01  PAT01   PARAM02 WEEK 2    2021-04-30    12 <span style="color: #BB0000;">NA</span>      <span style="color: #BB0000;">NA</span>   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">18</span> TEST01  PAT02   PARAM02 SCREENING 2021-04-27    15 <span style="color: #BB0000;">NA</span>      <span style="color: #BB0000;">NA</span>   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">19</span> TEST01  PAT02   PARAM02 WEEK 1    2021-04-23    15 <span style="color: #BB0000;">NA</span>      <span style="color: #BB0000;">NA</span>   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">20</span> TEST01  PAT02   PARAM02 WEEK 1    2021-04-27    10 <span style="color: #BB0000;">NA</span>      <span style="color: #BB0000;">NA</span>   </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Worst observation - Direction = High</span></span></span>
<span class="r-in"><span><span class="fu"><a href="restrict_derivation.html">restrict_derivation</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="va">input</span>,</span></span>
<span class="r-in"><span>  derivation <span class="op">=</span> <span class="va">derive_var_extreme_flag</span>,</span></span>
<span class="r-in"><span>  args <span class="op">=</span> <span class="fu"><a href="params.html">params</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    by_vars <span class="op">=</span> <span class="fu"><a href="reexport-exprs.html">exprs</a></span><span class="op">(</span><span class="va">USUBJID</span>, <span class="va">PARAMCD</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    order <span class="op">=</span> <span class="fu"><a href="reexport-exprs.html">exprs</a></span><span class="op">(</span><span class="va">AVAL</span>, <span class="va">ADT</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    new_var <span class="op">=</span> <span class="va">ABLFL</span>,</span></span>
<span class="r-in"><span>    mode <span class="op">=</span> <span class="st">"last"</span></span></span>
<span class="r-in"><span>  <span class="op">)</span>,</span></span>
<span class="r-in"><span>  filter <span class="op">=</span> <span class="va">AVISIT</span> <span class="op">==</span> <span class="st">"BASELINE"</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 20 Ã— 8</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    STUDYID USUBJID PARAMCD AVISIT    ADT         AVAL DTYPE   ABLFL</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;date&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 1</span> TEST01  PAT01   PARAM01 BASELINE  2021-04-25    14 <span style="color: #BB0000;">NA</span>      <span style="color: #BB0000;">NA</span>   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 2</span> TEST01  PAT01   PARAM01 BASELINE  2021-04-23    15 AVERAGE <span style="color: #BB0000;">NA</span>   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 3</span> TEST01  PAT01   PARAM01 BASELINE  2021-04-27    15 <span style="color: #BB0000;">NA</span>      Y    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 4</span> TEST01  PAT01   PARAM02 BASELINE  2021-04-27    10 AVERAGE Y    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 5</span> TEST01  PAT02   PARAM01 BASELINE  2021-04-25    14 AVERAGE <span style="color: #BB0000;">NA</span>   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 6</span> TEST01  PAT02   PARAM01 BASELINE  2021-04-23    15 AVERAGE Y    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 7</span> TEST01  PAT02   PARAM02 BASELINE  2021-04-30    12 <span style="color: #BB0000;">NA</span>      <span style="color: #BB0000;">NA</span>   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 8</span> TEST01  PAT02   PARAM02 BASELINE  2021-04-25    14 <span style="color: #BB0000;">NA</span>      Y    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 9</span> TEST01  PAT01   PARAM01 WEEK 1    2021-04-27    10 AVERAGE <span style="color: #BB0000;">NA</span>   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">10</span> TEST01  PAT01   PARAM01 WEEK 2    2021-04-30    12 <span style="color: #BB0000;">NA</span>      <span style="color: #BB0000;">NA</span>   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">11</span> TEST01  PAT02   PARAM01 SCREENING 2021-04-27    15 AVERAGE <span style="color: #BB0000;">NA</span>   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">12</span> TEST01  PAT02   PARAM01 WEEK 1    2021-04-27    10 AVERAGE <span style="color: #BB0000;">NA</span>   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">13</span> TEST01  PAT02   PARAM01 WEEK 2    2021-04-30    12 AVERAGE <span style="color: #BB0000;">NA</span>   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">14</span> TEST01  PAT01   PARAM02 SCREENING 2021-04-27    15 AVERAGE <span style="color: #BB0000;">NA</span>   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">15</span> TEST01  PAT01   PARAM02 SCREENING 2021-04-25    14 AVERAGE <span style="color: #BB0000;">NA</span>   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">16</span> TEST01  PAT01   PARAM02 SCREENING 2021-04-23    15 <span style="color: #BB0000;">NA</span>      <span style="color: #BB0000;">NA</span>   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">17</span> TEST01  PAT01   PARAM02 WEEK 2    2021-04-30    12 <span style="color: #BB0000;">NA</span>      <span style="color: #BB0000;">NA</span>   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">18</span> TEST01  PAT02   PARAM02 SCREENING 2021-04-27    15 <span style="color: #BB0000;">NA</span>      <span style="color: #BB0000;">NA</span>   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">19</span> TEST01  PAT02   PARAM02 WEEK 1    2021-04-23    15 <span style="color: #BB0000;">NA</span>      <span style="color: #BB0000;">NA</span>   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">20</span> TEST01  PAT02   PARAM02 WEEK 1    2021-04-27    10 <span style="color: #BB0000;">NA</span>      <span style="color: #BB0000;">NA</span>   </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Worst observation - Direction = Lo</span></span></span>
<span class="r-in"><span><span class="fu"><a href="restrict_derivation.html">restrict_derivation</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="va">input</span>,</span></span>
<span class="r-in"><span>  derivation <span class="op">=</span> <span class="va">derive_var_extreme_flag</span>,</span></span>
<span class="r-in"><span>  args <span class="op">=</span> <span class="fu"><a href="params.html">params</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    by_vars <span class="op">=</span> <span class="fu"><a href="reexport-exprs.html">exprs</a></span><span class="op">(</span><span class="va">USUBJID</span>, <span class="va">PARAMCD</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    order <span class="op">=</span> <span class="fu"><a href="reexport-exprs.html">exprs</a></span><span class="op">(</span><span class="fu"><a href="reexport-desc.html">desc</a></span><span class="op">(</span><span class="va">AVAL</span><span class="op">)</span>, <span class="va">ADT</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    new_var <span class="op">=</span> <span class="va">ABLFL</span>,</span></span>
<span class="r-in"><span>    mode <span class="op">=</span> <span class="st">"last"</span></span></span>
<span class="r-in"><span>  <span class="op">)</span>,</span></span>
<span class="r-in"><span>  filter <span class="op">=</span> <span class="va">AVISIT</span> <span class="op">==</span> <span class="st">"BASELINE"</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 20 Ã— 8</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    STUDYID USUBJID PARAMCD AVISIT    ADT         AVAL DTYPE   ABLFL</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;date&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 1</span> TEST01  PAT01   PARAM01 BASELINE  2021-04-23    15 AVERAGE <span style="color: #BB0000;">NA</span>   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 2</span> TEST01  PAT01   PARAM01 BASELINE  2021-04-27    15 <span style="color: #BB0000;">NA</span>      <span style="color: #BB0000;">NA</span>   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 3</span> TEST01  PAT01   PARAM01 BASELINE  2021-04-25    14 <span style="color: #BB0000;">NA</span>      Y    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 4</span> TEST01  PAT01   PARAM02 BASELINE  2021-04-27    10 AVERAGE Y    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 5</span> TEST01  PAT02   PARAM01 BASELINE  2021-04-23    15 AVERAGE <span style="color: #BB0000;">NA</span>   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 6</span> TEST01  PAT02   PARAM01 BASELINE  2021-04-25    14 AVERAGE Y    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 7</span> TEST01  PAT02   PARAM02 BASELINE  2021-04-25    14 <span style="color: #BB0000;">NA</span>      <span style="color: #BB0000;">NA</span>   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 8</span> TEST01  PAT02   PARAM02 BASELINE  2021-04-30    12 <span style="color: #BB0000;">NA</span>      Y    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 9</span> TEST01  PAT01   PARAM01 WEEK 1    2021-04-27    10 AVERAGE <span style="color: #BB0000;">NA</span>   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">10</span> TEST01  PAT01   PARAM01 WEEK 2    2021-04-30    12 <span style="color: #BB0000;">NA</span>      <span style="color: #BB0000;">NA</span>   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">11</span> TEST01  PAT02   PARAM01 SCREENING 2021-04-27    15 AVERAGE <span style="color: #BB0000;">NA</span>   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">12</span> TEST01  PAT02   PARAM01 WEEK 1    2021-04-27    10 AVERAGE <span style="color: #BB0000;">NA</span>   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">13</span> TEST01  PAT02   PARAM01 WEEK 2    2021-04-30    12 AVERAGE <span style="color: #BB0000;">NA</span>   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">14</span> TEST01  PAT01   PARAM02 SCREENING 2021-04-27    15 AVERAGE <span style="color: #BB0000;">NA</span>   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">15</span> TEST01  PAT01   PARAM02 SCREENING 2021-04-25    14 AVERAGE <span style="color: #BB0000;">NA</span>   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">16</span> TEST01  PAT01   PARAM02 SCREENING 2021-04-23    15 <span style="color: #BB0000;">NA</span>      <span style="color: #BB0000;">NA</span>   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">17</span> TEST01  PAT01   PARAM02 WEEK 2    2021-04-30    12 <span style="color: #BB0000;">NA</span>      <span style="color: #BB0000;">NA</span>   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">18</span> TEST01  PAT02   PARAM02 SCREENING 2021-04-27    15 <span style="color: #BB0000;">NA</span>      <span style="color: #BB0000;">NA</span>   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">19</span> TEST01  PAT02   PARAM02 WEEK 1    2021-04-23    15 <span style="color: #BB0000;">NA</span>      <span style="color: #BB0000;">NA</span>   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">20</span> TEST01  PAT02   PARAM02 WEEK 1    2021-04-27    10 <span style="color: #BB0000;">NA</span>      <span style="color: #BB0000;">NA</span>   </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Average observation</span></span></span>
<span class="r-in"><span><span class="fu"><a href="restrict_derivation.html">restrict_derivation</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="va">input</span>,</span></span>
<span class="r-in"><span>  derivation <span class="op">=</span> <span class="va">derive_var_extreme_flag</span>,</span></span>
<span class="r-in"><span>  args <span class="op">=</span> <span class="fu"><a href="params.html">params</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    by_vars <span class="op">=</span> <span class="fu"><a href="reexport-exprs.html">exprs</a></span><span class="op">(</span><span class="va">USUBJID</span>, <span class="va">PARAMCD</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    order <span class="op">=</span> <span class="fu"><a href="reexport-exprs.html">exprs</a></span><span class="op">(</span><span class="va">ADT</span>, <span class="fu"><a href="reexport-desc.html">desc</a></span><span class="op">(</span><span class="va">AVAL</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    new_var <span class="op">=</span> <span class="va">ABLFL</span>,</span></span>
<span class="r-in"><span>    mode <span class="op">=</span> <span class="st">"last"</span></span></span>
<span class="r-in"><span>  <span class="op">)</span>,</span></span>
<span class="r-in"><span>  filter <span class="op">=</span> <span class="va">AVISIT</span> <span class="op">==</span> <span class="st">"BASELINE"</span> <span class="op">&amp;</span> <span class="va">DTYPE</span> <span class="op">==</span> <span class="st">"AVERAGE"</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 20 Ã— 8</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    STUDYID USUBJID PARAMCD AVISIT    ADT         AVAL DTYPE   ABLFL</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;date&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 1</span> TEST01  PAT01   PARAM01 BASELINE  2021-04-23    15 AVERAGE Y    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 2</span> TEST01  PAT01   PARAM02 BASELINE  2021-04-27    10 AVERAGE Y    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 3</span> TEST01  PAT02   PARAM01 BASELINE  2021-04-23    15 AVERAGE <span style="color: #BB0000;">NA</span>   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 4</span> TEST01  PAT02   PARAM01 BASELINE  2021-04-25    14 AVERAGE Y    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 5</span> TEST01  PAT01   PARAM01 BASELINE  2021-04-27    15 <span style="color: #BB0000;">NA</span>      <span style="color: #BB0000;">NA</span>   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 6</span> TEST01  PAT01   PARAM01 BASELINE  2021-04-25    14 <span style="color: #BB0000;">NA</span>      <span style="color: #BB0000;">NA</span>   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 7</span> TEST01  PAT01   PARAM01 WEEK 1    2021-04-27    10 AVERAGE <span style="color: #BB0000;">NA</span>   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 8</span> TEST01  PAT01   PARAM01 WEEK 2    2021-04-30    12 <span style="color: #BB0000;">NA</span>      <span style="color: #BB0000;">NA</span>   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 9</span> TEST01  PAT02   PARAM01 SCREENING 2021-04-27    15 AVERAGE <span style="color: #BB0000;">NA</span>   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">10</span> TEST01  PAT02   PARAM01 WEEK 1    2021-04-27    10 AVERAGE <span style="color: #BB0000;">NA</span>   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">11</span> TEST01  PAT02   PARAM01 WEEK 2    2021-04-30    12 AVERAGE <span style="color: #BB0000;">NA</span>   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">12</span> TEST01  PAT01   PARAM02 SCREENING 2021-04-27    15 AVERAGE <span style="color: #BB0000;">NA</span>   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">13</span> TEST01  PAT01   PARAM02 SCREENING 2021-04-25    14 AVERAGE <span style="color: #BB0000;">NA</span>   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">14</span> TEST01  PAT01   PARAM02 SCREENING 2021-04-23    15 <span style="color: #BB0000;">NA</span>      <span style="color: #BB0000;">NA</span>   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">15</span> TEST01  PAT01   PARAM02 WEEK 2    2021-04-30    12 <span style="color: #BB0000;">NA</span>      <span style="color: #BB0000;">NA</span>   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">16</span> TEST01  PAT02   PARAM02 SCREENING 2021-04-27    15 <span style="color: #BB0000;">NA</span>      <span style="color: #BB0000;">NA</span>   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">17</span> TEST01  PAT02   PARAM02 BASELINE  2021-04-25    14 <span style="color: #BB0000;">NA</span>      <span style="color: #BB0000;">NA</span>   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">18</span> TEST01  PAT02   PARAM02 WEEK 1    2021-04-23    15 <span style="color: #BB0000;">NA</span>      <span style="color: #BB0000;">NA</span>   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">19</span> TEST01  PAT02   PARAM02 WEEK 1    2021-04-27    10 <span style="color: #BB0000;">NA</span>      <span style="color: #BB0000;">NA</span>   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">20</span> TEST01  PAT02   PARAM02 BASELINE  2021-04-30    12 <span style="color: #BB0000;">NA</span>      <span style="color: #BB0000;">NA</span>   </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># OCCURDS Examples</span></span></span>
<span class="r-in"><span><span class="va">example_ae</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tribble.html" class="external-link">tribble</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="op">~</span><span class="va">USUBJID</span>,         <span class="op">~</span><span class="va">AEBODSYS</span>,    <span class="op">~</span><span class="va">AEDECOD</span>,   <span class="op">~</span><span class="va">AESEV</span>, <span class="op">~</span><span class="va">AESTDY</span>, <span class="op">~</span><span class="va">AESEQ</span>,</span></span>
<span class="r-in"><span>  <span class="st">"1015"</span>, <span class="st">"GENERAL DISORDERS"</span>,  <span class="st">"ERYTHEMA"</span>,   <span class="st">"MILD"</span>,       <span class="fl">2</span>,      <span class="fl">1</span>,</span></span>
<span class="r-in"><span>  <span class="st">"1015"</span>, <span class="st">"GENERAL DISORDERS"</span>,  <span class="st">"PRURITUS"</span>,   <span class="st">"MILD"</span>,       <span class="fl">2</span>,      <span class="fl">2</span>,</span></span>
<span class="r-in"><span>  <span class="st">"1015"</span>,      <span class="st">"GI DISORDERS"</span>, <span class="st">"DIARRHOEA"</span>,   <span class="st">"MILD"</span>,       <span class="fl">8</span>,      <span class="fl">3</span>,</span></span>
<span class="r-in"><span>  <span class="st">"1023"</span>, <span class="st">"CARDIAC DISORDERS"</span>,  <span class="st">"AV BLOCK"</span>,   <span class="st">"MILD"</span>,      <span class="fl">22</span>,      <span class="fl">4</span>,</span></span>
<span class="r-in"><span>  <span class="st">"1023"</span>,    <span class="st">"SKIN DISORDERS"</span>,  <span class="st">"ERYTHEMA"</span>,   <span class="st">"MILD"</span>,       <span class="fl">3</span>,      <span class="fl">1</span>,</span></span>
<span class="r-in"><span>  <span class="st">"1023"</span>,    <span class="st">"SKIN DISORDERS"</span>,  <span class="st">"ERYTHEMA"</span>, <span class="st">"SEVERE"</span>,       <span class="fl">5</span>,      <span class="fl">2</span>,</span></span>
<span class="r-in"><span>  <span class="st">"1023"</span>,    <span class="st">"SKIN DISORDERS"</span>,  <span class="st">"ERYTHEMA"</span>,   <span class="st">"MILD"</span>,       <span class="fl">8</span>,      <span class="fl">3</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Most severe AE first occurrence per patient</span></span></span>
<span class="r-in"><span><span class="va">example_ae</span> <span class="op"><a href="pipe.html">%&gt;%</a></span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    TEMP_AESEVN <span class="op">=</span></span></span>
<span class="r-in"><span>      <span class="fu"><a href="https://rdrr.io/r/base/integer.html" class="external-link">as.integer</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">AESEV</span>, levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"SEVERE"</span>, <span class="st">"MODERATE"</span>, <span class="st">"MILD"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="op">)</span> <span class="op"><a href="pipe.html">%&gt;%</a></span></span></span>
<span class="r-in"><span>  <span class="fu">derive_var_extreme_flag</span><span class="op">(</span></span></span>
<span class="r-in"><span>    new_var <span class="op">=</span> <span class="va">AOCCIFL</span>,</span></span>
<span class="r-in"><span>    by_vars <span class="op">=</span> <span class="fu"><a href="reexport-exprs.html">exprs</a></span><span class="op">(</span><span class="va">USUBJID</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    order <span class="op">=</span> <span class="fu"><a href="reexport-exprs.html">exprs</a></span><span class="op">(</span><span class="va">TEMP_AESEVN</span>, <span class="va">AESTDY</span>, <span class="va">AESEQ</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    mode <span class="op">=</span> <span class="st">"first"</span></span></span>
<span class="r-in"><span>  <span class="op">)</span> <span class="op"><a href="pipe.html">%&gt;%</a></span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html" class="external-link">arrange</a></span><span class="op">(</span><span class="va">USUBJID</span>, <span class="va">AESTDY</span>, <span class="va">AESEQ</span><span class="op">)</span> <span class="op"><a href="pipe.html">%&gt;%</a></span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">USUBJID</span>, <span class="va">AEDECOD</span>, <span class="va">AESEV</span>, <span class="va">AESTDY</span>, <span class="va">AESEQ</span>, <span class="va">AOCCIFL</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 7 Ã— 6</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   USUBJID AEDECOD   AESEV  AESTDY AESEQ AOCCIFL</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">1</span> 1015    ERYTHEMA  MILD        2     1 Y      </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">2</span> 1015    PRURITUS  MILD        2     2 <span style="color: #BB0000;">NA</span>     </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">3</span> 1015    DIARRHOEA MILD        8     3 <span style="color: #BB0000;">NA</span>     </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">4</span> 1023    ERYTHEMA  MILD        3     1 <span style="color: #BB0000;">NA</span>     </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">5</span> 1023    ERYTHEMA  SEVERE      5     2 Y      </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">6</span> 1023    ERYTHEMA  MILD        8     3 <span style="color: #BB0000;">NA</span>     </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">7</span> 1023    AV BLOCK  MILD       22     4 <span style="color: #BB0000;">NA</span>     </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Most severe AE first occurrence per patient (flag all cases)</span></span></span>
<span class="r-in"><span><span class="va">example_ae</span> <span class="op"><a href="pipe.html">%&gt;%</a></span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    TEMP_AESEVN <span class="op">=</span></span></span>
<span class="r-in"><span>      <span class="fu"><a href="https://rdrr.io/r/base/integer.html" class="external-link">as.integer</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">AESEV</span>, levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"SEVERE"</span>, <span class="st">"MODERATE"</span>, <span class="st">"MILD"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="op">)</span> <span class="op"><a href="pipe.html">%&gt;%</a></span></span></span>
<span class="r-in"><span>  <span class="fu">derive_var_extreme_flag</span><span class="op">(</span></span></span>
<span class="r-in"><span>    new_var <span class="op">=</span> <span class="va">AOCCIFL</span>,</span></span>
<span class="r-in"><span>    by_vars <span class="op">=</span> <span class="fu"><a href="reexport-exprs.html">exprs</a></span><span class="op">(</span><span class="va">USUBJID</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    order <span class="op">=</span> <span class="fu"><a href="reexport-exprs.html">exprs</a></span><span class="op">(</span><span class="va">TEMP_AESEVN</span>, <span class="va">AESTDY</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    mode <span class="op">=</span> <span class="st">"first"</span>,</span></span>
<span class="r-in"><span>    flag_all <span class="op">=</span> <span class="cn">TRUE</span></span></span>
<span class="r-in"><span>  <span class="op">)</span> <span class="op"><a href="pipe.html">%&gt;%</a></span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html" class="external-link">arrange</a></span><span class="op">(</span><span class="va">USUBJID</span>, <span class="va">AESTDY</span><span class="op">)</span> <span class="op"><a href="pipe.html">%&gt;%</a></span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">USUBJID</span>, <span class="va">AEDECOD</span>, <span class="va">AESEV</span>, <span class="va">AESTDY</span>, <span class="va">AOCCIFL</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 7 Ã— 5</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   USUBJID AEDECOD   AESEV  AESTDY AOCCIFL</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">1</span> 1015    ERYTHEMA  MILD        2 Y      </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">2</span> 1015    PRURITUS  MILD        2 Y      </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">3</span> 1015    DIARRHOEA MILD        8 <span style="color: #BB0000;">NA</span>     </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">4</span> 1023    ERYTHEMA  MILD        3 <span style="color: #BB0000;">NA</span>     </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">5</span> 1023    ERYTHEMA  SEVERE      5 Y      </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">6</span> 1023    ERYTHEMA  MILD        8 <span style="color: #BB0000;">NA</span>     </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">7</span> 1023    AV BLOCK  MILD       22 <span style="color: #BB0000;">NA</span>     </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Most severe AE first occurrence per patient per body system</span></span></span>
<span class="r-in"><span><span class="va">example_ae</span> <span class="op"><a href="pipe.html">%&gt;%</a></span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    TEMP_AESEVN <span class="op">=</span></span></span>
<span class="r-in"><span>      <span class="fu"><a href="https://rdrr.io/r/base/integer.html" class="external-link">as.integer</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">AESEV</span>, levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"SEVERE"</span>, <span class="st">"MODERATE"</span>, <span class="st">"MILD"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="op">)</span> <span class="op"><a href="pipe.html">%&gt;%</a></span></span></span>
<span class="r-in"><span>  <span class="fu">derive_var_extreme_flag</span><span class="op">(</span></span></span>
<span class="r-in"><span>    new_var <span class="op">=</span> <span class="va">AOCCSIFL</span>,</span></span>
<span class="r-in"><span>    by_vars <span class="op">=</span> <span class="fu"><a href="reexport-exprs.html">exprs</a></span><span class="op">(</span><span class="va">USUBJID</span>, <span class="va">AEBODSYS</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    order <span class="op">=</span> <span class="fu"><a href="reexport-exprs.html">exprs</a></span><span class="op">(</span><span class="va">TEMP_AESEVN</span>, <span class="va">AESTDY</span>, <span class="va">AESEQ</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    mode <span class="op">=</span> <span class="st">"first"</span></span></span>
<span class="r-in"><span>  <span class="op">)</span> <span class="op"><a href="pipe.html">%&gt;%</a></span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html" class="external-link">arrange</a></span><span class="op">(</span><span class="va">USUBJID</span>, <span class="va">AESTDY</span>, <span class="va">AESEQ</span><span class="op">)</span> <span class="op"><a href="pipe.html">%&gt;%</a></span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">USUBJID</span>, <span class="va">AEBODSYS</span>, <span class="va">AESEV</span>, <span class="va">AESTDY</span>, <span class="va">AOCCSIFL</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 7 Ã— 5</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   USUBJID AEBODSYS          AESEV  AESTDY AOCCSIFL</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>             <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">1</span> 1015    GENERAL DISORDERS MILD        2 Y       </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">2</span> 1015    GENERAL DISORDERS MILD        2 <span style="color: #BB0000;">NA</span>      </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">3</span> 1015    GI DISORDERS      MILD        8 Y       </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">4</span> 1023    SKIN DISORDERS    MILD        3 <span style="color: #BB0000;">NA</span>      </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">5</span> 1023    SKIN DISORDERS    SEVERE      5 Y       </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">6</span> 1023    SKIN DISORDERS    MILD        8 <span style="color: #BB0000;">NA</span>      </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">7</span> 1023    CARDIAC DISORDERS MILD       22 Y       </span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Ben Straub, Stefan Bundfuss, Jeffrey Dickinson, Ross Farrugia, Fanny Gautier, Dinakar Kulkarni, Edoardo Mancini, Sadchla Mascary, Gordon Miller, Jim Rothstein, Sophie Shapcott, Eric Simms, Daniel Sjoberg, Stefan Thoma, Phillip Webster, Zelos Zhu, F. Hoffmann-La Roche AG, GlaxoSmithKline LLC.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.2.</p>
</div>

    </footer>
</div>





  </body>
</html>
