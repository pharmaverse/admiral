<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en-US"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Derive Nominal Relative Time from First Dose (NFRLT) â€” derive_var_nfrlt â€¢ admiral</title><!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png"><link rel="icon" type="â€image/svg+xmlâ€" href="../favicon.svg"><link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png"><link rel="icon" sizes="any" href="../favicon.ico"><link rel="manifest" href="../site.webmanifest"><!-- mathjax math --><script src="https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-mml-chtml.js" integrity="sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI=" crossorigin="anonymous"></script><script>
  window.MathJax = {
    chtml: {
      fontURL: "https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/output/chtml/fonts/woff-v2"
    }
  };
</script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Derive Nominal Relative Time from First Dose (NFRLT) â€” derive_var_nfrlt"><meta name="description" content="
Derives nominal/planned time from first dose in hours by combining visit day
information with timepoint descriptions. The function converts timepoint
strings to hours using convert_xxtpt_to_hours() and adds them to the
day-based offset. Optionally creates a corresponding unit variable."><meta property="og:description" content="
Derives nominal/planned time from first dose in hours by combining visit day
information with timepoint descriptions. The function converts timepoint
strings to hours using convert_xxtpt_to_hours() and adds them to the
day-based offset. Optionally creates a corresponding unit variable."><meta property="og:image" content="https:/pharmaverse.github.io/admiral/v1.4.0/logo.png"><script async src="https://widget.kapa.ai/kapa-widget.bundle.js" data-website-id="2c7249cc-f1dc-4a63-8674-6ecbcb34d95c" data-project-name="admiral" data-project-color="#2c3e50" data-project-logo="https://pharmaverse.github.io/admiral/cran-release/logo.png" data-consent-required="true" data-user-analytics-cookie-enabled="true" data-consent-screen-title="Help us improve our AI assistant" data-consent-screen-disclaimer="By clicking 'Allow tracking', you consent to anonymous user tracking which helps us improve our service. We don't collect any personally identifiable information." data-consent-screen-accept-button-text="Allow tracking" data-consent-screen-reject-button-text="No, thanks" data-modal-example-questions="Tell me a little about the {admiral} package., What are some important {admiral} functions and what do they do?" data-modal-search-placeholder="Ask me a question about {admiral} or the {admiral} ecosystem..." data-modal-z-index="9999"></script></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">admiral</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.4.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-get-started" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Get Started</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-get-started"><li><a class="dropdown-item" href="../articles/admiral.html">Get Started</a></li>
    <li><a class="external-link dropdown-item" href="https://github.com/pharmaverse/admiral/blob/main/inst/cheatsheet/admiral_cheatsheet.pdf">Cheatsheet</a></li>
    <li><a class="dropdown-item" href="../articles/templates.html">Explore ADaM Templates ðŸ§­</a></li>
    <li><a class="external-link dropdown-item" href="https://pharmaverse.github.io/admiraldiscovery/articles/presentation_archive.html">Presentation Archive</a></li>
  </ul></li>
<li class="active nav-item"><a class="nav-link" href="../reference/">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-user-guides" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">User Guides</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-user-guides"><li><h6 class="dropdown-header" data-toc-skip>General Guides</h6></li>
    <li><a class="dropdown-item" href="../articles/concepts_conventions.html">Programming Concepts and Conventions</a></li>
    <li><a class="dropdown-item" href="../articles/generic.html">Generic Derivations</a></li>
    <li><a class="dropdown-item" href="../articles/higher_order.html">Higher Order Functions</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>ADaM Script Guides</h6></li>
    <li><a class="dropdown-item" href="../articles/adsl.html">Creating a Basic ADSL</a></li>
    <li><a class="dropdown-item" href="../articles/occds.html">Creating an OCCDS ADaM</a></li>
    <li><a class="dropdown-item" href="../articles/bds_finding.html">Creating a BDS Findings ADAM</a></li>
    <li><a class="dropdown-item" href="../articles/bds_exposure.html">Creating a BDS Exposure ADaM</a></li>
    <li><a class="dropdown-item" href="../articles/bds_tte.html">Creating a BDS Time-to-Event ADaM</a></li>
    <li><a class="dropdown-item" href="../articles/questionnaires.html">Creating Questionnaire ADaMs</a></li>
    <li><a class="dropdown-item" href="../articles/pk_adnca.html">Creating a PK NCA or Population PK ADaM</a></li>
    <li><a class="dropdown-item" href="../articles/adab.html">Creating an Antidrug Antibody ADaM</a></li>
    <li><a class="dropdown-item" href="../articles/hys_law.html">Hy's Law Implementation</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Special Topics Guides</h6></li>
    <li><a class="dropdown-item" href="../articles/imputation.html">Date and Time Imputation</a></li>
    <li><a class="dropdown-item" href="../articles/visits_periods.html">Visit and Period Variables</a></li>
    <li><a class="dropdown-item" href="../articles/queries_dataset.html">Queries Dataset Documentation</a></li>
    <li><a class="dropdown-item" href="../articles/lab_grading.html">Lab Grading</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><a class="dropdown-item" href="../articles/faq.html">FAQ</a></li>
  </ul></li>
<li class="nav-item"><a class="external-link nav-link" href="https://pharmaverse.github.io/admiraldiscovery/articles/reactable.html">ðŸ”Ž Find my function</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://pharmaverse.slack.com/" aria-label="Slack"><span class="fa fa-slack"></span></a></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/pharmaverse/admiral/issues/new/choose" aria-label="New Issue"><span class="fa fa-bug"></span></a></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/pharmaverse/admiral/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Derive Nominal Relative Time from First Dose (NFRLT)</h1>
      <small class="dont-index">Source: <a href="https://github.com/pharmaverse/admiral/blob/main/R/derive_var_nfrlt.R" class="external-link"><code>R/derive_var_nfrlt.R</code></a></small>
      <div class="d-none name"><code>derive_var_nfrlt.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p><a href="https://lifecycle.r-lib.org/articles/stages.html#experimental" class="external-link"><img src="figures/lifecycle-experimental.svg" alt="[Experimental]"></a></p>
<p>Derives nominal/planned time from first dose in hours by combining visit day
information with timepoint descriptions. The function converts timepoint
strings to hours using <code><a href="convert_xxtpt_to_hours.html">convert_xxtpt_to_hours()</a></code> and adds them to the
day-based offset. Optionally creates a corresponding unit variable.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">derive_var_nfrlt</span><span class="op">(</span></span>
<span>  <span class="va">dataset</span>,</span>
<span>  new_var <span class="op">=</span> <span class="va">NFRLT</span>,</span>
<span>  new_var_unit <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  out_unit <span class="op">=</span> <span class="st">"HOURS"</span>,</span>
<span>  tpt_var <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">visit_day</span>,</span>
<span>  first_dose_day <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  treatment_duration <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  range_method <span class="op">=</span> <span class="st">"midpoint"</span>,</span>
<span>  set_values_to_na <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-dataset">dataset<a class="anchor" aria-label="anchor" href="#arg-dataset"></a></dt>
<dd><p>Input dataset containing visit day variable and optionally
timepoint variable.</p>
<dl><dt>Permitted values</dt>
<dd><p>A data frame or tibble</p></dd>

<dt>Default value</dt>
<dd><p>none</p></dd>


</dl></dd>


<dt id="arg-new-var">new_var<a class="anchor" aria-label="anchor" href="#arg-new-var"></a></dt>
<dd><p>Name of the new variable to create (unquoted). Default is
<code>NFRLT</code>.</p>
<dl><dt>Permitted values</dt>
<dd><p>Unquoted variable name</p></dd>

<dt>Default value</dt>
<dd><p><code>NFRLT</code></p></dd>


</dl></dd>


<dt id="arg-new-var-unit">new_var_unit<a class="anchor" aria-label="anchor" href="#arg-new-var-unit"></a></dt>
<dd><p>Name of the unit variable to create (unquoted). If
specified, a character variable will be created containing the unit of
time exactly as provided in <code>out_unit</code>. Common CDISC variables are
<code>FRLTU</code> (First Dose Relative Time Unit) or <code>RRLTU</code> (Reference Relative
Time Unit). If not specified, no unit variable is created.</p>
<dl><dt>Permitted values</dt>
<dd><p>Unquoted variable name (optional)</p></dd>

<dt>Default value</dt>
<dd><p><code>NULL</code></p></dd>


</dl></dd>


<dt id="arg-out-unit">out_unit<a class="anchor" aria-label="anchor" href="#arg-out-unit"></a></dt>
<dd><p>Unit of time for the output variable. Options are:</p><ul><li><p>Days: "day", "days", "d"</p></li>
<li><p>Hours: "hour", "hours", "hr", "hrs", "h" (default: "hours")</p></li>
<li><p>Minutes: "minute", "minutes", "min", "mins"</p></li>
<li><p>Weeks: "week", "weeks", "wk", "wks", "w"</p></li>
</ul><p>Case-insensitive. The internal calculation is performed in hours, then
converted to the specified unit. If <code>new_var_unit</code> is specified, it will
contain the value exactly as provided by the user.</p>
<dl><dt>Permitted values</dt>
<dd><p>Character scalar (see options above)</p></dd>

<dt>Default value</dt>
<dd><p><code>"HOURS"</code></p></dd>


</dl></dd>


<dt id="arg-tpt-var">tpt_var<a class="anchor" aria-label="anchor" href="#arg-tpt-var"></a></dt>
<dd><p>Timepoint variable containing descriptions like "Pre-dose",
"1H Post-dose", etc. (unquoted). If not provided or if the variable
doesn't exist in the dataset, only the visit day offset is calculated
(timepoint contribution is 0).</p>
<dl><dt>Permitted values</dt>
<dd><p>Unquoted variable name (optional)</p></dd>

<dt>Default value</dt>
<dd><p><code>NULL</code></p></dd>


</dl></dd>


<dt id="arg-visit-day">visit_day<a class="anchor" aria-label="anchor" href="#arg-visit-day"></a></dt>
<dd><p>Visit day variable (unquoted). This should be the planned/
nominal visit day (e.g., <code>VISITDY</code>). Records with <code>NA</code> in this variable
will have NFRLT set to <code>NA</code>.</p>
<dl><dt>Permitted values</dt>
<dd><p>Unquoted variable name</p></dd>

<dt>Default value</dt>
<dd><p>none</p></dd>


</dl></dd>


<dt id="arg-first-dose-day">first_dose_day<a class="anchor" aria-label="anchor" href="#arg-first-dose-day"></a></dt>
<dd><p>The day number considered as the first dose day.
Default is 1. For multiple-dose studies, this is typically Day 1.</p>
<dl><dt>Permitted values</dt>
<dd><p>Numeric scalar (positive integer)</p></dd>

<dt>Default value</dt>
<dd><p><code>1</code></p></dd>


</dl></dd>


<dt id="arg-treatment-duration">treatment_duration<a class="anchor" aria-label="anchor" href="#arg-treatment-duration"></a></dt>
<dd><p>Duration of treatment in hours. Can be either:</p><ul><li><p>A numeric scalar (used for all records), or</p></li>
<li><p>An unquoted variable name from the dataset (e.g., <code>EXDUR</code>) where each
record can have a different treatment duration</p></li>
</ul><p>Passed to <code><a href="convert_xxtpt_to_hours.html">convert_xxtpt_to_hours()</a></code>. Must be non-negative. Default is 0
hours (for instantaneous treatments like oral medications).</p>
<dl><dt>Permitted values</dt>
<dd><p>Numeric scalar or unquoted variable name (non-negative)</p></dd>

<dt>Default value</dt>
<dd><p><code>0</code></p></dd>


</dl></dd>


<dt id="arg-range-method">range_method<a class="anchor" aria-label="anchor" href="#arg-range-method"></a></dt>
<dd><p>Method for converting time ranges to single values.
Options are "midpoint" (default), "start", or "end". Passed to
<code><a href="convert_xxtpt_to_hours.html">convert_xxtpt_to_hours()</a></code>. For example, "0-6h" with midpoint returns 3,
with start returns 0, with end returns 6.</p>
<dl><dt>Permitted values</dt>
<dd><p>Character scalar ("midpoint", "start", or "end")</p></dd>

<dt>Default value</dt>
<dd><p><code>"midpoint"</code></p></dd>


</dl></dd>


<dt id="arg-set-values-to-na">set_values_to_na<a class="anchor" aria-label="anchor" href="#arg-set-values-to-na"></a></dt>
<dd><p>An optional condition that marks derived NFRLT
values as <code>NA</code>. For example, <code>set_values_to_na = VISIT == "UNSCHEDULED"</code>
will set NFRLT to <code>NA</code> for all unscheduled visits. Can use any variables
in the dataset. When <code>new_var_unit</code> is specified, the unit variable will
also be set to <code>NA</code> for these records.</p>
<dl><dt>Permitted values</dt>
<dd><p>Condition (optional)</p></dd>

<dt>Default value</dt>
<dd><p><code>NULL</code></p></dd>


</dl></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>The input dataset with the new nominal relative time variable added,
and optionally the unit variable if <code>new_var_unit</code> is specified.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The nominal relative time is calculated as:</p>
<p><code>NFRLT = (day_offset * 24 + timepoint_hours) * conversion_factor</code></p>
<p>Where:</p><ul><li><p><code>day_offset</code> is calculated from <code>visit_day</code> and <code>first_dose_day</code>,
accounting for the absence of Day 0 in clinical trial convention</p></li>
<li><p><code>timepoint_hours</code> is derived from the timepoint description using
<code><a href="convert_xxtpt_to_hours.html">convert_xxtpt_to_hours()</a></code>, or 0 if <code>tpt_var</code> is not provided</p></li>
<li><p><code>conversion_factor</code> is:</p><ul><li><p>1 for "hours" (default)</p></li>
<li><p>1/24 for "days"</p></li>
<li><p>1/168 for "weeks" (1/24/7)</p></li>
<li><p>60 for "minutes"</p></li>
</ul></li>
</ul><p>If <code>new_var_unit</code> is specified, a character variable is created containing
the value of <code>out_unit</code> exactly as provided by the user. For example:</p><ul><li><p><code>out_unit = "hours"</code> creates unit variable with value "hours"</p></li>
<li><p><code>out_unit = "HOURS"</code> creates unit variable with value "HOURS"</p></li>
<li><p><code>out_unit = "Days"</code> creates unit variable with value "Days"</p></li>
<li><p><code>NA</code> when the corresponding time value is <code>NA</code></p></li>
</ul><p>This matches the behavior of <code><a href="derive_vars_duration.html">derive_vars_duration()</a></code> and allows
consistency when deriving multiple time variables.</p>
<p><strong>Handling "No Day 0":</strong></p>
<p>In clinical trials, day numbering typically follows the convention:
..., Day -2, Day -1, Day 1, Day 2, ... (no Day 0). This function accounts
for this by adjusting the day offset when <code>visit_day</code> is negative and
<code>first_dose_day</code> is positive.</p>
<p>For example, with <code>first_dose_day = 1</code> and different output units:</p><ul><li><p>Day -1, <code>out_unit = "hours"</code> -&gt; -24 hours</p></li>
<li><p>Day -1, <code>out_unit = "days"</code> -&gt; -1 day</p></li>
<li><p>Day -1, <code>out_unit = "weeks"</code> -&gt; -0.1429 weeks</p></li>
<li><p>Day -1, <code>out_unit = "minutes"</code> -&gt; -1440 minutes</p></li>
<li><p>Day -7 -&gt; -168 hours, -7 days, -1 week, or -10080 minutes</p></li>
<li><p>Day 1 -&gt; 0 (in any unit, first dose day)</p></li>
<li><p>Day 8 -&gt; 168 hours, 7 days, 1 week, or 10080 minutes</p></li>
</ul><p>With <code>first_dose_day = 7</code>:</p><ul><li><p>Day -1 -&gt; -168 hours, -7 days, -1 week, or -10080 minutes</p></li>
<li><p>Day 1 -&gt; -144 hours, -6 days, -0.857 weeks, or -8640 minutes</p></li>
<li><p>Day 6 -&gt; -24 hours, -1 day, -0.143 weeks, or -1440 minutes</p></li>
<li><p>Day 7 -&gt; 0 (in any unit, first dose day)</p></li>
</ul><p><strong>Common Use Cases:</strong></p><ul><li><p><strong>Single dose study</strong>: Day 1 only, with samples at various timepoints
(e.g., Pre-dose, 1H, 2H, 4H, 8H, 24H)</p></li>
<li><p><strong>Multiple dose study</strong>: Dosing on multiple days (e.g., Day 1, Day 8,
Day 15) with samples around each dose</p></li>
<li><p><strong>Screening visits</strong>: Negative visit days (e.g., Day -14, Day -7) before
first dose</p></li>
<li><p><strong>Steady state study</strong>: Multiple daily doses with sampling on specific
days</p></li>
<li><p><strong>Oral medications</strong>: Use default <code>treatment_duration = 0</code> for
instantaneous absorption</p></li>
<li><p><strong>IV infusions</strong>: Specify <code>treatment_duration</code> as infusion duration in
hours (scalar) or as a variable name containing duration per record</p></li>
<li><p><strong>Exposure records (EX)</strong>: Can be called without <code>tpt_var</code> to derive
NFRLT based only on visit day</p></li>
<li><p><strong>Unscheduled visits</strong>: Use <code>set_values_to_na</code> to set NFRLT to <code>NA</code> for
unscheduled or early discontinuation visits</p></li>
<li><p><strong>Variable treatment durations</strong>: Use a variable name (e.g., <code>EXDUR</code>)
when different subjects or visits have different treatment durations</p></li>
<li><p><strong>Hours output</strong>: Use <code>out_unit = "hours"</code> (default) for variables like
<code>NFRLT</code> with <code>FRLTU</code></p></li>
<li><p><strong>Days output</strong>: Use <code>out_unit = "days"</code> for variables like <code>NFRLTDY</code>
with <code>FRLTU</code></p></li>
<li><p><strong>Weeks output</strong>: Use <code>out_unit = "weeks"</code> for long-term studies with
weekly dosing</p></li>
<li><p><strong>Minutes output</strong>: Use <code>out_unit = "minutes"</code> for very short-term PK
studies or when minute precision is needed</p></li>
<li><p><strong>CDISC compliance</strong>: Use <code>new_var_unit = FRLTU</code> for first dose relative
time or <code>new_var_unit = RRLTU</code> for reference relative time</p></li>
<li><p><strong>Consistency with duration</strong>: Use the same case for <code>out_unit</code> across
<code><a href="derive_vars_duration.html">derive_vars_duration()</a></code> and <code>derive_var_nfrlt()</code> to ensure unit
variables match</p></li>
</ul><p><strong>Important Notes:</strong></p><ul><li><p>The function assumes <code>visit_day</code> represents the nominal/planned day, not
the actual study day</p></li>
<li><p>Day numbering follows clinical trial convention with no Day 0</p></li>
<li><p>For timepoints that span multiple days (e.g., "24H Post-dose"), ensure
<code>visit_day</code> is set to the day when the sample was taken. For example, if
dosing occurs on Day 3, a "24H Post-dose" sample taken on Day 4 should
have <code>visit_day = 4</code>.</p></li>
<li><p>For crossover studies, consider deriving NFRLT separately per period</p></li>
<li><p><code>NA</code> values in <code>visit_day</code> will automatically result in <code>NA</code> for NFRLT
(no need to use <code>set_values_to_na</code> for this case)</p></li>
<li><p><code>NA</code> values in <code>tpt_var</code> will result in <code>NA</code> for NFRLT</p></li>
<li><p><code>NA</code> values in the <code>treatment_duration</code> variable (if using a variable)
will result in <code>NA</code> for NFRLT for those records</p></li>
<li><p>Use <code>set_values_to_na</code> when you need to set NFRLT to <code>NA</code> based on other
variables (e.g., <code>VISIT == "UNSCHEDULED"</code>), especially when <code>visit_day</code>
is populated but should not be used for the NFRLT calculation</p></li>
<li><p>If <code>tpt_var</code> is not provided or doesn't exist in the dataset, timepoint
contribution is assumed to be 0 hours</p></li>
<li><p>When using non-hour units, timepoint contributions are still calculated
in hours first (e.g., "2H Post-dose" = 2 hours), then the entire result
is converted to the specified unit</p></li>
<li><p>The unit variable (if created) will contain the exact value provided in
<code>out_unit</code>, preserving case and format</p></li>
</ul><p><strong>Setting Special Values:</strong></p>
<p>If you need to set NFRLT to a specific value (e.g., 99999) for certain
visits instead of <code>NA</code>, use <code>set_values_to_na</code> first to set them to <code>NA</code>,
then use a subsequent <code><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate()</a></code> call to replace those <code>NA</code> values:</p>
<p></p><div class="sourceCode r"><pre><code><span><span class="va">dataset</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/derive_var_nfrlt.html">derive_var_nfrlt</a></span><span class="op">(</span></span>
<span>    <span class="va">...</span>,</span>
<span>    set_values_to_na <span class="op">=</span> <span class="va">VISIT</span> <span class="op">==</span> <span class="st">"UNSCHEDULED"</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>NFRLT <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/if_else.html" class="external-link">if_else</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">NFRLT</span><span class="op">)</span> <span class="op">&amp;</span> <span class="va">VISIT</span> <span class="op">==</span> <span class="st">"UNSCHEDULED"</span>, <span class="fl">99999</span>, <span class="va">NFRLT</span><span class="op">)</span><span class="op">)</span></span></code></pre><p></p></div>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="convert_xxtpt_to_hours.html">convert_xxtpt_to_hours()</a></code>, <code><a href="derive_vars_duration.html">derive_vars_duration()</a></code></p>
<p>BDS-Findings Functions that returns variable appended to dataset:
<code><a href="derive_basetype_records.html">derive_basetype_records</a>()</code>,
<code><a href="derive_var_analysis_ratio.html">derive_var_analysis_ratio</a>()</code>,
<code><a href="derive_var_anrind.html">derive_var_anrind</a>()</code>,
<code><a href="derive_var_atoxgr.html">derive_var_atoxgr</a>()</code>,
<code><a href="derive_var_atoxgr_dir.html">derive_var_atoxgr_dir</a>()</code>,
<code><a href="derive_var_base.html">derive_var_base</a>()</code>,
<code><a href="derive_var_chg.html">derive_var_chg</a>()</code>,
<code><a href="derive_var_ontrtfl.html">derive_var_ontrtfl</a>()</code>,
<code><a href="derive_var_pchg.html">derive_var_pchg</a>()</code>,
<code><a href="derive_var_shift.html">derive_var_shift</a>()</code>,
<code><a href="derive_vars_crit_flag.html">derive_vars_crit_flag</a>()</code></p></div>
    </div>
    <div class="section level2">
    <h2 id="examples">Examples<a class="anchor" aria-label="anchor" href="#examples"></a></h2>

<div class="section">
<h3 id="single-dose-study">Single dose study<a class="anchor" aria-label="anchor" href="#single-dose-study"></a></h3>


<p>Day 1 only with oral medication</p>
<p></p><div class="sourceCode r"><pre><code><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tibble.tidyverse.org/" class="external-link">tibble</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">adpc</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tribble.html" class="external-link">tribble</a></span><span class="op">(</span></span>
<span>  <span class="op">~</span><span class="va">USUBJID</span>, <span class="op">~</span><span class="va">VISITDY</span>, <span class="op">~</span><span class="va">PCTPT</span>,</span>
<span>  <span class="st">"001"</span>,    <span class="fl">1</span>,        <span class="st">"Pre-dose"</span>,</span>
<span>  <span class="st">"001"</span>,    <span class="fl">1</span>,        <span class="st">"1H Post-dose"</span>,</span>
<span>  <span class="st">"001"</span>,    <span class="fl">1</span>,        <span class="st">"2H Post-dose"</span>,</span>
<span>  <span class="st">"001"</span>,    <span class="fl">1</span>,        <span class="st">"4H Post-dose"</span>,</span>
<span>  <span class="st">"001"</span>,    <span class="fl">1</span>,        <span class="st">"24H Post-dose"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/derive_var_nfrlt.html">derive_var_nfrlt</a></span><span class="op">(</span></span>
<span>  <span class="va">adpc</span>,</span>
<span>  new_var <span class="op">=</span> <span class="va">NFRLT</span>,</span>
<span>  tpt_var <span class="op">=</span> <span class="va">PCTPT</span>,</span>
<span>  visit_day <span class="op">=</span> <span class="va">VISITDY</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 5 Ã— 4</span></span>
<span><span class="co">#&gt;   USUBJID VISITDY PCTPT         NFRLT</span></span>
<span><span class="co">#&gt;   &lt;chr&gt;     &lt;dbl&gt; &lt;chr&gt;         &lt;dbl&gt;</span></span>
<span><span class="co">#&gt; 1 001           1 Pre-dose          0</span></span>
<span><span class="co">#&gt; 2 001           1 1H Post-dose      1</span></span>
<span><span class="co">#&gt; 3 001           1 2H Post-dose      2</span></span>
<span><span class="co">#&gt; 4 001           1 4H Post-dose      4</span></span>
<span><span class="co">#&gt; 5 001           1 24H Post-dose    24</span></span></code></pre><p></p></div>
</div>
<div class="section">
<h3 id="single-dose-study-with-unit-variable">Single dose study with unit variable<a class="anchor" aria-label="anchor" href="#single-dose-study-with-unit-variable"></a></h3>


<p>Creating NFRLT with FRLTU unit variable</p>
<p></p><div class="sourceCode r"><pre><code><span><span class="fu"><a href="../reference/derive_var_nfrlt.html">derive_var_nfrlt</a></span><span class="op">(</span></span>
<span>  <span class="va">adpc</span>,</span>
<span>  new_var <span class="op">=</span> <span class="va">NFRLT</span>,</span>
<span>  new_var_unit <span class="op">=</span> <span class="va">FRLTU</span>,</span>
<span>  tpt_var <span class="op">=</span> <span class="va">PCTPT</span>,</span>
<span>  visit_day <span class="op">=</span> <span class="va">VISITDY</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 5 Ã— 5</span></span>
<span><span class="co">#&gt;   USUBJID VISITDY PCTPT         NFRLT FRLTU</span></span>
<span><span class="co">#&gt;   &lt;chr&gt;     &lt;dbl&gt; &lt;chr&gt;         &lt;dbl&gt; &lt;chr&gt;</span></span>
<span><span class="co">#&gt; 1 001           1 Pre-dose          0 HOURS</span></span>
<span><span class="co">#&gt; 2 001           1 1H Post-dose      1 HOURS</span></span>
<span><span class="co">#&gt; 3 001           1 2H Post-dose      2 HOURS</span></span>
<span><span class="co">#&gt; 4 001           1 4H Post-dose      4 HOURS</span></span>
<span><span class="co">#&gt; 5 001           1 24H Post-dose    24 HOURS</span></span></code></pre><p></p></div>
</div>
<div class="section">
<h3 id="single-dose-study-with-different-output-units">Single dose study with different output units<a class="anchor" aria-label="anchor" href="#single-dose-study-with-different-output-units"></a></h3>


<p>Deriving NFRLT in different time units with unit variables</p>
<p></p><div class="sourceCode r"><pre><code><span><span class="va">adpc</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/derive_var_nfrlt.html">derive_var_nfrlt</a></span><span class="op">(</span></span>
<span>    new_var <span class="op">=</span> <span class="va">NFRLT</span>,</span>
<span>    new_var_unit <span class="op">=</span> <span class="va">FRLTU</span>,</span>
<span>    out_unit <span class="op">=</span> <span class="st">"HOURS"</span>,</span>
<span>    tpt_var <span class="op">=</span> <span class="va">PCTPT</span>,</span>
<span>    visit_day <span class="op">=</span> <span class="va">VISITDY</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/derive_var_nfrlt.html">derive_var_nfrlt</a></span><span class="op">(</span></span>
<span>    new_var <span class="op">=</span> <span class="va">NFRLTDY</span>,</span>
<span>    new_var_unit <span class="op">=</span> <span class="va">FRLTDYU</span>,</span>
<span>    out_unit <span class="op">=</span> <span class="st">"days"</span>,</span>
<span>    tpt_var <span class="op">=</span> <span class="va">PCTPT</span>,</span>
<span>    visit_day <span class="op">=</span> <span class="va">VISITDY</span></span>
<span>  <span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 5 Ã— 7</span></span>
<span><span class="co">#&gt;   USUBJID VISITDY PCTPT         NFRLT FRLTU NFRLTDY FRLTDYU</span></span>
<span><span class="co">#&gt;   &lt;chr&gt;     &lt;dbl&gt; &lt;chr&gt;         &lt;dbl&gt; &lt;chr&gt;   &lt;dbl&gt; &lt;chr&gt;</span></span>
<span><span class="co">#&gt; 1 001           1 Pre-dose          0 HOURS  0      days</span></span>
<span><span class="co">#&gt; 2 001           1 1H Post-dose      1 HOURS  0.0417 days</span></span>
<span><span class="co">#&gt; 3 001           1 2H Post-dose      2 HOURS  0.0833 days</span></span>
<span><span class="co">#&gt; 4 001           1 4H Post-dose      4 HOURS  0.167  days</span></span>
<span><span class="co">#&gt; 5 001           1 24H Post-dose    24 HOURS  1      days   </span></span></code></pre><p></p></div>
</div>
<div class="section">
<h3 id="study-with-screening-visits">Study with screening visits<a class="anchor" aria-label="anchor" href="#study-with-screening-visits"></a></h3>


<p>Handling negative visit days (no Day 0 in clinical trials)</p>
<p></p><div class="sourceCode r"><pre><code><span><span class="va">adpc_screen</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tribble.html" class="external-link">tribble</a></span><span class="op">(</span></span>
<span>  <span class="op">~</span><span class="va">USUBJID</span>, <span class="op">~</span><span class="va">VISITDY</span>, <span class="op">~</span><span class="va">PCTPT</span>,</span>
<span>  <span class="st">"001"</span>,    <span class="op">-</span><span class="fl">14</span>,      <span class="st">"Screening"</span>,</span>
<span>  <span class="st">"001"</span>,    <span class="op">-</span><span class="fl">7</span>,       <span class="st">"Pre-dose"</span>,</span>
<span>  <span class="st">"001"</span>,    <span class="op">-</span><span class="fl">1</span>,       <span class="st">"Pre-dose"</span>,</span>
<span>  <span class="st">"001"</span>,    <span class="fl">1</span>,        <span class="st">"Pre-dose"</span>,</span>
<span>  <span class="st">"001"</span>,    <span class="fl">1</span>,        <span class="st">"2H Post-dose"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/derive_var_nfrlt.html">derive_var_nfrlt</a></span><span class="op">(</span></span>
<span>  <span class="va">adpc_screen</span>,</span>
<span>  new_var <span class="op">=</span> <span class="va">NFRLT</span>,</span>
<span>  new_var_unit <span class="op">=</span> <span class="va">FRLTU</span>,</span>
<span>  tpt_var <span class="op">=</span> <span class="va">PCTPT</span>,</span>
<span>  visit_day <span class="op">=</span> <span class="va">VISITDY</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 5 Ã— 5</span></span>
<span><span class="co">#&gt;   USUBJID VISITDY PCTPT        NFRLT FRLTU</span></span>
<span><span class="co">#&gt;   &lt;chr&gt;     &lt;dbl&gt; &lt;chr&gt;        &lt;dbl&gt; &lt;chr&gt;</span></span>
<span><span class="co">#&gt; 1 001         -14 Screening     -336 HOURS</span></span>
<span><span class="co">#&gt; 2 001          -7 Pre-dose      -168 HOURS</span></span>
<span><span class="co">#&gt; 3 001          -1 Pre-dose       -24 HOURS</span></span>
<span><span class="co">#&gt; 4 001           1 Pre-dose         0 HOURS</span></span>
<span><span class="co">#&gt; 5 001           1 2H Post-dose     2 HOURS</span></span></code></pre><p></p></div>
</div>
<div class="section">
<h3 id="multiple-dose-study">Multiple dose study<a class="anchor" aria-label="anchor" href="#multiple-dose-study"></a></h3>


<p>Dosing on Days 1, 8, and 15</p>
<p></p><div class="sourceCode r"><pre><code><span><span class="va">adpc_md</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tribble.html" class="external-link">tribble</a></span><span class="op">(</span></span>
<span>  <span class="op">~</span><span class="va">USUBJID</span>, <span class="op">~</span><span class="va">VISITDY</span>, <span class="op">~</span><span class="va">PCTPT</span>,</span>
<span>  <span class="st">"001"</span>,    <span class="fl">1</span>,        <span class="st">"Pre-dose"</span>,</span>
<span>  <span class="st">"001"</span>,    <span class="fl">1</span>,        <span class="st">"2H Post-dose"</span>,</span>
<span>  <span class="st">"001"</span>,    <span class="fl">8</span>,        <span class="st">"Pre-dose"</span>,</span>
<span>  <span class="st">"001"</span>,    <span class="fl">8</span>,        <span class="st">"2H Post-dose"</span>,</span>
<span>  <span class="st">"001"</span>,    <span class="fl">15</span>,       <span class="st">"Pre-dose"</span>,</span>
<span>  <span class="st">"001"</span>,    <span class="fl">15</span>,       <span class="st">"2H Post-dose"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/derive_var_nfrlt.html">derive_var_nfrlt</a></span><span class="op">(</span></span>
<span>  <span class="va">adpc_md</span>,</span>
<span>  new_var <span class="op">=</span> <span class="va">NFRLT</span>,</span>
<span>  new_var_unit <span class="op">=</span> <span class="va">FRLTU</span>,</span>
<span>  tpt_var <span class="op">=</span> <span class="va">PCTPT</span>,</span>
<span>  visit_day <span class="op">=</span> <span class="va">VISITDY</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 6 Ã— 5</span></span>
<span><span class="co">#&gt;   USUBJID VISITDY PCTPT        NFRLT FRLTU</span></span>
<span><span class="co">#&gt;   &lt;chr&gt;     &lt;dbl&gt; &lt;chr&gt;        &lt;dbl&gt; &lt;chr&gt;</span></span>
<span><span class="co">#&gt; 1 001           1 Pre-dose         0 HOURS</span></span>
<span><span class="co">#&gt; 2 001           1 2H Post-dose     2 HOURS</span></span>
<span><span class="co">#&gt; 3 001           8 Pre-dose       168 HOURS</span></span>
<span><span class="co">#&gt; 4 001           8 2H Post-dose   170 HOURS</span></span>
<span><span class="co">#&gt; 5 001          15 Pre-dose       336 HOURS</span></span>
<span><span class="co">#&gt; 6 001          15 2H Post-dose   338 HOURS</span></span></code></pre><p></p></div>
</div>
<div class="section">
<h3 id="multiple-dose-study-with-days-output">Multiple dose study with days output<a class="anchor" aria-label="anchor" href="#multiple-dose-study-with-days-output"></a></h3>


<p>Deriving both NFRLT (hours) and NFRLTDY (days) with unit variables</p>
<p></p><div class="sourceCode r"><pre><code><span><span class="va">adpc_md</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/derive_var_nfrlt.html">derive_var_nfrlt</a></span><span class="op">(</span></span>
<span>    new_var <span class="op">=</span> <span class="va">NFRLT</span>,</span>
<span>    new_var_unit <span class="op">=</span> <span class="va">FRLTU</span>,</span>
<span>    tpt_var <span class="op">=</span> <span class="va">PCTPT</span>,</span>
<span>    visit_day <span class="op">=</span> <span class="va">VISITDY</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/derive_var_nfrlt.html">derive_var_nfrlt</a></span><span class="op">(</span></span>
<span>    new_var <span class="op">=</span> <span class="va">NFRLTDY</span>,</span>
<span>    new_var_unit <span class="op">=</span> <span class="va">FRLTDYU</span>,</span>
<span>    out_unit <span class="op">=</span> <span class="st">"days"</span>,</span>
<span>    tpt_var <span class="op">=</span> <span class="va">PCTPT</span>,</span>
<span>    visit_day <span class="op">=</span> <span class="va">VISITDY</span></span>
<span>  <span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 6 Ã— 7</span></span>
<span><span class="co">#&gt;   USUBJID VISITDY PCTPT        NFRLT FRLTU NFRLTDY FRLTDYU</span></span>
<span><span class="co">#&gt;   &lt;chr&gt;     &lt;dbl&gt; &lt;chr&gt;        &lt;dbl&gt; &lt;chr&gt;   &lt;dbl&gt; &lt;chr&gt;</span></span>
<span><span class="co">#&gt; 1 001           1 Pre-dose         0 HOURS  0      days</span></span>
<span><span class="co">#&gt; 2 001           1 2H Post-dose     2 HOURS  0.0833 days</span></span>
<span><span class="co">#&gt; 3 001           8 Pre-dose       168 HOURS  7      days</span></span>
<span><span class="co">#&gt; 4 001           8 2H Post-dose   170 HOURS  7.08   days</span></span>
<span><span class="co">#&gt; 5 001          15 Pre-dose       336 HOURS 14      days</span></span>
<span><span class="co">#&gt; 6 001          15 2H Post-dose   338 HOURS 14.1    days   </span></span></code></pre><p></p></div>
</div>
<div class="section">
<h3 id="weekly-dosing-study">Weekly dosing study<a class="anchor" aria-label="anchor" href="#weekly-dosing-study"></a></h3>


<p>Long-term study with weekly dosing, using weeks output</p>
<p></p><div class="sourceCode r"><pre><code><span><span class="va">adpc_weekly</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tribble.html" class="external-link">tribble</a></span><span class="op">(</span></span>
<span>  <span class="op">~</span><span class="va">USUBJID</span>, <span class="op">~</span><span class="va">VISITDY</span>, <span class="op">~</span><span class="va">PCTPT</span>,</span>
<span>  <span class="st">"001"</span>,    <span class="fl">1</span>,        <span class="st">"Pre-dose"</span>,</span>
<span>  <span class="st">"001"</span>,    <span class="fl">8</span>,        <span class="st">"Pre-dose"</span>,</span>
<span>  <span class="st">"001"</span>,    <span class="fl">15</span>,       <span class="st">"Pre-dose"</span>,</span>
<span>  <span class="st">"001"</span>,    <span class="fl">22</span>,       <span class="st">"Pre-dose"</span>,</span>
<span>  <span class="st">"001"</span>,    <span class="fl">29</span>,       <span class="st">"Pre-dose"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/derive_var_nfrlt.html">derive_var_nfrlt</a></span><span class="op">(</span></span>
<span>  <span class="va">adpc_weekly</span>,</span>
<span>  new_var <span class="op">=</span> <span class="va">NFRLTWK</span>,</span>
<span>  new_var_unit <span class="op">=</span> <span class="va">FRLTU</span>,</span>
<span>  out_unit <span class="op">=</span> <span class="st">"weeks"</span>,</span>
<span>  tpt_var <span class="op">=</span> <span class="va">PCTPT</span>,</span>
<span>  visit_day <span class="op">=</span> <span class="va">VISITDY</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 5 Ã— 5</span></span>
<span><span class="co">#&gt;   USUBJID VISITDY PCTPT    NFRLTWK FRLTU</span></span>
<span><span class="co">#&gt;   &lt;chr&gt;     &lt;dbl&gt; &lt;chr&gt;      &lt;dbl&gt; &lt;chr&gt;</span></span>
<span><span class="co">#&gt; 1 001           1 Pre-dose       0 weeks</span></span>
<span><span class="co">#&gt; 2 001           8 Pre-dose       1 weeks</span></span>
<span><span class="co">#&gt; 3 001          15 Pre-dose       2 weeks</span></span>
<span><span class="co">#&gt; 4 001          22 Pre-dose       3 weeks</span></span>
<span><span class="co">#&gt; 5 001          29 Pre-dose       4 weeks</span></span></code></pre><p></p></div>
</div>
<div class="section">
<h3 id="short-term-pk-study-with-minutes">Short-term PK study with minutes<a class="anchor" aria-label="anchor" href="#short-term-pk-study-with-minutes"></a></h3>


<p>Very short timepoints requiring minute precision</p>
<p></p><div class="sourceCode r"><pre><code><span><span class="va">adpc_short</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tribble.html" class="external-link">tribble</a></span><span class="op">(</span></span>
<span>  <span class="op">~</span><span class="va">USUBJID</span>, <span class="op">~</span><span class="va">VISITDY</span>, <span class="op">~</span><span class="va">PCTPT</span>,</span>
<span>  <span class="st">"001"</span>,    <span class="fl">1</span>,        <span class="st">"Pre-dose"</span>,</span>
<span>  <span class="st">"001"</span>,    <span class="fl">1</span>,        <span class="st">"5 MIN POST"</span>,</span>
<span>  <span class="st">"001"</span>,    <span class="fl">1</span>,        <span class="st">"15 MIN POST"</span>,</span>
<span>  <span class="st">"001"</span>,    <span class="fl">1</span>,        <span class="st">"30 MIN POST"</span>,</span>
<span>  <span class="st">"001"</span>,    <span class="fl">1</span>,        <span class="st">"1H POST"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/derive_var_nfrlt.html">derive_var_nfrlt</a></span><span class="op">(</span></span>
<span>  <span class="va">adpc_short</span>,</span>
<span>  new_var <span class="op">=</span> <span class="va">NFRLTMIN</span>,</span>
<span>  new_var_unit <span class="op">=</span> <span class="va">FRLTU</span>,</span>
<span>  out_unit <span class="op">=</span> <span class="st">"minutes"</span>,</span>
<span>  tpt_var <span class="op">=</span> <span class="va">PCTPT</span>,</span>
<span>  visit_day <span class="op">=</span> <span class="va">VISITDY</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 5 Ã— 5</span></span>
<span><span class="co">#&gt;   USUBJID VISITDY PCTPT       NFRLTMIN FRLTU</span></span>
<span><span class="co">#&gt;   &lt;chr&gt;     &lt;dbl&gt; &lt;chr&gt;          &lt;dbl&gt; &lt;chr&gt;</span></span>
<span><span class="co">#&gt; 1 001           1 Pre-dose           0 minutes</span></span>
<span><span class="co">#&gt; 2 001           1 5 MIN POST         5 minutes</span></span>
<span><span class="co">#&gt; 3 001           1 15 MIN POST       15 minutes</span></span>
<span><span class="co">#&gt; 4 001           1 30 MIN POST       30 minutes</span></span>
<span><span class="co">#&gt; 5 001           1 1H POST           60 minutes</span></span></code></pre><p></p></div>
</div>
<div class="section">
<h3 id="custom-first-dose-day">Custom first dose day<a class="anchor" aria-label="anchor" href="#custom-first-dose-day"></a></h3>


<p>First dose on Day 7 instead of Day 1</p>
<p></p><div class="sourceCode r"><pre><code><span><span class="va">adpc_day7</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tribble.html" class="external-link">tribble</a></span><span class="op">(</span></span>
<span>  <span class="op">~</span><span class="va">USUBJID</span>, <span class="op">~</span><span class="va">VISITDY</span>, <span class="op">~</span><span class="va">PCTPT</span>,</span>
<span>  <span class="st">"001"</span>,    <span class="op">-</span><span class="fl">1</span>,       <span class="st">"Pre-dose"</span>,</span>
<span>  <span class="st">"001"</span>,    <span class="fl">1</span>,        <span class="st">"Pre-dose"</span>,</span>
<span>  <span class="st">"001"</span>,    <span class="fl">6</span>,        <span class="st">"Pre-dose"</span>,</span>
<span>  <span class="st">"001"</span>,    <span class="fl">7</span>,        <span class="st">"Pre-dose"</span>,</span>
<span>  <span class="st">"001"</span>,    <span class="fl">8</span>,        <span class="st">"Pre-dose"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/derive_var_nfrlt.html">derive_var_nfrlt</a></span><span class="op">(</span></span>
<span>  <span class="va">adpc_day7</span>,</span>
<span>  new_var <span class="op">=</span> <span class="va">NFRLT</span>,</span>
<span>  new_var_unit <span class="op">=</span> <span class="va">FRLTU</span>,</span>
<span>  tpt_var <span class="op">=</span> <span class="va">PCTPT</span>,</span>
<span>  visit_day <span class="op">=</span> <span class="va">VISITDY</span>,</span>
<span>  first_dose_day <span class="op">=</span> <span class="fl">7</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 5 Ã— 5</span></span>
<span><span class="co">#&gt;   USUBJID VISITDY PCTPT    NFRLT FRLTU</span></span>
<span><span class="co">#&gt;   &lt;chr&gt;     &lt;dbl&gt; &lt;chr&gt;    &lt;dbl&gt; &lt;chr&gt;</span></span>
<span><span class="co">#&gt; 1 001          -1 Pre-dose  -168 HOURS</span></span>
<span><span class="co">#&gt; 2 001           1 Pre-dose  -144 HOURS</span></span>
<span><span class="co">#&gt; 3 001           6 Pre-dose   -24 HOURS</span></span>
<span><span class="co">#&gt; 4 001           7 Pre-dose     0 HOURS</span></span>
<span><span class="co">#&gt; 5 001           8 Pre-dose    24 HOURS</span></span></code></pre><p></p></div>
</div>
<div class="section">
<h3 id="iv-infusion-with-scalar-treatment-duration">IV infusion with scalar treatment duration<a class="anchor" aria-label="anchor" href="#iv-infusion-with-scalar-treatment-duration"></a></h3>


<p>2-hour infusion duration for all records</p>
<p></p><div class="sourceCode r"><pre><code><span><span class="va">adpc_inf</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tribble.html" class="external-link">tribble</a></span><span class="op">(</span></span>
<span>  <span class="op">~</span><span class="va">USUBJID</span>, <span class="op">~</span><span class="va">VISITDY</span>, <span class="op">~</span><span class="va">PCTPT</span>,</span>
<span>  <span class="st">"001"</span>,    <span class="fl">1</span>,        <span class="st">"Pre-dose"</span>,</span>
<span>  <span class="st">"001"</span>,    <span class="fl">1</span>,        <span class="st">"EOI"</span>,</span>
<span>  <span class="st">"001"</span>,    <span class="fl">1</span>,        <span class="st">"1H Post EOI"</span>,</span>
<span>  <span class="st">"001"</span>,    <span class="fl">1</span>,        <span class="st">"10MIN PRE EOI"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/derive_var_nfrlt.html">derive_var_nfrlt</a></span><span class="op">(</span></span>
<span>  <span class="va">adpc_inf</span>,</span>
<span>  new_var <span class="op">=</span> <span class="va">NFRLT</span>,</span>
<span>  new_var_unit <span class="op">=</span> <span class="va">FRLTU</span>,</span>
<span>  tpt_var <span class="op">=</span> <span class="va">PCTPT</span>,</span>
<span>  visit_day <span class="op">=</span> <span class="va">VISITDY</span>,</span>
<span>  treatment_duration <span class="op">=</span> <span class="fl">2</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 4 Ã— 5</span></span>
<span><span class="co">#&gt;   USUBJID VISITDY PCTPT         NFRLT FRLTU</span></span>
<span><span class="co">#&gt;   &lt;chr&gt;     &lt;dbl&gt; &lt;chr&gt;         &lt;dbl&gt; &lt;chr&gt;</span></span>
<span><span class="co">#&gt; 1 001           1 Pre-dose       0    HOURS</span></span>
<span><span class="co">#&gt; 2 001           1 EOI            2    HOURS</span></span>
<span><span class="co">#&gt; 3 001           1 1H Post EOI    3    HOURS</span></span>
<span><span class="co">#&gt; 4 001           1 10MIN PRE EOI  1.83 HOURS</span></span></code></pre><p></p></div>
</div>
<div class="section">
<h3 id="variable-treatment-duration">Variable treatment duration<a class="anchor" aria-label="anchor" href="#variable-treatment-duration"></a></h3>


<p>Different treatment durations per subject using a variable</p>
<p></p><div class="sourceCode r"><pre><code><span><span class="va">adpc_var_dur</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tribble.html" class="external-link">tribble</a></span><span class="op">(</span></span>
<span>  <span class="op">~</span><span class="va">USUBJID</span>, <span class="op">~</span><span class="va">VISITDY</span>, <span class="op">~</span><span class="va">PCTPT</span>,           <span class="op">~</span><span class="va">EXDUR</span>,</span>
<span>  <span class="st">"001"</span>,    <span class="fl">1</span>,        <span class="st">"Pre-dose"</span>,       <span class="fl">1</span>,</span>
<span>  <span class="st">"001"</span>,    <span class="fl">1</span>,        <span class="st">"EOI"</span>,            <span class="fl">1</span>,</span>
<span>  <span class="st">"001"</span>,    <span class="fl">1</span>,        <span class="st">"1H POST EOI"</span>,    <span class="fl">1</span>,</span>
<span>  <span class="st">"002"</span>,    <span class="fl">1</span>,        <span class="st">"Pre-dose"</span>,       <span class="fl">2</span>,</span>
<span>  <span class="st">"002"</span>,    <span class="fl">1</span>,        <span class="st">"EOI"</span>,            <span class="fl">2</span>,</span>
<span>  <span class="st">"002"</span>,    <span class="fl">1</span>,        <span class="st">"1H POST EOI"</span>,    <span class="fl">2</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/derive_var_nfrlt.html">derive_var_nfrlt</a></span><span class="op">(</span></span>
<span>  <span class="va">adpc_var_dur</span>,</span>
<span>  new_var <span class="op">=</span> <span class="va">NFRLT</span>,</span>
<span>  new_var_unit <span class="op">=</span> <span class="va">FRLTU</span>,</span>
<span>  tpt_var <span class="op">=</span> <span class="va">PCTPT</span>,</span>
<span>  visit_day <span class="op">=</span> <span class="va">VISITDY</span>,</span>
<span>  treatment_duration <span class="op">=</span> <span class="va">EXDUR</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 6 Ã— 6</span></span>
<span><span class="co">#&gt;   USUBJID VISITDY PCTPT       EXDUR NFRLT FRLTU</span></span>
<span><span class="co">#&gt;   &lt;chr&gt;     &lt;dbl&gt; &lt;chr&gt;       &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt;</span></span>
<span><span class="co">#&gt; 1 001           1 Pre-dose        1     0 HOURS</span></span>
<span><span class="co">#&gt; 2 001           1 EOI             1     1 HOURS</span></span>
<span><span class="co">#&gt; 3 001           1 1H POST EOI     1     2 HOURS</span></span>
<span><span class="co">#&gt; 4 002           1 Pre-dose        2     0 HOURS</span></span>
<span><span class="co">#&gt; 5 002           1 EOI             2     2 HOURS</span></span>
<span><span class="co">#&gt; 6 002           1 1H POST EOI     2     3 HOURS</span></span></code></pre><p></p></div>
</div>
<div class="section">
<h3 id="exposure-records-without-timepoint-variable">Exposure records without timepoint variable<a class="anchor" aria-label="anchor" href="#exposure-records-without-timepoint-variable"></a></h3>


<p>Deriving NFRLT based only on visit day</p>
<p></p><div class="sourceCode r"><pre><code><span><span class="va">ex</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tribble.html" class="external-link">tribble</a></span><span class="op">(</span></span>
<span>  <span class="op">~</span><span class="va">USUBJID</span>, <span class="op">~</span><span class="va">VISITDY</span>,</span>
<span>  <span class="st">"001"</span>,    <span class="fl">1</span>,</span>
<span>  <span class="st">"001"</span>,    <span class="fl">8</span>,</span>
<span>  <span class="st">"001"</span>,    <span class="fl">15</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/derive_var_nfrlt.html">derive_var_nfrlt</a></span><span class="op">(</span></span>
<span>  <span class="va">ex</span>,</span>
<span>  new_var <span class="op">=</span> <span class="va">NFRLT</span>,</span>
<span>  new_var_unit <span class="op">=</span> <span class="va">FRLTU</span>,</span>
<span>  visit_day <span class="op">=</span> <span class="va">VISITDY</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 3 Ã— 4</span></span>
<span><span class="co">#&gt;   USUBJID VISITDY NFRLT FRLTU</span></span>
<span><span class="co">#&gt;   &lt;chr&gt;     &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt;</span></span>
<span><span class="co">#&gt; 1 001           1     0 HOURS</span></span>
<span><span class="co">#&gt; 2 001           8   168 HOURS</span></span>
<span><span class="co">#&gt; 3 001          15   336 HOURS</span></span></code></pre><p></p></div>
</div>
<div class="section">
<h3 id="exposure-records-with-different-output-units">Exposure records with different output units<a class="anchor" aria-label="anchor" href="#exposure-records-with-different-output-units"></a></h3>


<p>Deriving NFRLT in hours, days, and weeks for exposure records</p>
<p></p><div class="sourceCode r"><pre><code><span><span class="va">ex</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/derive_var_nfrlt.html">derive_var_nfrlt</a></span><span class="op">(</span></span>
<span>    new_var <span class="op">=</span> <span class="va">NFRLT</span>,</span>
<span>    new_var_unit <span class="op">=</span> <span class="va">FRLTU</span>,</span>
<span>    visit_day <span class="op">=</span> <span class="va">VISITDY</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/derive_var_nfrlt.html">derive_var_nfrlt</a></span><span class="op">(</span></span>
<span>    new_var <span class="op">=</span> <span class="va">NFRLTDY</span>,</span>
<span>    new_var_unit <span class="op">=</span> <span class="va">FRLTDYU</span>,</span>
<span>    out_unit <span class="op">=</span> <span class="st">"days"</span>,</span>
<span>    visit_day <span class="op">=</span> <span class="va">VISITDY</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/derive_var_nfrlt.html">derive_var_nfrlt</a></span><span class="op">(</span></span>
<span>    new_var <span class="op">=</span> <span class="va">NFRLTWK</span>,</span>
<span>    new_var_unit <span class="op">=</span> <span class="va">FRLTWKU</span>,</span>
<span>    out_unit <span class="op">=</span> <span class="st">"weeks"</span>,</span>
<span>    visit_day <span class="op">=</span> <span class="va">VISITDY</span></span>
<span>  <span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 3 Ã— 8</span></span>
<span><span class="co">#&gt;   USUBJID VISITDY NFRLT FRLTU NFRLTDY FRLTDYU NFRLTWK FRLTWKU</span></span>
<span><span class="co">#&gt;   &lt;chr&gt;     &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt;   &lt;dbl&gt; &lt;chr&gt;     &lt;dbl&gt; &lt;chr&gt;</span></span>
<span><span class="co">#&gt; 1 001           1     0 HOURS       0 days          0 weeks</span></span>
<span><span class="co">#&gt; 2 001           8   168 HOURS       7 days          1 weeks</span></span>
<span><span class="co">#&gt; 3 001          15   336 HOURS      14 days          2 weeks  </span></span></code></pre><p></p></div>
</div>
<div class="section">
<h3 id="unscheduled-visits">Unscheduled visits<a class="anchor" aria-label="anchor" href="#unscheduled-visits"></a></h3>


<p>Setting NFRLT to NA for unscheduled visits</p>
<p></p><div class="sourceCode r"><pre><code><span><span class="va">adpc_unsched</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tribble.html" class="external-link">tribble</a></span><span class="op">(</span></span>
<span>  <span class="op">~</span><span class="va">USUBJID</span>, <span class="op">~</span><span class="va">VISITDY</span>, <span class="op">~</span><span class="va">VISIT</span>,        <span class="op">~</span><span class="va">PCTPT</span>,</span>
<span>  <span class="st">"001"</span>,    <span class="fl">1</span>,        <span class="st">"VISIT 1"</span>,     <span class="st">"Pre-dose"</span>,</span>
<span>  <span class="st">"001"</span>,    <span class="fl">1</span>,        <span class="st">"VISIT 1"</span>,     <span class="st">"2H Post-dose"</span>,</span>
<span>  <span class="st">"001"</span>,    <span class="cn">NA_real_</span>, <span class="st">"UNSCHEDULED"</span>, <span class="st">"Pre-dose"</span>,</span>
<span>  <span class="st">"001"</span>,    <span class="cn">NA_real_</span>, <span class="st">"UNSCHEDULED"</span>, <span class="st">"2H Post-dose"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/derive_var_nfrlt.html">derive_var_nfrlt</a></span><span class="op">(</span></span>
<span>  <span class="va">adpc_unsched</span>,</span>
<span>  new_var <span class="op">=</span> <span class="va">NFRLT</span>,</span>
<span>  new_var_unit <span class="op">=</span> <span class="va">FRLTU</span>,</span>
<span>  tpt_var <span class="op">=</span> <span class="va">PCTPT</span>,</span>
<span>  visit_day <span class="op">=</span> <span class="va">VISITDY</span>,</span>
<span>  set_values_to_na <span class="op">=</span> <span class="va">VISIT</span> <span class="op">==</span> <span class="st">"UNSCHEDULED"</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 4 Ã— 6</span></span>
<span><span class="co">#&gt;   USUBJID VISITDY VISIT       PCTPT        NFRLT FRLTU</span></span>
<span><span class="co">#&gt;   &lt;chr&gt;     &lt;dbl&gt; &lt;chr&gt;       &lt;chr&gt;        &lt;dbl&gt; &lt;chr&gt;</span></span>
<span><span class="co">#&gt; 1 001           1 VISIT 1     Pre-dose         0 HOURS</span></span>
<span><span class="co">#&gt; 2 001           1 VISIT 1     2H Post-dose     2 HOURS</span></span>
<span><span class="co">#&gt; 3 001          NA UNSCHEDULED Pre-dose        NA &lt;NA&gt;</span></span>
<span><span class="co">#&gt; 4 001          NA UNSCHEDULED 2H Post-dose    NA &lt;NA&gt; </span></span></code></pre><p></p></div>
</div>
<div class="section">
<h3 id="early-discontinuation-visits">Early discontinuation visits<a class="anchor" aria-label="anchor" href="#early-discontinuation-visits"></a></h3>


<p>Handling study drug early discontinuation</p>
<p></p><div class="sourceCode r"><pre><code><span><span class="va">adpc_disc</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tribble.html" class="external-link">tribble</a></span><span class="op">(</span></span>
<span>  <span class="op">~</span><span class="va">USUBJID</span>, <span class="op">~</span><span class="va">VISITDY</span>, <span class="op">~</span><span class="va">VISIT</span>,                              <span class="op">~</span><span class="va">PCTPT</span>,</span>
<span>  <span class="st">"001"</span>,    <span class="fl">1</span>,        <span class="st">"VISIT 1"</span>,                           <span class="st">"Pre-dose"</span>,</span>
<span>  <span class="st">"001"</span>,    <span class="fl">1</span>,        <span class="st">"VISIT 1"</span>,                           <span class="st">"2H Post-dose"</span>,</span>
<span>  <span class="st">"001"</span>,    <span class="cn">NA_real_</span>, <span class="st">"STUDY DRUG EARLY DISCONTINUATION"</span>,  <span class="st">"Pre-dose"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/derive_var_nfrlt.html">derive_var_nfrlt</a></span><span class="op">(</span></span>
<span>  <span class="va">adpc_disc</span>,</span>
<span>  new_var <span class="op">=</span> <span class="va">NFRLT</span>,</span>
<span>  new_var_unit <span class="op">=</span> <span class="va">FRLTU</span>,</span>
<span>  tpt_var <span class="op">=</span> <span class="va">PCTPT</span>,</span>
<span>  visit_day <span class="op">=</span> <span class="va">VISITDY</span>,</span>
<span>  set_values_to_na <span class="op">=</span> <span class="va">VISIT</span> <span class="op">==</span> <span class="st">"STUDY DRUG EARLY DISCONTINUATION"</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 3 Ã— 6</span></span>
<span><span class="co">#&gt;   USUBJID VISITDY VISIT                            PCTPT        NFRLT FRLTU</span></span>
<span><span class="co">#&gt;   &lt;chr&gt;     &lt;dbl&gt; &lt;chr&gt;                            &lt;chr&gt;        &lt;dbl&gt; &lt;chr&gt;</span></span>
<span><span class="co">#&gt; 1 001           1 VISIT 1                          Pre-dose         0 HOURS</span></span>
<span><span class="co">#&gt; 2 001           1 VISIT 1                          2H Post-dose     2 HOURS</span></span>
<span><span class="co">#&gt; 3 001          NA STUDY DRUG EARLY DISCONTINUATION Pre-dose        NA &lt;NA&gt; </span></span></code></pre><p></p></div>
</div>
<div class="section">
<h3 id="multiple-exclusion-criteria">Multiple exclusion criteria<a class="anchor" aria-label="anchor" href="#multiple-exclusion-criteria"></a></h3>


<p>Excluding multiple visit types</p>
<p></p><div class="sourceCode r"><pre><code><span><span class="va">adpc_multi</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tribble.html" class="external-link">tribble</a></span><span class="op">(</span></span>
<span>  <span class="op">~</span><span class="va">USUBJID</span>, <span class="op">~</span><span class="va">VISITDY</span>, <span class="op">~</span><span class="va">VISIT</span>,                              <span class="op">~</span><span class="va">PCTPT</span>,</span>
<span>  <span class="st">"001"</span>,    <span class="fl">1</span>,        <span class="st">"VISIT 1"</span>,                           <span class="st">"Pre-dose"</span>,</span>
<span>  <span class="st">"001"</span>,    <span class="cn">NA_real_</span>, <span class="st">"UNSCHEDULED"</span>,                       <span class="st">"Pre-dose"</span>,</span>
<span>  <span class="st">"001"</span>,    <span class="cn">NA_real_</span>, <span class="st">"STUDY DRUG EARLY DISCONTINUATION"</span>,  <span class="st">"Pre-dose"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/derive_var_nfrlt.html">derive_var_nfrlt</a></span><span class="op">(</span></span>
<span>  <span class="va">adpc_multi</span>,</span>
<span>  new_var <span class="op">=</span> <span class="va">NFRLT</span>,</span>
<span>  new_var_unit <span class="op">=</span> <span class="va">FRLTU</span>,</span>
<span>  tpt_var <span class="op">=</span> <span class="va">PCTPT</span>,</span>
<span>  visit_day <span class="op">=</span> <span class="va">VISITDY</span>,</span>
<span>  set_values_to_na <span class="op">=</span> <span class="va">VISIT</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>    <span class="st">"UNSCHEDULED"</span>,</span>
<span>    <span class="st">"STUDY DRUG EARLY DISCONTINUATION"</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 3 Ã— 6</span></span>
<span><span class="co">#&gt;   USUBJID VISITDY VISIT                            PCTPT    NFRLT FRLTU</span></span>
<span><span class="co">#&gt;   &lt;chr&gt;     &lt;dbl&gt; &lt;chr&gt;                            &lt;chr&gt;    &lt;dbl&gt; &lt;chr&gt;</span></span>
<span><span class="co">#&gt; 1 001           1 VISIT 1                          Pre-dose     0 HOURS</span></span>
<span><span class="co">#&gt; 2 001          NA UNSCHEDULED                      Pre-dose    NA &lt;NA&gt;</span></span>
<span><span class="co">#&gt; 3 001          NA STUDY DRUG EARLY DISCONTINUATION Pre-dose    NA &lt;NA&gt; </span></span></code></pre><p></p></div>
</div>
<div class="section">
<h3 id="setting-special-values-instead-of-na">Setting special values instead of NA<a class="anchor" aria-label="anchor" href="#setting-special-values-instead-of-na"></a></h3>


<p>Using mutate to set NFRLT to 99999 for unscheduled visits</p>
<p></p><div class="sourceCode r"><pre><code><span><span class="va">adpc_unsched_value</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tribble.html" class="external-link">tribble</a></span><span class="op">(</span></span>
<span>  <span class="op">~</span><span class="va">USUBJID</span>, <span class="op">~</span><span class="va">VISITDY</span>, <span class="op">~</span><span class="va">VISIT</span>,        <span class="op">~</span><span class="va">PCTPT</span>,</span>
<span>  <span class="st">"001"</span>,    <span class="fl">1</span>,        <span class="st">"VISIT 1"</span>,     <span class="st">"Pre-dose"</span>,</span>
<span>  <span class="st">"001"</span>,    <span class="fl">1</span>,        <span class="st">"VISIT 1"</span>,     <span class="st">"2H Post-dose"</span>,</span>
<span>  <span class="st">"001"</span>,    <span class="cn">NA_real_</span>, <span class="st">"UNSCHEDULED"</span>, <span class="st">"Pre-dose"</span>,</span>
<span>  <span class="st">"001"</span>,    <span class="cn">NA_real_</span>, <span class="st">"UNSCHEDULED"</span>, <span class="st">"2H Post-dose"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">adpc_unsched_value</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/derive_var_nfrlt.html">derive_var_nfrlt</a></span><span class="op">(</span></span>
<span>    new_var <span class="op">=</span> <span class="va">NFRLT</span>,</span>
<span>    new_var_unit <span class="op">=</span> <span class="va">FRLTU</span>,</span>
<span>    tpt_var <span class="op">=</span> <span class="va">PCTPT</span>,</span>
<span>    visit_day <span class="op">=</span> <span class="va">VISITDY</span>,</span>
<span>    set_values_to_na <span class="op">=</span> <span class="va">VISIT</span> <span class="op">==</span> <span class="st">"UNSCHEDULED"</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>    NFRLT <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/if_else.html" class="external-link">if_else</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">NFRLT</span><span class="op">)</span> <span class="op">&amp;</span> <span class="va">VISIT</span> <span class="op">==</span> <span class="st">"UNSCHEDULED"</span>, <span class="fl">99999</span>, <span class="va">NFRLT</span><span class="op">)</span>,</span>
<span>    FRLTU <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/if_else.html" class="external-link">if_else</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">FRLTU</span><span class="op">)</span> <span class="op">&amp;</span> <span class="va">VISIT</span> <span class="op">==</span> <span class="st">"UNSCHEDULED"</span>, <span class="st">""</span>, <span class="va">FRLTU</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 4 Ã— 6</span></span>
<span><span class="co">#&gt;   USUBJID VISITDY VISIT       PCTPT        NFRLT FRLTU</span></span>
<span><span class="co">#&gt;   &lt;chr&gt;     &lt;dbl&gt; &lt;chr&gt;       &lt;chr&gt;        &lt;dbl&gt; &lt;chr&gt;</span></span>
<span><span class="co">#&gt; 1 001           1 VISIT 1     Pre-dose         0 "HOURS"</span></span>
<span><span class="co">#&gt; 2 001           1 VISIT 1     2H Post-dose     2 "HOURS"</span></span>
<span><span class="co">#&gt; 3 001          NA UNSCHEDULED Pre-dose     99999 ""</span></span>
<span><span class="co">#&gt; 4 001          NA UNSCHEDULED 2H Post-dose 99999 ""     </span></span></code></pre><p></p></div>
</div>
<div class="section">
<h3 id="custom-range-method">Custom range method<a class="anchor" aria-label="anchor" href="#custom-range-method"></a></h3>


<p>Using end of range instead of midpoint</p>
<p></p><div class="sourceCode r"><pre><code><span><span class="va">adpc_range</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tribble.html" class="external-link">tribble</a></span><span class="op">(</span></span>
<span>  <span class="op">~</span><span class="va">USUBJID</span>, <span class="op">~</span><span class="va">VISITDY</span>, <span class="op">~</span><span class="va">PCTPT</span>,</span>
<span>  <span class="st">"001"</span>,    <span class="fl">1</span>,        <span class="st">"Pre-dose"</span>,</span>
<span>  <span class="st">"001"</span>,    <span class="fl">1</span>,        <span class="st">"0-6h Post-dose"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/derive_var_nfrlt.html">derive_var_nfrlt</a></span><span class="op">(</span></span>
<span>  <span class="va">adpc_range</span>,</span>
<span>  new_var <span class="op">=</span> <span class="va">NFRLT</span>,</span>
<span>  new_var_unit <span class="op">=</span> <span class="va">FRLTU</span>,</span>
<span>  tpt_var <span class="op">=</span> <span class="va">PCTPT</span>,</span>
<span>  visit_day <span class="op">=</span> <span class="va">VISITDY</span>,</span>
<span>  range_method <span class="op">=</span> <span class="st">"end"</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 2 Ã— 5</span></span>
<span><span class="co">#&gt;   USUBJID VISITDY PCTPT          NFRLT FRLTU</span></span>
<span><span class="co">#&gt;   &lt;chr&gt;     &lt;dbl&gt; &lt;chr&gt;          &lt;dbl&gt; &lt;chr&gt;</span></span>
<span><span class="co">#&gt; 1 001           1 Pre-dose           0 HOURS</span></span>
<span><span class="co">#&gt; 2 001           1 0-6h Post-dose     6 HOURS</span></span></code></pre><p></p></div>
</div>
<div class="section">
<h3 id="alternative-terminology">Alternative terminology<a class="anchor" aria-label="anchor" href="#alternative-terminology"></a></h3>


<p>Using "Before" and "After" terminology</p>
<p></p><div class="sourceCode r"><pre><code><span><span class="va">adpc_alt</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tribble.html" class="external-link">tribble</a></span><span class="op">(</span></span>
<span>  <span class="op">~</span><span class="va">USUBJID</span>, <span class="op">~</span><span class="va">VISITDY</span>, <span class="op">~</span><span class="va">PCTPT</span>,</span>
<span>  <span class="st">"001"</span>,    <span class="fl">1</span>,        <span class="st">"Before"</span>,</span>
<span>  <span class="st">"001"</span>,    <span class="fl">1</span>,        <span class="st">"1H After"</span>,</span>
<span>  <span class="st">"001"</span>,    <span class="fl">1</span>,        <span class="st">"2H After"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/derive_var_nfrlt.html">derive_var_nfrlt</a></span><span class="op">(</span></span>
<span>  <span class="va">adpc_alt</span>,</span>
<span>  new_var <span class="op">=</span> <span class="va">NFRLT</span>,</span>
<span>  new_var_unit <span class="op">=</span> <span class="va">FRLTU</span>,</span>
<span>  tpt_var <span class="op">=</span> <span class="va">PCTPT</span>,</span>
<span>  visit_day <span class="op">=</span> <span class="va">VISITDY</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 3 Ã— 5</span></span>
<span><span class="co">#&gt;   USUBJID VISITDY PCTPT    NFRLT FRLTU</span></span>
<span><span class="co">#&gt;   &lt;chr&gt;     &lt;dbl&gt; &lt;chr&gt;    &lt;dbl&gt; &lt;chr&gt;</span></span>
<span><span class="co">#&gt; 1 001           1 Before       0 HOURS</span></span>
<span><span class="co">#&gt; 2 001           1 1H After     1 HOURS</span></span>
<span><span class="co">#&gt; 3 001           1 2H After     2 HOURS</span></span></code></pre><p></p></div>
</div>
<div class="section">
<h3 id="reference-relative-time-with-rrltu">Reference relative time with RRLTU<a class="anchor" aria-label="anchor" href="#reference-relative-time-with-rrltu"></a></h3>


<p>Using RRLTU for reference relative time instead of first dose</p>
<p></p><div class="sourceCode r"><pre><code><span><span class="fu"><a href="../reference/derive_var_nfrlt.html">derive_var_nfrlt</a></span><span class="op">(</span></span>
<span>  <span class="va">adpc</span>,</span>
<span>  new_var <span class="op">=</span> <span class="va">NRRLT</span>,</span>
<span>  new_var_unit <span class="op">=</span> <span class="va">RRLTU</span>,</span>
<span>  tpt_var <span class="op">=</span> <span class="va">PCTPT</span>,</span>
<span>  visit_day <span class="op">=</span> <span class="va">VISITDY</span>,</span>
<span>  first_dose_day <span class="op">=</span> <span class="fl">8</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 5 Ã— 5</span></span>
<span><span class="co">#&gt;   USUBJID VISITDY PCTPT         NRRLT RRLTU</span></span>
<span><span class="co">#&gt;   &lt;chr&gt;     &lt;dbl&gt; &lt;chr&gt;         &lt;dbl&gt; &lt;chr&gt;</span></span>
<span><span class="co">#&gt; 1 001           1 Pre-dose       -168 HOURS</span></span>
<span><span class="co">#&gt; 2 001           1 1H Post-dose   -167 HOURS</span></span>
<span><span class="co">#&gt; 3 001           1 2H Post-dose   -166 HOURS</span></span>
<span><span class="co">#&gt; 4 001           1 4H Post-dose   -164 HOURS</span></span>
<span><span class="co">#&gt; 5 001           1 24H Post-dose  -144 HOURS</span></span></code></pre><p></p></div>
</div>
<div class="section">
<h3 id="case-sensitivity-in-out-unit">Case sensitivity in out_unit<a class="anchor" aria-label="anchor" href="#case-sensitivity-in-out-unit"></a></h3>


<p>Unit variable preserves the case provided in out_unit</p>
<p></p><div class="sourceCode r"><pre><code><span><span class="fu"><a href="../reference/derive_var_nfrlt.html">derive_var_nfrlt</a></span><span class="op">(</span></span>
<span>  <span class="va">adpc</span>,</span>
<span>  new_var <span class="op">=</span> <span class="va">NFRLT</span>,</span>
<span>  new_var_unit <span class="op">=</span> <span class="va">FRLTU</span>,</span>
<span>  out_unit <span class="op">=</span> <span class="st">"HOURS"</span>,</span>
<span>  tpt_var <span class="op">=</span> <span class="va">PCTPT</span>,</span>
<span>  visit_day <span class="op">=</span> <span class="va">VISITDY</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 5 Ã— 5</span></span>
<span><span class="co">#&gt;   USUBJID VISITDY PCTPT         NFRLT FRLTU</span></span>
<span><span class="co">#&gt;   &lt;chr&gt;     &lt;dbl&gt; &lt;chr&gt;         &lt;dbl&gt; &lt;chr&gt;</span></span>
<span><span class="co">#&gt; 1 001           1 Pre-dose          0 HOURS</span></span>
<span><span class="co">#&gt; 2 001           1 1H Post-dose      1 HOURS</span></span>
<span><span class="co">#&gt; 3 001           1 2H Post-dose      2 HOURS</span></span>
<span><span class="co">#&gt; 4 001           1 4H Post-dose      4 HOURS</span></span>
<span><span class="co">#&gt; 5 001           1 24H Post-dose    24 HOURS</span></span></code></pre><p></p></div>
</div>
    </div>

  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by F. Hoffmann-La Roche AG, GlaxoSmithKline LLC, Ben Straub, Stefan Bundfuss, Matt Bearham, Arianna Cascone, Kristin Dahnert, Jeffrey Dickinson, Ross Farrugia, Fanny Gautier, Edoardo Mancini, Gordon Miller, Lina Patil, Jim Rothstein.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

