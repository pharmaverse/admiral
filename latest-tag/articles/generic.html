<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="admiral">
<title>Generic Functions • admiral</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.1.0/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.1.0/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Generic Functions">
<meta property="og:description" content="admiral">
<meta property="og:image" content="https://pharmaverse.github.io/admiral/v0.12.3/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-dark navbar-expand-lg bg-primary"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">admiral</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.12.3</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../articles/admiral.html">Get Started</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-user-guides">User Guides</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-user-guides">
    <a class="dropdown-item" href="../articles/admiral.html">Getting Started</a>
    <a class="dropdown-item" href="../articles/adsl.html">Creating a Basic ADSL</a>
    <a class="dropdown-item" href="../articles/faq.html">FAQ</a>
    <div class="dropdown-divider"></div>
    <h6 class="dropdown-header" data-toc-skip>Deep Dives on ADaMs</h6>
    <a class="dropdown-item" href="../articles/occds.html">Creating an OCCDS ADaM</a>
    <a class="dropdown-item" href="../articles/bds_finding.html">Creating a BDS Findings ADAM</a>
    <a class="dropdown-item" href="../articles/bds_exposure.html">Creating a BDS Exposure ADaM</a>
    <a class="dropdown-item" href="../articles/bds_tte.html">Creating a BDS Time-to-Event ADaM</a>
    <a class="dropdown-item" href="../articles/questionnaires.html">Creating Questionnaire ADaMs</a>
    <a class="dropdown-item" href="../articles/pk_adnca.html">Creating a PK NCA or Population PK ADaM</a>
    <h6 class="dropdown-header" data-toc-skip>Advanced User Guides</h6>
    <a class="dropdown-item" href="../articles/imputation.html">Date and Time Imputation</a>
    <a class="dropdown-item" href="../articles/visits_periods.html">Visit and Period Variables</a>
    <a class="dropdown-item" href="../articles/generic.html">Generic Functions</a>
    <a class="dropdown-item" href="../articles/higher_order.html">Higher Order Functions</a>
    <a class="dropdown-item" href="../articles/queries_dataset.html">Queries Dataset Documentation</a>
    <a class="dropdown-item" href="../articles/lab_grading.html">Lab Grading</a>
    <a class="dropdown-item" href="../articles/hys_law.html">Hy's Law Implementation</a>
  </div>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-community">Community</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-community">
    <a class="dropdown-item" href="../articles/contribution_model.html">Contribute to admiral</a>
    <a class="external-link dropdown-item" href="https://app.slack.com/client/T028PB489D3/C02M8KN8269">Find us on Slack</a>
    <a class="external-link dropdown-item" href="https://pharmaverse.org/">Welcome to the Pharmaverse</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
<!-- start dropdown for versions --> <li class="nav-item dropdown">
        <a href="#" class="nav-link dropdown-toggle"
          data-bs-toggle="dropdown" role="button"
          aria-expanded="false" aria-haspopup="true"
          id="dropdown-versions">Versions</a> <div class="dropdown-menu" aria-labelledby="dropdown-versions"> <a class="dropdown-item" data-toggle="tooltip" title="" href="https://pharmaverse.github.io/admiral/cran-release">cran-release</a>
<a class="dropdown-item" data-toggle="tooltip" title="" href="https://pharmaverse.github.io/admiral/v0.12.3">v0.12.3</a>
<a class="dropdown-item" data-toggle="tooltip" title="" href="https://pharmaverse.github.io/admiral/v0.12.2">v0.12.2</a>
<a class="dropdown-item" data-toggle="tooltip" title="" href="https://pharmaverse.github.io/admiral/v0.12.1">v0.12.1</a>
<a class="dropdown-item" data-toggle="tooltip" title="" href="https://pharmaverse.github.io/admiral/v0.12.0">v0.12.0</a>
<a class="dropdown-item" data-toggle="tooltip" title="" href="https://pharmaverse.github.io/admiral/v0.11.1">v0.11.1</a>
<a class="dropdown-item" data-toggle="tooltip" title="" href="https://pharmaverse.github.io/admiral/v0.11.0">v0.11.0</a> </div></li>
<!-- end dropdown for versions -->
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/pharmaverse/admiral/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">



<link href="generic_files/dt-scroll-1.0.0/style.css" rel="stylesheet">
<script src="generic_files/htmlwidgets-1.5.4/htmlwidgets.js"></script><link href="generic_files/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet">
<script src="generic_files/datatables-binding-0.21/datatables.js"></script><link href="generic_files/dt-core-1.11.3/css/jquery.dataTables.min.css" rel="stylesheet">
<link href="generic_files/dt-core-1.11.3/css/jquery.dataTables.extra.css" rel="stylesheet">
<script src="generic_files/dt-core-1.11.3/js/jquery.dataTables.min.js"></script><link href="generic_files/dt-ext-buttons-1.11.3/css/buttons.dataTables.min.css" rel="stylesheet">
<script src="generic_files/dt-ext-buttons-1.11.3/js/dataTables.buttons.min.js"></script><script src="generic_files/dt-ext-buttons-1.11.3/js/buttons.html5.min.js"></script><script src="generic_files/dt-ext-buttons-1.11.3/js/buttons.colVis.min.js"></script><script src="generic_files/dt-ext-buttons-1.11.3/js/buttons.print.min.js"></script><link href="generic_files/dt-ext-colreorder-1.11.3/css/colReorder.dataTables.min.css" rel="stylesheet">
<script src="generic_files/dt-ext-colreorder-1.11.3/js/dataTables.colReorder.min.js"></script><link href="generic_files/dt-ext-scroller-1.11.3/css/scroller.dataTables.min.css" rel="stylesheet">
<script src="generic_files/dt-ext-scroller-1.11.3/js/dataTables.scroller.min.js"></script><link href="generic_files/nouislider-7.0.10/jquery.nouislider.min.css" rel="stylesheet">
<script src="generic_files/nouislider-7.0.10/jquery.nouislider.min.js"></script><link href="generic_files/selectize-0.12.0/selectize.bootstrap3.css" rel="stylesheet">
<script src="generic_files/selectize-0.12.0/selectize.min.js"></script><link href="generic_files/dt-plugin-searchhighlight-1.11.3/source.css" rel="stylesheet">
<script src="generic_files/dt-plugin-searchhighlight-1.11.3/jquery.highlight.js"></script><script src="generic_files/dt-plugin-searchhighlight-1.11.3/source.min.js"></script><link href="generic_files/crosstalk-1.2.0/css/crosstalk.min.css" rel="stylesheet">
<script src="generic_files/crosstalk-1.2.0/js/crosstalk.min.js"></script><div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Generic Functions</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/pharmaverse/admiral/blob/main/vignettes/generic.Rmd" class="external-link"><code>vignettes/generic.Rmd</code></a></small>
      <div class="d-none name"><code>generic.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>This vignette explains some of the <a href="https://pharmaverse.github.io/admiral/" class="external-link">admiral</a> generic
functions, which we believe are able to be re-used to sometimes save
users having to create so many of their own functions for study-specific
analysis derivations. These re-usable functions give the users great
flexibility, but the challenge is knowing which to use when. So this
vignette is intended to help understand the differences between each,
thus improving the findability of the function needed for each task.</p>
<p>The focus will be on the following different sets of generic
functions:</p>
<ul>
<li><a href="#merged"><em>merged</em> functions</a></li>
<li><a href="#joined"><em>joined</em> functions</a></li>
<li><a href="#extreme"><em>extreme</em> functions</a></li>
</ul>
<p>In each section below, we will show examples of different functions
that belong to each of these sets, but we don’t list out each and every
function offered. Users should refer to the Reference page and search
for example “merged” to see the full list of functions offered for this
respective set, with more examples shown within each function page.</p>
<div class="section level3">
<h3 id="required-packages">Required Packages<a class="anchor" aria-label="anchor" href="#required-packages"></a>
</h3>
<p>The examples in this vignette require the following packages.</p>
<p>For example purpose, the SDTM datasets from
<a href="https://pharmaverse.github.io/pharmaversesdtm/main/" class="external-link">pharmaversesdtm</a> are used.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://pharmaverse.github.io/admiral/" class="external-link">admiral</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://pharmaverse.github.io/pharmaversesdtm/main/" class="external-link">pharmaversesdtm</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span>, warn.conflicts <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="http://stringr.tidyverse.org" class="external-link">stringr</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tibble.tidyverse.org/" class="external-link">tibble</a></span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"dm"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"ds"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"ex"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"ae"</span><span class="op">)</span>
<span class="va">dm</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/convert_blanks_to_na.html">convert_blanks_to_na</a></span><span class="op">(</span><span class="va">dm</span><span class="op">)</span>
<span class="va">ds</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/convert_blanks_to_na.html">convert_blanks_to_na</a></span><span class="op">(</span><span class="va">ds</span><span class="op">)</span>
<span class="va">ex</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/convert_blanks_to_na.html">convert_blanks_to_na</a></span><span class="op">(</span><span class="va">ex</span><span class="op">)</span>
<span class="va">ae</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/convert_blanks_to_na.html">convert_blanks_to_na</a></span><span class="op">(</span><span class="va">ae</span><span class="op">)</span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="difference-between-merged-and-joined-functions">Difference between <em>merged</em> and <em>joined</em>
functions<a class="anchor" aria-label="anchor" href="#difference-between-merged-and-joined-functions"></a>
</h2>
<p>Firstly, we need to address the question all new users will have… why
do we have “merged” and “joined” functions and are they not the same
thing??</p>
<p>Essentially in both sets of functions we are trying to take
information from an additional dataframe (passed into the
<code>dataset_add</code> argument) and join it to our original dataframe
(passed into the <code>dataset</code> argument). The subtle difference
is that “merged” functions select the relevant information from the
additional dataframe and then adds it to the original dataframe; whilst
“joined” functions allow an extra filter condition after the join to
further select the relevant information.</p>
<p>So in <code><a href="../reference/derive_vars_joined.html">derive_vars_joined()</a></code> for example, the filter
conditions can depend on variables from both dataframes; whilst in
<code><a href="../reference/derive_vars_merged.html">derive_vars_merged()</a></code> only variables from the additional
dataframe can be used. Examples will be shown in the below sections to
further explain the difference.</p>
<p>In principle though, we actually could achieve every “merged”
function result using the equivalent “joined” function. However, the
“joined” functions require much more resources (time and memory), hence
why we include both options for users.</p>
</div>
<div class="section level2">
<h2 id="merged">
<em>merged</em> functions<a class="anchor" aria-label="anchor" href="#merged"></a>
</h2>
<div class="section level3">
<h3 id="description">Description<a class="anchor" aria-label="anchor" href="#description"></a>
</h3>
<p>As explained above, this simpler set of functions for joins selects
relevant information from the additional dataframe and joins it to the
original dataframe.</p>
<p>The additional dataframe can be filtered based on a user-defined
condition passed into the <code>filter_add</code> argument and/or (where
relevant) by selecting the first or last observation for each by group
(<code>order</code> and <code>mode</code> arguments) and then joined
with the input dataframe by user-specified variables passed into
<code>by_vars</code> argument. Variables from the additional dataframe
can be joined to the input dataframe as they are or can be renamed
(<code>new_vars</code> argument).</p>
<p>The dataframe returned from the function call contains all
observations and variables from the original dataframe (with or without
filtering applied) and additionally the variable(s) specified for
<code>new_var</code>/<code>new_vars</code> from the additional
dataframe. This is achieved via an underlying <a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">dplyr::left_join</a>.
For observations without a match in the additional dataframe the new
variable(s) are set to <code>NA</code>. Observations in the additional
dataframe which have no match in the original dataframe are ignored.</p>
</div>
<div class="section level3">
<h3 id="examples">Examples<a class="anchor" aria-label="anchor" href="#examples"></a>
</h3>
<p>A simple call to derive <code>ADSL</code> randomization date
(<code>ADSL.RANDDT</code>) from an intermediate additional dataframe
would use <code><a href="../reference/derive_vars_merged.html">derive_vars_merged()</a></code> as follows.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Use DM domain as basis to build ADSL</span>
<span class="va">adsl_01</span> <span class="op">&lt;-</span> <span class="va">dm</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="op">-</span><span class="va">DOMAIN</span><span class="op">)</span>

<span class="co"># Convert disposition character date to numeric date and</span>
<span class="co"># join as randomization date to ADSL</span>
<span class="va">adsl_02</span> <span class="op">&lt;-</span> <span class="va">adsl_01</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="../reference/derive_vars_merged.html">derive_vars_merged</a></span><span class="op">(</span>
    dataset_add <span class="op">=</span> <span class="va">ds</span>,
    filter_add <span class="op">=</span> <span class="va">DSDECOD</span> <span class="op">==</span> <span class="st">"RANDOMIZED"</span>,
    by_vars <span class="op">=</span> <span class="fu"><a href="../reference/reexport-exprs.html">exprs</a></span><span class="op">(</span><span class="va">STUDYID</span>, <span class="va">USUBJID</span><span class="op">)</span>,
    new_vars <span class="op">=</span> <span class="fu"><a href="../reference/reexport-exprs.html">exprs</a></span><span class="op">(</span>RANDDT <span class="op">=</span> <span class="fu"><a href="../reference/convert_dtc_to_dt.html">convert_dtc_to_dt</a></span><span class="op">(</span><span class="va">DSSTDTC</span><span class="op">)</span><span class="op">)</span>
  <span class="op">)</span></code></pre></div>
<p>This call would return the input dataframe with the variable
<code>RANDDT</code> added.</p>
<p>Now, an example to add first treatment datetime
(<code>ADSL.TRTSDT</code>), where we need to make use of
<code><a href="../reference/derive_vars_merged.html">derive_vars_merged()</a></code> with the <code>mode</code> and
<code>order</code> arguments to select the required observations from
the additional dataframe. Note: the <code>filter_add</code> argument
here shows a possible method for checking only for valid doses.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Convert exposure start date to numeric date without imputation,</span>
<span class="co"># determine first exposure datetime and add to ADSL</span>
<span class="va">adsl_03</span> <span class="op">&lt;-</span> <span class="va">adsl_02</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="../reference/derive_vars_merged.html">derive_vars_merged</a></span><span class="op">(</span>
    dataset_add <span class="op">=</span> <span class="va">ex</span>,
    filter_add <span class="op">=</span> <span class="op">(</span><span class="va">EXDOSE</span> <span class="op">&gt;</span> <span class="fl">0</span> <span class="op">|</span> <span class="op">(</span><span class="va">EXDOSE</span> <span class="op">==</span> <span class="fl">0</span> <span class="op">&amp;</span> <span class="fu"><a href="https://stringr.tidyverse.org/reference/str_detect.html" class="external-link">str_detect</a></span><span class="op">(</span><span class="va">EXTRT</span>, <span class="st">"PLACEBO"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">&amp;</span>
      <span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">TRTSDT</span><span class="op">)</span>,
    new_vars <span class="op">=</span> <span class="fu"><a href="../reference/reexport-exprs.html">exprs</a></span><span class="op">(</span>TRTSDT <span class="op">=</span> <span class="fu"><a href="../reference/convert_dtc_to_dt.html">convert_dtc_to_dt</a></span><span class="op">(</span><span class="va">EXSTDTC</span><span class="op">)</span><span class="op">)</span>,
    order <span class="op">=</span> <span class="fu"><a href="../reference/reexport-exprs.html">exprs</a></span><span class="op">(</span><span class="va">TRTSDT</span>, <span class="va">EXSEQ</span><span class="op">)</span>,
    mode <span class="op">=</span> <span class="st">"first"</span>,
    by_vars <span class="op">=</span> <span class="fu"><a href="../reference/reexport-exprs.html">exprs</a></span><span class="op">(</span><span class="va">STUDYID</span>, <span class="va">USUBJID</span><span class="op">)</span>
  <span class="op">)</span></code></pre></div>
<p>This call would return the input dataframe with <code>TRTSDT</code>
added.</p>
<p>Beyond <code><a href="../reference/derive_vars_merged.html">derive_vars_merged()</a></code>, other “merged” functions
offer specific common analysis needs. For example, below shows an
example of using <code><a href="../reference/derive_var_merged_exist_flag.html">derive_var_merged_exist_flag()</a></code> for adding
safety population flag (<code>ADSL.SAFFL</code>).</p>
<p>In this case we create a new flag variable (<code>new_var</code>
argument) based on information we take from the additional dataframe to
tell us if a certain <code>condition</code> is met. For all by groups
(<code>by_vars</code> argument) where the check evaluates as
<code>TRUE</code> at least once the flag is set to <code>"Y"</code> (or
whatever user passes in <code>true_value</code> argument).</p>
<p>Note: we have extra arguments available here for patients that do not
meet the <code>condition</code>. In the below example, we set patients
in <code>EX</code> with no valid dose to <code>"N"</code>
(<code>false_value</code>) and the same for patients with no
observations at all in <code>EX</code> (<code>missing_value</code>).</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Add safety population flag to ADSL</span>
<span class="va">adsl_04</span> <span class="op">&lt;-</span> <span class="va">adsl_03</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="../reference/derive_var_merged_exist_flag.html">derive_var_merged_exist_flag</a></span><span class="op">(</span>
    dataset_add <span class="op">=</span> <span class="va">ex</span>,
    by_vars <span class="op">=</span> <span class="fu"><a href="../reference/reexport-exprs.html">exprs</a></span><span class="op">(</span><span class="va">STUDYID</span>, <span class="va">USUBJID</span><span class="op">)</span>,
    new_var <span class="op">=</span> <span class="va">SAFFL</span>,
    condition <span class="op">=</span> <span class="op">(</span><span class="va">EXDOSE</span> <span class="op">&gt;</span> <span class="fl">0</span> <span class="op">|</span> <span class="op">(</span><span class="va">EXDOSE</span> <span class="op">==</span> <span class="fl">0</span> <span class="op">&amp;</span> <span class="fu"><a href="https://stringr.tidyverse.org/reference/str_detect.html" class="external-link">str_detect</a></span><span class="op">(</span><span class="va">EXTRT</span>, <span class="st">"PLACEBO"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,
    false_value <span class="op">=</span> <span class="st">"N"</span>,
    missing_value <span class="op">=</span> <span class="st">"N"</span>
  <span class="op">)</span></code></pre></div>
<p>Here’s how all these above derived variables then look in the
dataset.</p>
<div id="htmlwidget-deb6d23e21dd7dffcb6c" style="width:auto;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-deb6d23e21dd7dffcb6c">{"x":{"filter":"top","vertical":false,"filterHTML":"<tr>\n  <td data-type=\"disabled\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"factor\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"width: 100%; display: none;\">\n      <select multiple=\"multiple\" style=\"width: 100%;\" data-options=\"[&quot;01-701-1047&quot;,&quot;01-701-1057&quot;,&quot;01-701-1111&quot;]\"><\/select>\n    <\/div>\n  <\/td>\n  <td data-type=\"factor\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"width: 100%; display: none;\">\n      <select multiple=\"multiple\" style=\"width: 100%;\" data-options=\"[&quot;1047&quot;,&quot;1057&quot;,&quot;1111&quot;]\"><\/select>\n    <\/div>\n  <\/td>\n  <td data-type=\"factor\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"width: 100%; display: none;\">\n      <select multiple=\"multiple\" style=\"width: 100%;\" data-options=\"[&quot;2012-09-07&quot;,&quot;2013-02-12&quot;]\"><\/select>\n    <\/div>\n  <\/td>\n  <td data-type=\"factor\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"width: 100%; display: none;\">\n      <select multiple=\"multiple\" style=\"width: 100%;\" data-options=\"[&quot;2012-09-17&quot;,&quot;2013-03-29&quot;]\"><\/select>\n    <\/div>\n  <\/td>\n  <td data-type=\"factor\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"width: 100%; display: none;\">\n      <select multiple=\"multiple\" style=\"width: 100%;\" data-options=\"[&quot;2012-09-07&quot;,&quot;2013-02-12&quot;]\"><\/select>\n    <\/div>\n  <\/td>\n  <td data-type=\"factor\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"width: 100%; display: none;\">\n      <select multiple=\"multiple\" style=\"width: 100%;\" data-options=\"[&quot;2012-09-16&quot;,&quot;2013-03-09&quot;]\"><\/select>\n    <\/div>\n  <\/td>\n  <td data-type=\"disabled\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"factor\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"width: 100%; display: none;\">\n      <select multiple=\"multiple\" style=\"width: 100%;\" data-options=\"[&quot;2013-02-22&quot;,&quot;2013-07-28&quot;,&quot;2013-12-27&quot;]\"><\/select>\n    <\/div>\n  <\/td>\n  <td data-type=\"disabled\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"disabled\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"disabled\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"59\" data-max=\"85\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"disabled\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"disabled\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"disabled\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"factor\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"width: 100%; display: none;\">\n      <select multiple=\"multiple\" style=\"width: 100%;\" data-options=\"[&quot;HISPANIC OR LATINO&quot;,&quot;NOT HISPANIC OR LATINO&quot;]\"><\/select>\n    <\/div>\n  <\/td>\n  <td data-type=\"factor\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"width: 100%; display: none;\">\n      <select multiple=\"multiple\" style=\"width: 100%;\" data-options=\"[&quot;Pbo&quot;,&quot;Scrnfail&quot;,&quot;Xan_Lo&quot;]\"><\/select>\n    <\/div>\n  <\/td>\n  <td data-type=\"factor\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"width: 100%; display: none;\">\n      <select multiple=\"multiple\" style=\"width: 100%;\" data-options=\"[&quot;Placebo&quot;,&quot;Screen Failure&quot;,&quot;Xanomeline Low Dose&quot;]\"><\/select>\n    <\/div>\n  <\/td>\n  <td data-type=\"factor\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"width: 100%; display: none;\">\n      <select multiple=\"multiple\" style=\"width: 100%;\" data-options=\"[&quot;Pbo&quot;,&quot;Scrnfail&quot;,&quot;Xan_Lo&quot;]\"><\/select>\n    <\/div>\n  <\/td>\n  <td data-type=\"factor\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"width: 100%; display: none;\">\n      <select multiple=\"multiple\" style=\"width: 100%;\" data-options=\"[&quot;Placebo&quot;,&quot;Screen Failure&quot;,&quot;Xanomeline Low Dose&quot;]\"><\/select>\n    <\/div>\n  <\/td>\n  <td data-type=\"disabled\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"factor\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"width: 100%; display: none;\">\n      <select multiple=\"multiple\" style=\"width: 100%;\" data-options=\"[&quot;2012-08-25&quot;,&quot;2013-01-22&quot;,&quot;2013-12-20&quot;]\"><\/select>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"-21\" data-max=\"-13\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"date\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"1343779200000\" data-max=\"1360627200000\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"date\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"1.346976e+12\" data-max=\"1360627200000\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"factor\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"width: 100%; display: none;\">\n      <select multiple=\"multiple\" style=\"width: 100%;\" data-options=\"[&quot;N&quot;,&quot;Y&quot;]\"><\/select>\n    <\/div>\n  <\/td>\n<\/tr>","extensions":["Buttons","ColReorder","Scroller"],"data":[["CDISCPILOT01","CDISCPILOT01","CDISCPILOT01"],["01-701-1047","01-701-1057","01-701-1111"],["1047","1057","1111"],["2013-02-12",null,"2012-09-07"],["2013-03-29",null,"2012-09-17"],["2013-02-12",null,"2012-09-07"],["2013-03-09",null,"2012-09-16"],[null,null,null],["2013-07-28","2013-12-27","2013-02-22"],[null,null,null],[null,null,null],["701","701","701"],[85,59,81],["YEARS","YEARS","YEARS"],["F","F","F"],["WHITE","WHITE","WHITE"],["NOT HISPANIC OR LATINO","HISPANIC OR LATINO","NOT HISPANIC OR LATINO"],["Pbo","Scrnfail","Xan_Lo"],["Placebo","Screen Failure","Xanomeline Low Dose"],["Pbo","Scrnfail","Xan_Lo"],["Placebo","Screen Failure","Xanomeline Low Dose"],["USA","USA","USA"],["2013-01-22","2013-12-20","2012-08-25"],[-21,null,-13],["2013-02-12",null,"2012-08-01"],["2013-02-12",null,"2012-09-07"],["Y","N","Y"]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th>STUDYID<\/th>\n      <th>USUBJID<\/th>\n      <th>SUBJID<\/th>\n      <th>RFSTDTC<\/th>\n      <th>RFENDTC<\/th>\n      <th>RFXSTDTC<\/th>\n      <th>RFXENDTC<\/th>\n      <th>RFICDTC<\/th>\n      <th>RFPENDTC<\/th>\n      <th>DTHDTC<\/th>\n      <th>DTHFL<\/th>\n      <th>SITEID<\/th>\n      <th>AGE<\/th>\n      <th>AGEU<\/th>\n      <th>SEX<\/th>\n      <th>RACE<\/th>\n      <th>ETHNIC<\/th>\n      <th>ARMCD<\/th>\n      <th>ARM<\/th>\n      <th>ACTARMCD<\/th>\n      <th>ACTARM<\/th>\n      <th>COUNTRY<\/th>\n      <th>DMDTC<\/th>\n      <th>DMDY<\/th>\n      <th>RANDDT<\/th>\n      <th>TRTSDT<\/th>\n      <th>SAFFL<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"targets":[0,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23],"visible":false},{"className":"dt-right","targets":[12,23]}],"searchHighlight":true,"searching":true,"pageLength":5,"lengthMenu":[5,10,15,20,50,100],"dom":"<Bfr<\"dt-scroll\"t>ipl>","buttons":[{"extend":"colvis","text":"Choose the columns to display","scroller":true,"collectionLayout":"fixed two-column"}],"colReorder":true,"order":[],"autoWidth":false,"orderClasses":false,"orderCellsTop":true}},"evals":[],"jsHooks":[]}</script><p>Some further examples of “merged” functions are
<code><a href="../reference/derive_vars_merged_lookup.html">derive_vars_merged_lookup()</a></code> to join a user-defined lookup
table as commonly used in BDS ADaMs or
<code><a href="../reference/derive_var_merged_summary.html">derive_var_merged_summary()</a></code> to merge summarized values from
the additional dataframe.</p>
</div>
</div>
<div class="section level2">
<h2 id="joined">
<em>joined</em> functions<a class="anchor" aria-label="anchor" href="#joined"></a>
</h2>
<div class="section level3">
<h3 id="description-1">Description<a class="anchor" aria-label="anchor" href="#description-1"></a>
</h3>
<p>For any “joined” function remember from above that the main
difference is that given the additional option to filter after the join,
it means that selection of the observations to add from the additional
dataframe can depend on variables from both this and the original
dataframe.</p>
<p>So, as with the “merged” functions the additional dataframe can first
be filtered based on a user-defined condition passed into the
<code>filter_add</code> argument. Then it is joined with the input
dataframe by user-specified variables passed into <code>by_vars</code>
argument. The joined dataframe can then be further restricted by the
<code>filter_join</code> condition, before optionally selecting the
first or last observation for each by group (<code>order</code> and
<code>mode</code> arguments). Finally the joined variables from the
additional dataframe can be renamed (<code>new_vars</code>
argument).</p>
<p>To illustrate this, imagine that in the above randomization date
example you only wanted the date populated for patients randomized
within 30 days of first treatment. You would now need to check both the
additional <code>DS</code> and the original <code>ADSL</code>
dataframes, so this would not be possible in one step using the “merged”
functions.</p>
</div>
<div class="section level3">
<h3 id="examples-1">Examples<a class="anchor" aria-label="anchor" href="#examples-1"></a>
</h3>
<p>The above mentioned randomization date variable (let’s call it
<code>RAND30DT</code> here) would use <code><a href="../reference/derive_vars_joined.html">derive_vars_joined()</a></code>
as follows.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Convert disposition character date to numeric date without imputation</span>
<span class="va">ds_ext</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/derive_vars_dt.html">derive_vars_dt</a></span><span class="op">(</span>
  dataset <span class="op">=</span> <span class="va">ds</span>,
  dtc <span class="op">=</span> <span class="va">DSSTDTC</span>,
  new_vars_prefix <span class="op">=</span> <span class="st">"DSST"</span>
<span class="op">)</span>

<span class="co"># Join randomization date to ADSL only for safety population patients</span>
<span class="va">adsl_05</span> <span class="op">&lt;-</span> <span class="va">adsl_04</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="../reference/derive_vars_joined.html">derive_vars_joined</a></span><span class="op">(</span>
    dataset_add <span class="op">=</span> <span class="va">ds_ext</span>,
    filter_add <span class="op">=</span> <span class="va">DSDECOD</span> <span class="op">==</span> <span class="st">"RANDOMIZED"</span>,
    by_vars <span class="op">=</span> <span class="fu"><a href="../reference/reexport-exprs.html">exprs</a></span><span class="op">(</span><span class="va">STUDYID</span>, <span class="va">USUBJID</span><span class="op">)</span>,
    new_vars <span class="op">=</span> <span class="fu"><a href="../reference/reexport-exprs.html">exprs</a></span><span class="op">(</span>RAND30DT <span class="op">=</span> <span class="va">DSSTDT</span><span class="op">)</span>,
    filter_join <span class="op">=</span> <span class="va">DSSTDT</span> <span class="op">&gt;=</span> <span class="va">TRTSDT</span> <span class="op">-</span> <span class="fl">30</span>
  <span class="op">)</span></code></pre></div>
<div id="htmlwidget-e52f722c5164242049ff" style="width:auto;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-e52f722c5164242049ff">{"x":{"filter":"top","vertical":false,"filterHTML":"<tr>\n  <td data-type=\"disabled\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"factor\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"width: 100%; display: none;\">\n      <select multiple=\"multiple\" style=\"width: 100%;\" data-options=\"[&quot;01-701-1047&quot;,&quot;01-701-1057&quot;,&quot;01-701-1111&quot;]\"><\/select>\n    <\/div>\n  <\/td>\n  <td data-type=\"factor\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"width: 100%; display: none;\">\n      <select multiple=\"multiple\" style=\"width: 100%;\" data-options=\"[&quot;1047&quot;,&quot;1057&quot;,&quot;1111&quot;]\"><\/select>\n    <\/div>\n  <\/td>\n  <td data-type=\"factor\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"width: 100%; display: none;\">\n      <select multiple=\"multiple\" style=\"width: 100%;\" data-options=\"[&quot;2012-09-07&quot;,&quot;2013-02-12&quot;]\"><\/select>\n    <\/div>\n  <\/td>\n  <td data-type=\"factor\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"width: 100%; display: none;\">\n      <select multiple=\"multiple\" style=\"width: 100%;\" data-options=\"[&quot;2012-09-17&quot;,&quot;2013-03-29&quot;]\"><\/select>\n    <\/div>\n  <\/td>\n  <td data-type=\"factor\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"width: 100%; display: none;\">\n      <select multiple=\"multiple\" style=\"width: 100%;\" data-options=\"[&quot;2012-09-07&quot;,&quot;2013-02-12&quot;]\"><\/select>\n    <\/div>\n  <\/td>\n  <td data-type=\"factor\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"width: 100%; display: none;\">\n      <select multiple=\"multiple\" style=\"width: 100%;\" data-options=\"[&quot;2012-09-16&quot;,&quot;2013-03-09&quot;]\"><\/select>\n    <\/div>\n  <\/td>\n  <td data-type=\"disabled\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"factor\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"width: 100%; display: none;\">\n      <select multiple=\"multiple\" style=\"width: 100%;\" data-options=\"[&quot;2013-02-22&quot;,&quot;2013-07-28&quot;,&quot;2013-12-27&quot;]\"><\/select>\n    <\/div>\n  <\/td>\n  <td data-type=\"disabled\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"disabled\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"disabled\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"59\" data-max=\"85\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"disabled\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"disabled\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"disabled\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"factor\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"width: 100%; display: none;\">\n      <select multiple=\"multiple\" style=\"width: 100%;\" data-options=\"[&quot;HISPANIC OR LATINO&quot;,&quot;NOT HISPANIC OR LATINO&quot;]\"><\/select>\n    <\/div>\n  <\/td>\n  <td data-type=\"factor\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"width: 100%; display: none;\">\n      <select multiple=\"multiple\" style=\"width: 100%;\" data-options=\"[&quot;Pbo&quot;,&quot;Scrnfail&quot;,&quot;Xan_Lo&quot;]\"><\/select>\n    <\/div>\n  <\/td>\n  <td data-type=\"factor\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"width: 100%; display: none;\">\n      <select multiple=\"multiple\" style=\"width: 100%;\" data-options=\"[&quot;Placebo&quot;,&quot;Screen Failure&quot;,&quot;Xanomeline Low Dose&quot;]\"><\/select>\n    <\/div>\n  <\/td>\n  <td data-type=\"factor\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"width: 100%; display: none;\">\n      <select multiple=\"multiple\" style=\"width: 100%;\" data-options=\"[&quot;Pbo&quot;,&quot;Scrnfail&quot;,&quot;Xan_Lo&quot;]\"><\/select>\n    <\/div>\n  <\/td>\n  <td data-type=\"factor\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"width: 100%; display: none;\">\n      <select multiple=\"multiple\" style=\"width: 100%;\" data-options=\"[&quot;Placebo&quot;,&quot;Screen Failure&quot;,&quot;Xanomeline Low Dose&quot;]\"><\/select>\n    <\/div>\n  <\/td>\n  <td data-type=\"disabled\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"factor\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"width: 100%; display: none;\">\n      <select multiple=\"multiple\" style=\"width: 100%;\" data-options=\"[&quot;2012-08-25&quot;,&quot;2013-01-22&quot;,&quot;2013-12-20&quot;]\"><\/select>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"-21\" data-max=\"-13\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"date\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"1343779200000\" data-max=\"1360627200000\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"date\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"1.346976e+12\" data-max=\"1360627200000\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"factor\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"width: 100%; display: none;\">\n      <select multiple=\"multiple\" style=\"width: 100%;\" data-options=\"[&quot;N&quot;,&quot;Y&quot;]\"><\/select>\n    <\/div>\n  <\/td>\n  <td data-type=\"disabled\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n<\/tr>","extensions":["Buttons","ColReorder","Scroller"],"data":[["CDISCPILOT01","CDISCPILOT01","CDISCPILOT01"],["01-701-1047","01-701-1057","01-701-1111"],["1047","1057","1111"],["2013-02-12",null,"2012-09-07"],["2013-03-29",null,"2012-09-17"],["2013-02-12",null,"2012-09-07"],["2013-03-09",null,"2012-09-16"],[null,null,null],["2013-07-28","2013-12-27","2013-02-22"],[null,null,null],[null,null,null],["701","701","701"],[85,59,81],["YEARS","YEARS","YEARS"],["F","F","F"],["WHITE","WHITE","WHITE"],["NOT HISPANIC OR LATINO","HISPANIC OR LATINO","NOT HISPANIC OR LATINO"],["Pbo","Scrnfail","Xan_Lo"],["Placebo","Screen Failure","Xanomeline Low Dose"],["Pbo","Scrnfail","Xan_Lo"],["Placebo","Screen Failure","Xanomeline Low Dose"],["USA","USA","USA"],["2013-01-22","2013-12-20","2012-08-25"],[-21,null,-13],["2013-02-12",null,"2012-08-01"],["2013-02-12",null,"2012-09-07"],["Y","N","Y"],["2013-02-12",null,null]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th>STUDYID<\/th>\n      <th>USUBJID<\/th>\n      <th>SUBJID<\/th>\n      <th>RFSTDTC<\/th>\n      <th>RFENDTC<\/th>\n      <th>RFXSTDTC<\/th>\n      <th>RFXENDTC<\/th>\n      <th>RFICDTC<\/th>\n      <th>RFPENDTC<\/th>\n      <th>DTHDTC<\/th>\n      <th>DTHFL<\/th>\n      <th>SITEID<\/th>\n      <th>AGE<\/th>\n      <th>AGEU<\/th>\n      <th>SEX<\/th>\n      <th>RACE<\/th>\n      <th>ETHNIC<\/th>\n      <th>ARMCD<\/th>\n      <th>ARM<\/th>\n      <th>ACTARMCD<\/th>\n      <th>ACTARM<\/th>\n      <th>COUNTRY<\/th>\n      <th>DMDTC<\/th>\n      <th>DMDY<\/th>\n      <th>RANDDT<\/th>\n      <th>TRTSDT<\/th>\n      <th>SAFFL<\/th>\n      <th>RAND30DT<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"targets":[0,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,26],"visible":false},{"className":"dt-right","targets":[12,23]}],"searchHighlight":true,"searching":true,"pageLength":5,"lengthMenu":[5,10,15,20,50,100],"dom":"<Bfr<\"dt-scroll\"t>ipl>","buttons":[{"extend":"colvis","text":"Choose the columns to display","scroller":true,"collectionLayout":"fixed two-column"}],"colReorder":true,"order":[],"autoWidth":false,"orderClasses":false,"orderCellsTop":true}},"evals":[],"jsHooks":[]}</script><p>Now, let’s consider another example of
<code><a href="../reference/derive_vars_joined.html">derive_vars_joined()</a></code>. For this we’ll need to additionally
use the <code>join_vars</code> argument, which is where the user needs
to call out any variables from the additional dataframe being used in
<code>filter_join</code>. Note: If a specified variable exists in both
dataframes, then the suffix “.join” is added to the variable from the
additional dataframe.</p>
<p>In this case we want to add a datacut flag to <code>AE</code>, only
for events occurring up to and including this day. So in this case
<code>AE</code> is the original dataframe and the datacut source is the
additional dataframe that needs to be joined.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Create a unique datacut day for each patient</span>
<span class="va">datacut</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tribble.html" class="external-link">tribble</a></span><span class="op">(</span>
  <span class="op">~</span><span class="va">USUBJID</span>,      <span class="op">~</span><span class="va">DCUTDY</span>, <span class="op">~</span><span class="va">DCUTFL</span>,
  <span class="st">"01-701-1047"</span>,      <span class="fl">25</span>, <span class="st">"Y"</span>,
  <span class="st">"01-701-1111"</span>,       <span class="fl">5</span>, <span class="st">"Y"</span>
<span class="op">)</span>

<span class="co"># Join datacut flag to AE only for events up to and including this date</span>
<span class="va">ae_01</span> <span class="op">&lt;-</span> <span class="va">ae</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="../reference/derive_vars_joined.html">derive_vars_joined</a></span><span class="op">(</span>
    dataset_add <span class="op">=</span> <span class="va">datacut</span>,
    by_vars <span class="op">=</span> <span class="fu"><a href="../reference/reexport-exprs.html">exprs</a></span><span class="op">(</span><span class="va">USUBJID</span><span class="op">)</span>,
    new_vars <span class="op">=</span> <span class="fu"><a href="../reference/reexport-exprs.html">exprs</a></span><span class="op">(</span><span class="va">DCUTFL</span><span class="op">)</span>,
    join_vars <span class="op">=</span> <span class="fu"><a href="../reference/reexport-exprs.html">exprs</a></span><span class="op">(</span><span class="va">DCUTDY</span><span class="op">)</span>,
    filter_join <span class="op">=</span> <span class="va">AESTDY</span> <span class="op">&lt;=</span> <span class="va">DCUTDY</span>
  <span class="op">)</span></code></pre></div>
<div id="htmlwidget-576d13650a61a557f9f2" style="width:auto;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-576d13650a61a557f9f2">{"x":{"filter":"top","vertical":false,"filterHTML":"<tr>\n  <td data-type=\"factor\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"width: 100%; display: none;\">\n      <select multiple=\"multiple\" style=\"width: 100%;\" data-options=\"[&quot;01-701-1047&quot;,&quot;01-701-1111&quot;]\"><\/select>\n    <\/div>\n  <\/td>\n  <td data-type=\"factor\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"width: 100%; display: none;\">\n      <select multiple=\"multiple\" style=\"width: 100%;\" data-options=\"[&quot;ARTHRALGIA&quot;,&quot;BUNDLE BRANCH BLOCK LEFT&quot;,&quot;CELLULITIS&quot;,&quot;ERYTHEMA&quot;,&quot;HIATUS HERNIA&quot;,&quot;LOCALISED INFECTION&quot;,&quot;MICTURITION URGENCY&quot;,&quot;PRURITUS&quot;,&quot;UPPER RESPIRATORY TRACT INFECTION&quot;]\"><\/select>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"-5\" data-max=\"27\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"factor\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"width: 100%; display: none;\">\n      <select multiple=\"multiple\" style=\"width: 100%;\" data-options=\"[&quot;Y&quot;]\"><\/select>\n    <\/div>\n  <\/td>\n<\/tr>","extensions":["Buttons","ColReorder","Scroller"],"data":[["01-701-1047","01-701-1047","01-701-1047","01-701-1047","01-701-1111","01-701-1111","01-701-1111","01-701-1111","01-701-1111","01-701-1111","01-701-1111","01-701-1111"],["HIATUS HERNIA","HIATUS HERNIA","UPPER RESPIRATORY TRACT INFECTION","BUNDLE BRANCH BLOCK LEFT","ERYTHEMA","ERYTHEMA","PRURITUS","PRURITUS","MICTURITION URGENCY","ARTHRALGIA","CELLULITIS","LOCALISED INFECTION"],[1,1,23,27,-5,-5,-5,-5,1,7,7,8],["Y","Y","Y",null,"Y","Y","Y","Y","Y",null,null,null]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th>USUBJID<\/th>\n      <th>AEDECOD<\/th>\n      <th>AESTDY<\/th>\n      <th>DCUTFL<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"targets":[],"visible":false},{"className":"dt-right","targets":2}],"searchHighlight":true,"searching":true,"pageLength":5,"lengthMenu":[5,10,15,20,50,100],"dom":"<Bfr<\"dt-scroll\"t>ipl>","buttons":[{"extend":"colvis","text":"Choose the columns to display","scroller":true,"collectionLayout":"fixed two-column"}],"colReorder":true,"order":[],"autoWidth":false,"orderClasses":false,"orderCellsTop":true}},"evals":[],"jsHooks":[]}</script><p>The <code><a href="../reference/derive_vars_joined.html">derive_vars_joined()</a></code> function could also be used to
join the original dataframe back with itself, which may be necessary if
you’re comparing across different observations. For example, the below
shows how a “nadir” calculation would be achieved which checks for the
worst value prior up to that observation.</p>
<p>Here is how you would derive the highest severity AE the patient has
occurred post-baseline up to and excluding the current AE day.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Derive nadir severity (AENADSEV)</span>
<span class="co"># Use a numeric version of severity for sorting with severe=1, moderate=2, mild=3</span>
<span class="va">ae_02</span> <span class="op">&lt;-</span> <span class="va">ae_01</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="../reference/derive_vars_joined.html">derive_vars_joined</a></span><span class="op">(</span>
    dataset_add <span class="op">=</span> <span class="va">ae_01</span>,
    filter_add <span class="op">=</span> <span class="va">AESTDY</span> <span class="op">&gt;</span> <span class="fl">0</span>,
    by_vars <span class="op">=</span> <span class="fu"><a href="../reference/reexport-exprs.html">exprs</a></span><span class="op">(</span><span class="va">USUBJID</span><span class="op">)</span>,
    order <span class="op">=</span> <span class="fu"><a href="../reference/reexport-exprs.html">exprs</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/integer.html" class="external-link">as.integer</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">AESEV</span>, levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"SEVERE"</span>, <span class="st">"MODERATE"</span>, <span class="st">"MILD"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,
    new_vars <span class="op">=</span> <span class="fu"><a href="../reference/reexport-exprs.html">exprs</a></span><span class="op">(</span>AENADSEV <span class="op">=</span> <span class="va">AESEV</span><span class="op">)</span>,
    join_vars <span class="op">=</span> <span class="fu"><a href="../reference/reexport-exprs.html">exprs</a></span><span class="op">(</span><span class="va">AESTDY</span><span class="op">)</span>,
    filter_join <span class="op">=</span> <span class="va">AESTDY.join</span> <span class="op">&lt;</span> <span class="va">AESTDY</span>,
    mode <span class="op">=</span> <span class="st">"first"</span>,
    check_type <span class="op">=</span> <span class="st">"none"</span>
  <span class="op">)</span></code></pre></div>
<div id="htmlwidget-2d4789571cdf1b8187f2" style="width:auto;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-2d4789571cdf1b8187f2">{"x":{"filter":"top","vertical":false,"filterHTML":"<tr>\n  <td data-type=\"factor\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"width: 100%; display: none;\">\n      <select multiple=\"multiple\" style=\"width: 100%;\" data-options=\"[&quot;01-701-1047&quot;,&quot;01-701-1111&quot;]\"><\/select>\n    <\/div>\n  <\/td>\n  <td data-type=\"factor\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"width: 100%; display: none;\">\n      <select multiple=\"multiple\" style=\"width: 100%;\" data-options=\"[&quot;ARTHRALGIA&quot;,&quot;BUNDLE BRANCH BLOCK LEFT&quot;,&quot;CELLULITIS&quot;,&quot;ERYTHEMA&quot;,&quot;HIATUS HERNIA&quot;,&quot;LOCALISED INFECTION&quot;,&quot;MICTURITION URGENCY&quot;,&quot;PRURITUS&quot;,&quot;UPPER RESPIRATORY TRACT INFECTION&quot;]\"><\/select>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"-5\" data-max=\"27\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"factor\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"width: 100%; display: none;\">\n      <select multiple=\"multiple\" style=\"width: 100%;\" data-options=\"[&quot;MILD&quot;,&quot;MODERATE&quot;]\"><\/select>\n    <\/div>\n  <\/td>\n  <td data-type=\"factor\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"width: 100%; display: none;\">\n      <select multiple=\"multiple\" style=\"width: 100%;\" data-options=\"[&quot;MILD&quot;,&quot;MODERATE&quot;]\"><\/select>\n    <\/div>\n  <\/td>\n<\/tr>","extensions":["Buttons","ColReorder","Scroller"],"data":[["01-701-1047","01-701-1047","01-701-1047","01-701-1047","01-701-1111","01-701-1111","01-701-1111","01-701-1111","01-701-1111","01-701-1111","01-701-1111","01-701-1111"],["HIATUS HERNIA","HIATUS HERNIA","UPPER RESPIRATORY TRACT INFECTION","BUNDLE BRANCH BLOCK LEFT","ERYTHEMA","ERYTHEMA","PRURITUS","PRURITUS","MICTURITION URGENCY","ARTHRALGIA","CELLULITIS","LOCALISED INFECTION"],[1,1,23,27,-5,-5,-5,-5,1,7,7,8],["MODERATE","MODERATE","MILD","MILD","MILD","MILD","MILD","MILD","MILD","MODERATE","MODERATE","MODERATE"],[null,null,"MODERATE","MODERATE",null,null,null,null,null,"MILD","MILD","MODERATE"]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th>USUBJID<\/th>\n      <th>AEDECOD<\/th>\n      <th>AESTDY<\/th>\n      <th>AESEV<\/th>\n      <th>AENADSEV<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"targets":[],"visible":false},{"className":"dt-right","targets":2}],"searchHighlight":true,"searching":true,"pageLength":5,"lengthMenu":[5,10,15,20,50,100],"dom":"<Bfr<\"dt-scroll\"t>ipl>","buttons":[{"extend":"colvis","text":"Choose the columns to display","scroller":true,"collectionLayout":"fixed two-column"}],"colReorder":true,"order":[],"autoWidth":false,"orderClasses":false,"orderCellsTop":true}},"evals":[],"jsHooks":[]}</script><p>There exists a further function
<code>derive_var_joied_exist_flag()</code>, which follows a similar
principle to the “joined” set as explained here. This can be used for
whenever one set of observations “confirms” another set in a dataframe,
i.e. the flag is only set for your observation if both the observation
and some other observation meet both the user-specified criteria.</p>
</div>
</div>
<div class="section level2">
<h2 id="extreme">
<em>extreme</em> functions<a class="anchor" aria-label="anchor" href="#extreme"></a>
</h2>
<div class="section level3">
<h3 id="description-2">Description<a class="anchor" aria-label="anchor" href="#description-2"></a>
</h3>
<p>The “extreme” functions are used for finding the first or last
observation (from <code>order</code> and <code>mode</code> arguments)
within each by group (<code>by_vars</code> argument).</p>
<p>These can then be output as a flag variable, a date, or as new
records dependent on which respective function is used between
<code><a href="../reference/derive_var_extreme_flag.html">derive_var_extreme_flag()</a></code>,
<code><a href="../reference/derive_var_extreme_dt.html">derive_var_extreme_dt()</a></code> or
<code><a href="../reference/derive_extreme_records.html">derive_extreme_records()</a></code> for example.</p>
</div>
<div class="section level3">
<h3 id="example">Example<a class="anchor" aria-label="anchor" href="#example"></a>
</h3>
<p>Building on the above case, let’s use
<code><a href="../reference/derive_var_extreme_flag.html">derive_var_extreme_flag()</a></code> to now flag the earliest
observation with the highest severity per patient.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Highest severity flag (AEHSEVFL)</span>
<span class="va">ae_03</span> <span class="op">&lt;-</span> <span class="va">ae_02</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="../reference/derive_var_extreme_flag.html">derive_var_extreme_flag</a></span><span class="op">(</span>
    new_var <span class="op">=</span> <span class="va">AEHSEVFL</span>,
    by_vars <span class="op">=</span> <span class="fu"><a href="../reference/reexport-exprs.html">exprs</a></span><span class="op">(</span><span class="va">USUBJID</span><span class="op">)</span>,
    order <span class="op">=</span> <span class="fu"><a href="../reference/reexport-exprs.html">exprs</a></span><span class="op">(</span>
      <span class="fu"><a href="https://rdrr.io/r/base/integer.html" class="external-link">as.integer</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">AESEV</span>, levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"SEVERE"</span>, <span class="st">"MODERATE"</span>, <span class="st">"MILD"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,
      <span class="va">AESTDY</span>, <span class="va">AESEQ</span>
    <span class="op">)</span>,
    mode <span class="op">=</span> <span class="st">"first"</span>
  <span class="op">)</span></code></pre></div>
<div id="htmlwidget-17ac29027fb5f77f2173" style="width:auto;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-17ac29027fb5f77f2173">{"x":{"filter":"top","vertical":false,"filterHTML":"<tr>\n  <td data-type=\"factor\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"width: 100%; display: none;\">\n      <select multiple=\"multiple\" style=\"width: 100%;\" data-options=\"[&quot;01-701-1047&quot;,&quot;01-701-1111&quot;]\"><\/select>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"-5\" data-max=\"27\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"1\" data-max=\"8\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"factor\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"width: 100%; display: none;\">\n      <select multiple=\"multiple\" style=\"width: 100%;\" data-options=\"[&quot;MILD&quot;,&quot;MODERATE&quot;]\"><\/select>\n    <\/div>\n  <\/td>\n  <td data-type=\"factor\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"width: 100%; display: none;\">\n      <select multiple=\"multiple\" style=\"width: 100%;\" data-options=\"[&quot;Y&quot;]\"><\/select>\n    <\/div>\n  <\/td>\n<\/tr>","extensions":["Buttons","ColReorder","Scroller"],"data":[["01-701-1047","01-701-1047","01-701-1047","01-701-1047","01-701-1111","01-701-1111","01-701-1111","01-701-1111","01-701-1111","01-701-1111","01-701-1111","01-701-1111"],[1,1,23,27,-5,-5,-5,-5,1,7,7,8],[1,2,3,4,1,2,4,5,6,7,8,3],["MODERATE","MODERATE","MILD","MILD","MILD","MILD","MILD","MILD","MILD","MODERATE","MODERATE","MODERATE"],["Y",null,null,null,null,null,null,null,null,"Y",null,null]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th>USUBJID<\/th>\n      <th>AESTDY<\/th>\n      <th>AESEQ<\/th>\n      <th>AESEV<\/th>\n      <th>AEHSEVFL<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"targets":[],"visible":false},{"className":"dt-right","targets":[1,2]}],"searchHighlight":true,"searching":true,"pageLength":5,"lengthMenu":[5,10,15,20,50,100],"dom":"<Bfr<\"dt-scroll\"t>ipl>","buttons":[{"extend":"colvis","text":"Choose the columns to display","scroller":true,"collectionLayout":"fixed two-column"}],"colReorder":true,"order":[],"autoWidth":false,"orderClasses":false,"orderCellsTop":true}},"evals":[],"jsHooks":[]}</script><p>Common further examples of usage of this set of functions could be
using <code><a href="../reference/derive_var_extreme_dt.html">derive_var_extreme_dt()</a></code> for last known alive date
calculation or <code><a href="../reference/derive_extreme_records.html">derive_extreme_records()</a></code> for creating
derived minimum or maximum value records.</p>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Ben Straub, Stefan Bundfuss, Jeffrey Dickinson, Ross Farrugia, Adam Forys, Daphne Grasselly, Dinakar Kulkarni, Edoardo Mancini, Sadchla Mascary, Gordon Miller, Sophie Shapcott, Eric Simms, Stefan Thoma, Kangjie Zhang, Zelos Zhu, G Gayatri, Thomas Neitmann, F. Hoffmann-La Roche AG, GlaxoSmithKline LLC.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
